using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using Helpers;
using TaleWorlds.CampaignSystem.Actions;
using TaleWorlds.CampaignSystem.CharacterDevelopment;
using TaleWorlds.CampaignSystem.ComponentInterfaces;
using TaleWorlds.CampaignSystem.GameState;
using TaleWorlds.CampaignSystem.Map;
using TaleWorlds.CampaignSystem.MapEvents;
using TaleWorlds.CampaignSystem.Naval;
using TaleWorlds.CampaignSystem.Party.PartyComponents;
using TaleWorlds.CampaignSystem.Roster;
using TaleWorlds.CampaignSystem.Settlements;
using TaleWorlds.CampaignSystem.Siege;
using TaleWorlds.Core;
using TaleWorlds.Library;
using TaleWorlds.Localization;
using TaleWorlds.SaveSystem;
using TaleWorlds.SaveSystem.Load;

namespace TaleWorlds.CampaignSystem.Party
{
	// Token: 0x020002EF RID: 751
	public sealed class MobileParty : CampaignObjectBase, ILocatable<MobileParty>, IMapPoint, ITrackableCampaignObject, ITrackableBase, IRandomOwner
	{
		// Token: 0x0600297E RID: 10622 RVA: 0x000AC604 File Offset: 0x000AA804
		internal static void AutoGeneratedStaticCollectObjectsMobileParty(object o, List<object> collectedObjects)
		{
			((MobileParty)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x0600297F RID: 10623 RVA: 0x000AC614 File Offset: 0x000AA814
		protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			base.AutoGeneratedInstanceCollectObjects(collectedObjects);
			CampaignVec2.AutoGeneratedStaticCollectObjectsCampaignVec2(this.NextTargetPosition, collectedObjects);
			CampaignVec2.AutoGeneratedStaticCollectObjectsCampaignVec2(this.MoveTargetPoint, collectedObjects);
			collectedObjects.Add(this.MoveTargetParty);
			collectedObjects.Add(this._currentSettlement);
			collectedObjects.Add(this._attachedTo);
			CampaignTime.AutoGeneratedStaticCollectObjectsCampaignTime(this._disorganizedUntilTime, collectedObjects);
			collectedObjects.Add(this._besiegerCamp);
			collectedObjects.Add(this._targetParty);
			collectedObjects.Add(this._targetSettlement);
			CampaignVec2.AutoGeneratedStaticCollectObjectsCampaignVec2(this._targetPosition, collectedObjects);
			collectedObjects.Add(this._customHomeSettlement);
			collectedObjects.Add(this._army);
			CampaignTime.AutoGeneratedStaticCollectObjectsCampaignTime(this._ignoredUntilTime, collectedObjects);
			CampaignVec2.AutoGeneratedStaticCollectObjectsCampaignVec2(this._pathLastPosition, collectedObjects);
			CampaignTime.AutoGeneratedStaticCollectObjectsCampaignTime(this._navigationTransitionStartTime, collectedObjects);
			collectedObjects.Add(this._actualClan);
			CampaignVec2.AutoGeneratedStaticCollectObjectsCampaignVec2(this._position, collectedObjects);
			collectedObjects.Add(this._partyComponent);
			collectedObjects.Add(this.LastVisitedSettlement);
			collectedObjects.Add(this.Ai);
			collectedObjects.Add(this.Party);
			CampaignTime.AutoGeneratedStaticCollectObjectsCampaignTime(this.StationaryStartTime, collectedObjects);
			collectedObjects.Add(this.Anchor);
			CampaignVec2.AutoGeneratedStaticCollectObjectsCampaignVec2(this.EndPositionForNavigationTransition, collectedObjects);
			CampaignTime.AutoGeneratedStaticCollectObjectsCampaignTime(this.NavigationTransitionDuration, collectedObjects);
			collectedObjects.Add(this.Scout);
			collectedObjects.Add(this.Engineer);
			collectedObjects.Add(this.Quartermaster);
			collectedObjects.Add(this.Surgeon);
		}

		// Token: 0x06002980 RID: 10624 RVA: 0x000AC7BB File Offset: 0x000AA9BB
		internal static object AutoGeneratedGetMemberValueLastVisitedSettlement(object o)
		{
			return ((MobileParty)o).LastVisitedSettlement;
		}

		// Token: 0x06002981 RID: 10625 RVA: 0x000AC7C8 File Offset: 0x000AA9C8
		internal static object AutoGeneratedGetMemberValueBearing(object o)
		{
			return ((MobileParty)o).Bearing;
		}

		// Token: 0x06002982 RID: 10626 RVA: 0x000AC7DA File Offset: 0x000AA9DA
		internal static object AutoGeneratedGetMemberValueHasLandNavigationCapability(object o)
		{
			return ((MobileParty)o).HasLandNavigationCapability;
		}

		// Token: 0x06002983 RID: 10627 RVA: 0x000AC7EC File Offset: 0x000AA9EC
		internal static object AutoGeneratedGetMemberValueAggressiveness(object o)
		{
			return ((MobileParty)o).Aggressiveness;
		}

		// Token: 0x06002984 RID: 10628 RVA: 0x000AC7FE File Offset: 0x000AA9FE
		internal static object AutoGeneratedGetMemberValueArmyPositionAdder(object o)
		{
			return ((MobileParty)o).ArmyPositionAdder;
		}

		// Token: 0x06002985 RID: 10629 RVA: 0x000AC810 File Offset: 0x000AAA10
		internal static object AutoGeneratedGetMemberValueObjective(object o)
		{
			return ((MobileParty)o).Objective;
		}

		// Token: 0x06002986 RID: 10630 RVA: 0x000AC822 File Offset: 0x000AAA22
		internal static object AutoGeneratedGetMemberValueAi(object o)
		{
			return ((MobileParty)o).Ai;
		}

		// Token: 0x06002987 RID: 10631 RVA: 0x000AC82F File Offset: 0x000AAA2F
		internal static object AutoGeneratedGetMemberValueParty(object o)
		{
			return ((MobileParty)o).Party;
		}

		// Token: 0x06002988 RID: 10632 RVA: 0x000AC83C File Offset: 0x000AAA3C
		internal static object AutoGeneratedGetMemberValueIsActive(object o)
		{
			return ((MobileParty)o).IsActive;
		}

		// Token: 0x06002989 RID: 10633 RVA: 0x000AC84E File Offset: 0x000AAA4E
		internal static object AutoGeneratedGetMemberValueShortTermBehavior(object o)
		{
			return ((MobileParty)o).ShortTermBehavior;
		}

		// Token: 0x0600298A RID: 10634 RVA: 0x000AC860 File Offset: 0x000AAA60
		internal static object AutoGeneratedGetMemberValueIsPartyTradeActive(object o)
		{
			return ((MobileParty)o).IsPartyTradeActive;
		}

		// Token: 0x0600298B RID: 10635 RVA: 0x000AC872 File Offset: 0x000AAA72
		internal static object AutoGeneratedGetMemberValuePartyTradeTaxGold(object o)
		{
			return ((MobileParty)o).PartyTradeTaxGold;
		}

		// Token: 0x0600298C RID: 10636 RVA: 0x000AC884 File Offset: 0x000AAA84
		internal static object AutoGeneratedGetMemberValueStationaryStartTime(object o)
		{
			return ((MobileParty)o).StationaryStartTime;
		}

		// Token: 0x0600298D RID: 10637 RVA: 0x000AC896 File Offset: 0x000AAA96
		internal static object AutoGeneratedGetMemberValueShouldJoinPlayerBattles(object o)
		{
			return ((MobileParty)o).ShouldJoinPlayerBattles;
		}

		// Token: 0x0600298E RID: 10638 RVA: 0x000AC8A8 File Offset: 0x000AAAA8
		internal static object AutoGeneratedGetMemberValueIsDisbanding(object o)
		{
			return ((MobileParty)o).IsDisbanding;
		}

		// Token: 0x0600298F RID: 10639 RVA: 0x000AC8BA File Offset: 0x000AAABA
		internal static object AutoGeneratedGetMemberValueAnchor(object o)
		{
			return ((MobileParty)o).Anchor;
		}

		// Token: 0x06002990 RID: 10640 RVA: 0x000AC8C7 File Offset: 0x000AAAC7
		internal static object AutoGeneratedGetMemberValueEndPositionForNavigationTransition(object o)
		{
			return ((MobileParty)o).EndPositionForNavigationTransition;
		}

		// Token: 0x06002991 RID: 10641 RVA: 0x000AC8D9 File Offset: 0x000AAAD9
		internal static object AutoGeneratedGetMemberValueNavigationTransitionDuration(object o)
		{
			return ((MobileParty)o).NavigationTransitionDuration;
		}

		// Token: 0x06002992 RID: 10642 RVA: 0x000AC8EB File Offset: 0x000AAAEB
		internal static object AutoGeneratedGetMemberValueScout(object o)
		{
			return ((MobileParty)o).Scout;
		}

		// Token: 0x06002993 RID: 10643 RVA: 0x000AC8F8 File Offset: 0x000AAAF8
		internal static object AutoGeneratedGetMemberValueEngineer(object o)
		{
			return ((MobileParty)o).Engineer;
		}

		// Token: 0x06002994 RID: 10644 RVA: 0x000AC905 File Offset: 0x000AAB05
		internal static object AutoGeneratedGetMemberValueQuartermaster(object o)
		{
			return ((MobileParty)o).Quartermaster;
		}

		// Token: 0x06002995 RID: 10645 RVA: 0x000AC912 File Offset: 0x000AAB12
		internal static object AutoGeneratedGetMemberValueSurgeon(object o)
		{
			return ((MobileParty)o).Surgeon;
		}

		// Token: 0x06002996 RID: 10646 RVA: 0x000AC91F File Offset: 0x000AAB1F
		internal static object AutoGeneratedGetMemberValueHasUnpaidWages(object o)
		{
			return ((MobileParty)o).HasUnpaidWages;
		}

		// Token: 0x06002997 RID: 10647 RVA: 0x000AC931 File Offset: 0x000AAB31
		internal static object AutoGeneratedGetMemberValueIsInfoHidden(object o)
		{
			return ((MobileParty)o).IsInfoHidden;
		}

		// Token: 0x06002998 RID: 10648 RVA: 0x000AC943 File Offset: 0x000AAB43
		internal static object AutoGeneratedGetMemberValueAverageFleeTargetDirection(object o)
		{
			return ((MobileParty)o).AverageFleeTargetDirection;
		}

		// Token: 0x06002999 RID: 10649 RVA: 0x000AC955 File Offset: 0x000AAB55
		internal static object AutoGeneratedGetMemberValueNextTargetPosition(object o)
		{
			return ((MobileParty)o).NextTargetPosition;
		}

		// Token: 0x0600299A RID: 10650 RVA: 0x000AC967 File Offset: 0x000AAB67
		internal static object AutoGeneratedGetMemberValueMoveTargetPoint(object o)
		{
			return ((MobileParty)o).MoveTargetPoint;
		}

		// Token: 0x0600299B RID: 10651 RVA: 0x000AC979 File Offset: 0x000AAB79
		internal static object AutoGeneratedGetMemberValuePartyMoveMode(object o)
		{
			return ((MobileParty)o).PartyMoveMode;
		}

		// Token: 0x0600299C RID: 10652 RVA: 0x000AC98B File Offset: 0x000AAB8B
		internal static object AutoGeneratedGetMemberValueMoveTargetParty(object o)
		{
			return ((MobileParty)o).MoveTargetParty;
		}

		// Token: 0x0600299D RID: 10653 RVA: 0x000AC998 File Offset: 0x000AAB98
		internal static object AutoGeneratedGetMemberValue_currentSettlement(object o)
		{
			return ((MobileParty)o)._currentSettlement;
		}

		// Token: 0x0600299E RID: 10654 RVA: 0x000AC9A5 File Offset: 0x000AABA5
		internal static object AutoGeneratedGetMemberValue_attachedTo(object o)
		{
			return ((MobileParty)o)._attachedTo;
		}

		// Token: 0x0600299F RID: 10655 RVA: 0x000AC9B2 File Offset: 0x000AABB2
		internal static object AutoGeneratedGetMemberValue_eventPositionAdder(object o)
		{
			return ((MobileParty)o)._eventPositionAdder;
		}

		// Token: 0x060029A0 RID: 10656 RVA: 0x000AC9C4 File Offset: 0x000AABC4
		internal static object AutoGeneratedGetMemberValue_isInRaftState(object o)
		{
			return ((MobileParty)o)._isInRaftState;
		}

		// Token: 0x060029A1 RID: 10657 RVA: 0x000AC9D6 File Offset: 0x000AABD6
		internal static object AutoGeneratedGetMemberValue_isVisible(object o)
		{
			return ((MobileParty)o)._isVisible;
		}

		// Token: 0x060029A2 RID: 10658 RVA: 0x000AC9E8 File Offset: 0x000AABE8
		internal static object AutoGeneratedGetMemberValue_isInspected(object o)
		{
			return ((MobileParty)o)._isInspected;
		}

		// Token: 0x060029A3 RID: 10659 RVA: 0x000AC9FA File Offset: 0x000AABFA
		internal static object AutoGeneratedGetMemberValue_disorganizedUntilTime(object o)
		{
			return ((MobileParty)o)._disorganizedUntilTime;
		}

		// Token: 0x060029A4 RID: 10660 RVA: 0x000ACA0C File Offset: 0x000AAC0C
		internal static object AutoGeneratedGetMemberValue_besiegerCamp(object o)
		{
			return ((MobileParty)o)._besiegerCamp;
		}

		// Token: 0x060029A5 RID: 10661 RVA: 0x000ACA19 File Offset: 0x000AAC19
		internal static object AutoGeneratedGetMemberValue_targetParty(object o)
		{
			return ((MobileParty)o)._targetParty;
		}

		// Token: 0x060029A6 RID: 10662 RVA: 0x000ACA26 File Offset: 0x000AAC26
		internal static object AutoGeneratedGetMemberValue_targetSettlement(object o)
		{
			return ((MobileParty)o)._targetSettlement;
		}

		// Token: 0x060029A7 RID: 10663 RVA: 0x000ACA33 File Offset: 0x000AAC33
		internal static object AutoGeneratedGetMemberValue_targetPosition(object o)
		{
			return ((MobileParty)o)._targetPosition;
		}

		// Token: 0x060029A8 RID: 10664 RVA: 0x000ACA45 File Offset: 0x000AAC45
		internal static object AutoGeneratedGetMemberValue_customHomeSettlement(object o)
		{
			return ((MobileParty)o)._customHomeSettlement;
		}

		// Token: 0x060029A9 RID: 10665 RVA: 0x000ACA52 File Offset: 0x000AAC52
		internal static object AutoGeneratedGetMemberValue_army(object o)
		{
			return ((MobileParty)o)._army;
		}

		// Token: 0x060029AA RID: 10666 RVA: 0x000ACA5F File Offset: 0x000AAC5F
		internal static object AutoGeneratedGetMemberValue_isCurrentlyUsedByAQuest(object o)
		{
			return ((MobileParty)o)._isCurrentlyUsedByAQuest;
		}

		// Token: 0x060029AB RID: 10667 RVA: 0x000ACA71 File Offset: 0x000AAC71
		internal static object AutoGeneratedGetMemberValue_partyTradeGold(object o)
		{
			return ((MobileParty)o)._partyTradeGold;
		}

		// Token: 0x060029AC RID: 10668 RVA: 0x000ACA83 File Offset: 0x000AAC83
		internal static object AutoGeneratedGetMemberValue_ignoredUntilTime(object o)
		{
			return ((MobileParty)o)._ignoredUntilTime;
		}

		// Token: 0x060029AD RID: 10669 RVA: 0x000ACA95 File Offset: 0x000AAC95
		internal static object AutoGeneratedGetMemberValue_pathMode(object o)
		{
			return ((MobileParty)o)._pathMode;
		}

		// Token: 0x060029AE RID: 10670 RVA: 0x000ACAA7 File Offset: 0x000AACA7
		internal static object AutoGeneratedGetMemberValue_pathLastPosition(object o)
		{
			return ((MobileParty)o)._pathLastPosition;
		}

		// Token: 0x060029AF RID: 10671 RVA: 0x000ACAB9 File Offset: 0x000AACB9
		internal static object AutoGeneratedGetMemberValue_formationPosition(object o)
		{
			return ((MobileParty)o)._formationPosition;
		}

		// Token: 0x060029B0 RID: 10672 RVA: 0x000ACACB File Offset: 0x000AACCB
		internal static object AutoGeneratedGetMemberValue_defaultBehavior(object o)
		{
			return ((MobileParty)o)._defaultBehavior;
		}

		// Token: 0x060029B1 RID: 10673 RVA: 0x000ACADD File Offset: 0x000AACDD
		internal static object AutoGeneratedGetMemberValue_isCurrentlyAtSea(object o)
		{
			return ((MobileParty)o)._isCurrentlyAtSea;
		}

		// Token: 0x060029B2 RID: 10674 RVA: 0x000ACAEF File Offset: 0x000AACEF
		internal static object AutoGeneratedGetMemberValue_isTargetingPort(object o)
		{
			return ((MobileParty)o)._isTargetingPort;
		}

		// Token: 0x060029B3 RID: 10675 RVA: 0x000ACB01 File Offset: 0x000AAD01
		internal static object AutoGeneratedGetMemberValue_navigationTransitionStartTime(object o)
		{
			return ((MobileParty)o)._navigationTransitionStartTime;
		}

		// Token: 0x060029B4 RID: 10676 RVA: 0x000ACB13 File Offset: 0x000AAD13
		internal static object AutoGeneratedGetMemberValue_desiredAiNavigationType(object o)
		{
			return ((MobileParty)o)._desiredAiNavigationType;
		}

		// Token: 0x060029B5 RID: 10677 RVA: 0x000ACB25 File Offset: 0x000AAD25
		internal static object AutoGeneratedGetMemberValue_actualClan(object o)
		{
			return ((MobileParty)o)._actualClan;
		}

		// Token: 0x060029B6 RID: 10678 RVA: 0x000ACB32 File Offset: 0x000AAD32
		internal static object AutoGeneratedGetMemberValue_moraleDueToEvents(object o)
		{
			return ((MobileParty)o)._moraleDueToEvents;
		}

		// Token: 0x060029B7 RID: 10679 RVA: 0x000ACB44 File Offset: 0x000AAD44
		internal static object AutoGeneratedGetMemberValue_position(object o)
		{
			return ((MobileParty)o)._position;
		}

		// Token: 0x060029B8 RID: 10680 RVA: 0x000ACB56 File Offset: 0x000AAD56
		internal static object AutoGeneratedGetMemberValue_partyComponent(object o)
		{
			return ((MobileParty)o)._partyComponent;
		}

		// Token: 0x17000A08 RID: 2568
		// (get) Token: 0x060029B9 RID: 10681 RVA: 0x000ACB63 File Offset: 0x000AAD63
		public static MobileParty MainParty
		{
			get
			{
				return Campaign.Current.MainParty;
			}
		}

		// Token: 0x17000A09 RID: 2569
		// (get) Token: 0x060029BA RID: 10682 RVA: 0x000ACB6F File Offset: 0x000AAD6F
		public static MBReadOnlyList<MobileParty> All
		{
			get
			{
				return Campaign.Current.MobileParties;
			}
		}

		// Token: 0x17000A0A RID: 2570
		// (get) Token: 0x060029BB RID: 10683 RVA: 0x000ACB7B File Offset: 0x000AAD7B
		public static MBReadOnlyList<MobileParty> AllCaravanParties
		{
			get
			{
				return Campaign.Current.CaravanParties;
			}
		}

		// Token: 0x17000A0B RID: 2571
		// (get) Token: 0x060029BC RID: 10684 RVA: 0x000ACB87 File Offset: 0x000AAD87
		public static MBReadOnlyList<MobileParty> AllPatrolParties
		{
			get
			{
				return Campaign.Current.PatrolParties;
			}
		}

		// Token: 0x17000A0C RID: 2572
		// (get) Token: 0x060029BD RID: 10685 RVA: 0x000ACB93 File Offset: 0x000AAD93
		public static MBReadOnlyList<MobileParty> AllBanditParties
		{
			get
			{
				return Campaign.Current.BanditParties;
			}
		}

		// Token: 0x17000A0D RID: 2573
		// (get) Token: 0x060029BE RID: 10686 RVA: 0x000ACB9F File Offset: 0x000AAD9F
		public static MBReadOnlyList<MobileParty> AllLordParties
		{
			get
			{
				return Campaign.Current.LordParties;
			}
		}

		// Token: 0x17000A0E RID: 2574
		// (get) Token: 0x060029BF RID: 10687 RVA: 0x000ACBAB File Offset: 0x000AADAB
		public static MBReadOnlyList<MobileParty> AllGarrisonParties
		{
			get
			{
				return Campaign.Current.GarrisonParties;
			}
		}

		// Token: 0x17000A0F RID: 2575
		// (get) Token: 0x060029C0 RID: 10688 RVA: 0x000ACBB7 File Offset: 0x000AADB7
		public static MBReadOnlyList<MobileParty> AllMilitiaParties
		{
			get
			{
				return Campaign.Current.MilitiaParties;
			}
		}

		// Token: 0x17000A10 RID: 2576
		// (get) Token: 0x060029C1 RID: 10689 RVA: 0x000ACBC3 File Offset: 0x000AADC3
		public static MBReadOnlyList<MobileParty> AllVillagerParties
		{
			get
			{
				return Campaign.Current.VillagerParties;
			}
		}

		// Token: 0x17000A11 RID: 2577
		// (get) Token: 0x060029C2 RID: 10690 RVA: 0x000ACBCF File Offset: 0x000AADCF
		public static MBReadOnlyList<MobileParty> AllCustomParties
		{
			get
			{
				return Campaign.Current.CustomParties;
			}
		}

		// Token: 0x17000A12 RID: 2578
		// (get) Token: 0x060029C3 RID: 10691 RVA: 0x000ACBDB File Offset: 0x000AADDB
		public static MBReadOnlyList<MobileParty> AllPartiesWithoutPartyComponent
		{
			get
			{
				return Campaign.Current.PartiesWithoutPartyComponent;
			}
		}

		// Token: 0x17000A13 RID: 2579
		// (get) Token: 0x060029C4 RID: 10692 RVA: 0x000ACBE7 File Offset: 0x000AADE7
		public static int Count
		{
			get
			{
				return Campaign.Current.MobileParties.Count;
			}
		}

		// Token: 0x17000A14 RID: 2580
		// (get) Token: 0x060029C5 RID: 10693 RVA: 0x000ACBF8 File Offset: 0x000AADF8
		public static MobileParty ConversationParty
		{
			get
			{
				return Campaign.Current.ConversationManager.ConversationParty;
			}
		}

		// Token: 0x17000A15 RID: 2581
		// (get) Token: 0x060029C6 RID: 10694 RVA: 0x000ACC0C File Offset: 0x000AAE0C
		public TextObject Name
		{
			get
			{
				if (!TextObject.IsNullOrEmpty(this.Party.CustomName))
				{
					return this.Party.CustomName;
				}
				if (this._partyComponent != null)
				{
					return this._partyComponent.Name;
				}
				Debug.FailedAssert("UnnamedMobileParty", "C:\\BuildAgent\\work\\mb3\\Source\\Bannerlord\\TaleWorlds.CampaignSystem\\Party\\MobileParty.cs", "Name", 120);
				return new TextObject("{=!}unnamedMobileParty", null);
			}
		}

		// Token: 0x17000A16 RID: 2582
		// (get) Token: 0x060029C7 RID: 10695 RVA: 0x000ACC6C File Offset: 0x000AAE6C
		// (set) Token: 0x060029C8 RID: 10696 RVA: 0x000ACC74 File Offset: 0x000AAE74
		[SaveableProperty(1002)]
		public Settlement LastVisitedSettlement { get; private set; }

		// Token: 0x17000A17 RID: 2583
		// (get) Token: 0x060029C9 RID: 10697 RVA: 0x000ACC7D File Offset: 0x000AAE7D
		// (set) Token: 0x060029CA RID: 10698 RVA: 0x000ACC85 File Offset: 0x000AAE85
		[SaveableProperty(1004)]
		public Vec2 Bearing { get; internal set; }

		// Token: 0x17000A18 RID: 2584
		// (get) Token: 0x060029CB RID: 10699 RVA: 0x000ACC8E File Offset: 0x000AAE8E
		public MBReadOnlyList<MobileParty> AttachedParties
		{
			get
			{
				return this._attachedParties;
			}
		}

		// Token: 0x17000A19 RID: 2585
		// (get) Token: 0x060029CC RID: 10700 RVA: 0x000ACC96 File Offset: 0x000AAE96
		// (set) Token: 0x060029CD RID: 10701 RVA: 0x000ACC9E File Offset: 0x000AAE9E
		[SaveableProperty(1099)]
		public bool HasLandNavigationCapability { get; private set; } = true;

		// Token: 0x060029CE RID: 10702 RVA: 0x000ACCA7 File Offset: 0x000AAEA7
		public void SetLandNavigationAccess(bool access)
		{
			this.HasLandNavigationCapability = access;
		}

		// Token: 0x17000A1A RID: 2586
		// (get) Token: 0x060029CF RID: 10703 RVA: 0x000ACCB0 File Offset: 0x000AAEB0
		public MBReadOnlyList<Ship> Ships
		{
			get
			{
				return this.Party.Ships;
			}
		}

		// Token: 0x17000A1B RID: 2587
		// (get) Token: 0x060029D0 RID: 10704 RVA: 0x000ACCBD File Offset: 0x000AAEBD
		public bool HasNavalNavigationCapability
		{
			get
			{
				return Campaign.Current.Models.PartyNavigationModel.HasNavalNavigationCapability(this);
			}
		}

		// Token: 0x17000A1C RID: 2588
		// (get) Token: 0x060029D1 RID: 10705 RVA: 0x000ACCD4 File Offset: 0x000AAED4
		// (set) Token: 0x060029D2 RID: 10706 RVA: 0x000ACCDC File Offset: 0x000AAEDC
		[SaveableProperty(1009)]
		public float Aggressiveness { get; set; }

		// Token: 0x17000A1D RID: 2589
		// (get) Token: 0x060029D3 RID: 10707 RVA: 0x000ACCE5 File Offset: 0x000AAEE5
		public int PaymentLimit
		{
			get
			{
				PartyComponent partyComponent = this._partyComponent;
				if (partyComponent == null)
				{
					return Campaign.Current.Models.PartyWageModel.MaxWagePaymentLimit;
				}
				return partyComponent.WagePaymentLimit;
			}
		}

		// Token: 0x17000A1E RID: 2590
		// (get) Token: 0x060029D4 RID: 10708 RVA: 0x000ACD0C File Offset: 0x000AAF0C
		public Banner Banner
		{
			get
			{
				if (this.Party.CustomBanner != null)
				{
					return this.Party.CustomBanner;
				}
				if (this.PartyComponent != null && this.PartyComponent.GetDefaultComponentBanner() != null)
				{
					return this.PartyComponent.GetDefaultComponentBanner();
				}
				if (this.MapFaction != null)
				{
					return this.MapFaction.Banner;
				}
				return null;
			}
		}

		// Token: 0x060029D5 RID: 10709 RVA: 0x000ACD68 File Offset: 0x000AAF68
		public override TextObject GetName()
		{
			return this.Name;
		}

		// Token: 0x060029D6 RID: 10710 RVA: 0x000ACD70 File Offset: 0x000AAF70
		public bool HasLimitedWage()
		{
			return this.PaymentLimit != Campaign.Current.Models.PartyWageModel.MaxWagePaymentLimit;
		}

		// Token: 0x060029D7 RID: 10711 RVA: 0x000ACD91 File Offset: 0x000AAF91
		public int GetAvailableWageBudget()
		{
			return this.PaymentLimit - this.TotalWage - 5;
		}

		// Token: 0x060029D8 RID: 10712 RVA: 0x000ACDA2 File Offset: 0x000AAFA2
		public bool IsWageLimitExceeded()
		{
			return this.HasLimitedWage() && this.PaymentLimit < this.TotalWage;
		}

		// Token: 0x060029D9 RID: 10713 RVA: 0x000ACDBC File Offset: 0x000AAFBC
		public void SetWagePaymentLimit(int newLimit)
		{
			PartyComponent partyComponent = this.PartyComponent;
			if (partyComponent == null)
			{
				return;
			}
			partyComponent.SetWagePaymentLimit(newLimit);
		}

		// Token: 0x17000A1F RID: 2591
		// (get) Token: 0x060029DA RID: 10714 RVA: 0x000ACDCF File Offset: 0x000AAFCF
		// (set) Token: 0x060029DB RID: 10715 RVA: 0x000ACDD7 File Offset: 0x000AAFD7
		[SaveableProperty(1005)]
		public Vec2 ArmyPositionAdder { get; private set; }

		// Token: 0x17000A20 RID: 2592
		// (get) Token: 0x060029DC RID: 10716 RVA: 0x000ACDE0 File Offset: 0x000AAFE0
		public CampaignVec2 AiBehaviorTarget
		{
			get
			{
				return this.Ai.BehaviorTarget;
			}
		}

		// Token: 0x17000A21 RID: 2593
		// (get) Token: 0x060029DD RID: 10717 RVA: 0x000ACDED File Offset: 0x000AAFED
		// (set) Token: 0x060029DE RID: 10718 RVA: 0x000ACDF5 File Offset: 0x000AAFF5
		[SaveableProperty(1090)]
		public MobileParty.PartyObjective Objective { get; private set; }

		// Token: 0x17000A22 RID: 2594
		// (get) Token: 0x060029DF RID: 10719 RVA: 0x000ACDFE File Offset: 0x000AAFFE
		// (set) Token: 0x060029E0 RID: 10720 RVA: 0x000ACE06 File Offset: 0x000AB006
		[CachedData]
		MobileParty ILocatable<MobileParty>.NextLocatable { get; set; }

		// Token: 0x17000A23 RID: 2595
		// (get) Token: 0x060029E1 RID: 10721 RVA: 0x000ACE0F File Offset: 0x000AB00F
		// (set) Token: 0x060029E2 RID: 10722 RVA: 0x000ACE17 File Offset: 0x000AB017
		[SaveableProperty(1019)]
		public MobilePartyAi Ai { get; private set; }

		// Token: 0x17000A24 RID: 2596
		// (get) Token: 0x060029E3 RID: 10723 RVA: 0x000ACE20 File Offset: 0x000AB020
		// (set) Token: 0x060029E4 RID: 10724 RVA: 0x000ACE28 File Offset: 0x000AB028
		[SaveableProperty(1020)]
		public PartyBase Party { get; private set; }

		// Token: 0x17000A25 RID: 2597
		// (get) Token: 0x060029E5 RID: 10725 RVA: 0x000ACE31 File Offset: 0x000AB031
		// (set) Token: 0x060029E6 RID: 10726 RVA: 0x000ACE39 File Offset: 0x000AB039
		[SaveableProperty(1023)]
		public bool IsActive { get; set; }

		// Token: 0x17000A26 RID: 2598
		// (get) Token: 0x060029E7 RID: 10727 RVA: 0x000ACE42 File Offset: 0x000AB042
		// (set) Token: 0x060029E8 RID: 10728 RVA: 0x000ACE4A File Offset: 0x000AB04A
		public bool IsInRaftState
		{
			get
			{
				return this._isInRaftState;
			}
			set
			{
				if (this._isInRaftState != value)
				{
					this._isInRaftState = value;
					if (this._isInRaftState)
					{
						this.Anchor.ResetPosition();
					}
					this.Party.SetVisualAsDirty();
				}
			}
		}

		// Token: 0x17000A27 RID: 2599
		// (get) Token: 0x060029E9 RID: 10729 RVA: 0x000ACE7A File Offset: 0x000AB07A
		public CampaignTime DisorganizedUntilTime
		{
			get
			{
				return this._disorganizedUntilTime;
			}
		}

		// Token: 0x17000A28 RID: 2600
		// (get) Token: 0x060029EA RID: 10730 RVA: 0x000ACE82 File Offset: 0x000AB082
		[CachedData]
		public float LastCalculatedBaseSpeed
		{
			get
			{
				return this._lastCalculatedBaseSpeedExplained.ResultNumber;
			}
		}

		// Token: 0x17000A29 RID: 2601
		// (get) Token: 0x060029EB RID: 10731 RVA: 0x000ACE8F File Offset: 0x000AB08F
		// (set) Token: 0x060029EC RID: 10732 RVA: 0x000ACE97 File Offset: 0x000AB097
		[CachedData]
		public PartyThinkParams ThinkParamsCache { get; private set; }

		// Token: 0x17000A2A RID: 2602
		// (get) Token: 0x060029ED RID: 10733 RVA: 0x000ACEA0 File Offset: 0x000AB0A0
		public float Speed
		{
			get
			{
				if (this.IsActive)
				{
					return this.CalculateSpeed();
				}
				Debug.FailedAssert("!IsActive", "C:\\BuildAgent\\work\\mb3\\Source\\Bannerlord\\TaleWorlds.CampaignSystem\\Party\\MobileParty.cs", "Speed", 310);
				return 0f;
			}
		}

		// Token: 0x17000A2B RID: 2603
		// (get) Token: 0x060029EE RID: 10734 RVA: 0x000ACED0 File Offset: 0x000AB0D0
		public ExplainedNumber SpeedExplained
		{
			get
			{
				ExplainedNumber explainedNumber = Campaign.Current.Models.PartySpeedCalculatingModel.CalculateBaseSpeed(this, true, 0, 0);
				Campaign.Current.Models.PartySpeedCalculatingModel.CalculateFinalSpeed(this, explainedNumber);
				this._lastCalculatedSpeed = explainedNumber.ResultNumber;
				return explainedNumber;
			}
		}

		// Token: 0x17000A2C RID: 2604
		// (get) Token: 0x060029EF RID: 10735 RVA: 0x000ACF1B File Offset: 0x000AB11B
		public MobileParty ShortTermTargetParty
		{
			get
			{
				PartyBase aiBehaviorPartyBase = this.Ai.AiBehaviorPartyBase;
				if (aiBehaviorPartyBase == null)
				{
					return null;
				}
				return aiBehaviorPartyBase.MobileParty;
			}
		}

		// Token: 0x17000A2D RID: 2605
		// (get) Token: 0x060029F0 RID: 10736 RVA: 0x000ACF33 File Offset: 0x000AB133
		public Settlement ShortTermTargetSettlement
		{
			get
			{
				PartyBase aiBehaviorPartyBase = this.Ai.AiBehaviorPartyBase;
				if (aiBehaviorPartyBase == null)
				{
					return null;
				}
				return aiBehaviorPartyBase.Settlement;
			}
		}

		// Token: 0x17000A2E RID: 2606
		// (get) Token: 0x060029F1 RID: 10737 RVA: 0x000ACF4B File Offset: 0x000AB14B
		public bool IsDisorganized
		{
			get
			{
				return this._isDisorganized;
			}
		}

		// Token: 0x17000A2F RID: 2607
		// (get) Token: 0x060029F2 RID: 10738 RVA: 0x000ACF53 File Offset: 0x000AB153
		public bool IsCurrentlyUsedByAQuest
		{
			get
			{
				return this._isCurrentlyUsedByAQuest;
			}
		}

		// Token: 0x17000A30 RID: 2608
		// (get) Token: 0x060029F3 RID: 10739 RVA: 0x000ACF5B File Offset: 0x000AB15B
		// (set) Token: 0x060029F4 RID: 10740 RVA: 0x000ACF63 File Offset: 0x000AB163
		[SaveableProperty(1050)]
		public AiBehavior ShortTermBehavior { get; internal set; }

		// Token: 0x17000A31 RID: 2609
		// (get) Token: 0x060029F5 RID: 10741 RVA: 0x000ACF6C File Offset: 0x000AB16C
		// (set) Token: 0x060029F6 RID: 10742 RVA: 0x000ACF74 File Offset: 0x000AB174
		[SaveableProperty(1958)]
		public bool IsPartyTradeActive { get; private set; }

		// Token: 0x17000A32 RID: 2610
		// (get) Token: 0x060029F7 RID: 10743 RVA: 0x000ACF7D File Offset: 0x000AB17D
		// (set) Token: 0x060029F8 RID: 10744 RVA: 0x000ACFA1 File Offset: 0x000AB1A1
		public int PartyTradeGold
		{
			get
			{
				if (this.IsLordParty && this.LeaderHero != null)
				{
					return this.LeaderHero.Gold;
				}
				return this._partyTradeGold;
			}
			set
			{
				if (this.IsLordParty && this.LeaderHero != null)
				{
					this.LeaderHero.Gold = MathF.Max(value, 0);
					return;
				}
				this._partyTradeGold = MathF.Max(value, 0);
			}
		}

		// Token: 0x17000A33 RID: 2611
		// (get) Token: 0x060029F9 RID: 10745 RVA: 0x000ACFD3 File Offset: 0x000AB1D3
		// (set) Token: 0x060029FA RID: 10746 RVA: 0x000ACFDB File Offset: 0x000AB1DB
		[SaveableProperty(1957)]
		public int PartyTradeTaxGold { get; private set; }

		// Token: 0x17000A34 RID: 2612
		// (get) Token: 0x060029FB RID: 10747 RVA: 0x000ACFE4 File Offset: 0x000AB1E4
		// (set) Token: 0x060029FC RID: 10748 RVA: 0x000ACFEC File Offset: 0x000AB1EC
		[SaveableProperty(1960)]
		public CampaignTime StationaryStartTime { get; private set; }

		// Token: 0x17000A35 RID: 2613
		// (get) Token: 0x060029FD RID: 10749 RVA: 0x000ACFF5 File Offset: 0x000AB1F5
		// (set) Token: 0x060029FE RID: 10750 RVA: 0x000ACFFD File Offset: 0x000AB1FD
		[CachedData]
		public int VersionNo { get; private set; }

		// Token: 0x17000A36 RID: 2614
		// (get) Token: 0x060029FF RID: 10751 RVA: 0x000AD006 File Offset: 0x000AB206
		// (set) Token: 0x06002A00 RID: 10752 RVA: 0x000AD00E File Offset: 0x000AB20E
		[SaveableProperty(1080)]
		public bool ShouldJoinPlayerBattles { get; set; }

		// Token: 0x17000A37 RID: 2615
		// (get) Token: 0x06002A01 RID: 10753 RVA: 0x000AD017 File Offset: 0x000AB217
		// (set) Token: 0x06002A02 RID: 10754 RVA: 0x000AD01F File Offset: 0x000AB21F
		[SaveableProperty(1081)]
		public bool IsDisbanding { get; set; }

		// Token: 0x17000A38 RID: 2616
		// (get) Token: 0x06002A03 RID: 10755 RVA: 0x000AD028 File Offset: 0x000AB228
		public int RandomValue
		{
			get
			{
				return this.Party.RandomValue;
			}
		}

		// Token: 0x17000A39 RID: 2617
		// (get) Token: 0x06002A04 RID: 10756 RVA: 0x000AD038 File Offset: 0x000AB238
		public MobileParty.NavigationType NavigationCapability
		{
			get
			{
				MobileParty.NavigationType navigationType = MobileParty.NavigationType.None;
				if (this.HasLandNavigationCapability)
				{
					navigationType |= MobileParty.NavigationType.Default;
				}
				if (this.HasNavalNavigationCapability)
				{
					navigationType |= MobileParty.NavigationType.Naval;
				}
				return navigationType;
			}
		}

		// Token: 0x17000A3A RID: 2618
		// (get) Token: 0x06002A05 RID: 10757 RVA: 0x000AD060 File Offset: 0x000AB260
		// (set) Token: 0x06002A06 RID: 10758 RVA: 0x000AD068 File Offset: 0x000AB268
		public bool IsCurrentlyAtSea
		{
			get
			{
				return this._isCurrentlyAtSea;
			}
			set
			{
				if (this._isCurrentlyAtSea != value)
				{
					this._isCurrentlyAtSea = value;
					foreach (MobileParty mobileParty in this._attachedParties)
					{
						mobileParty.IsCurrentlyAtSea = value;
					}
					this.UpdateVersionNo();
					CampaignEventDispatcher.Instance.OnMobilePartyNavigationStateChanged(this);
					this.Party.SetVisualAsDirty();
					if (!this.IsCurrentlyAtSea)
					{
						this.SetNavalVisualAsDirty();
					}
				}
			}
		}

		// Token: 0x17000A3B RID: 2619
		// (get) Token: 0x06002A07 RID: 10759 RVA: 0x000AD0F4 File Offset: 0x000AB2F4
		// (set) Token: 0x06002A08 RID: 10760 RVA: 0x000AD0FC File Offset: 0x000AB2FC
		[CachedData]
		public bool IsNavalVisualDirty { get; private set; }

		// Token: 0x06002A09 RID: 10761 RVA: 0x000AD105 File Offset: 0x000AB305
		public void SetNavalVisualAsDirty()
		{
			this.IsNavalVisualDirty = true;
		}

		// Token: 0x06002A0A RID: 10762 RVA: 0x000AD10E File Offset: 0x000AB30E
		public void OnNavalVisualsUpdated()
		{
			this.IsNavalVisualDirty = false;
		}

		// Token: 0x17000A3C RID: 2620
		// (get) Token: 0x06002A0B RID: 10763 RVA: 0x000AD117 File Offset: 0x000AB317
		public bool IsTargetingPort
		{
			get
			{
				return this._isTargetingPort;
			}
		}

		// Token: 0x17000A3D RID: 2621
		// (get) Token: 0x06002A0C RID: 10764 RVA: 0x000AD11F File Offset: 0x000AB31F
		// (set) Token: 0x06002A0D RID: 10765 RVA: 0x000AD127 File Offset: 0x000AB327
		[SaveableProperty(1092)]
		public AnchorPoint Anchor { get; private set; }

		// Token: 0x17000A3E RID: 2622
		// (get) Token: 0x06002A0E RID: 10766 RVA: 0x000AD130 File Offset: 0x000AB330
		public bool IsTransitionInProgress
		{
			get
			{
				return this.NavigationTransitionStartTime != CampaignTime.Zero;
			}
		}

		// Token: 0x17000A3F RID: 2623
		// (get) Token: 0x06002A0F RID: 10767 RVA: 0x000AD142 File Offset: 0x000AB342
		// (set) Token: 0x06002A10 RID: 10768 RVA: 0x000AD14A File Offset: 0x000AB34A
		[SaveableProperty(223)]
		public CampaignVec2 EndPositionForNavigationTransition { get; private set; }

		// Token: 0x17000A40 RID: 2624
		// (get) Token: 0x06002A11 RID: 10769 RVA: 0x000AD153 File Offset: 0x000AB353
		// (set) Token: 0x06002A12 RID: 10770 RVA: 0x000AD15C File Offset: 0x000AB35C
		public CampaignTime NavigationTransitionStartTime
		{
			get
			{
				return this._navigationTransitionStartTime;
			}
			private set
			{
				this._navigationTransitionStartTime = value;
				if (!(this._navigationTransitionStartTime != CampaignTime.Zero))
				{
					this.NavigationTransitionDuration = CampaignTime.Zero;
					return;
				}
				if (this.IsCurrentlyAtSea)
				{
					this.NavigationTransitionDuration = Campaign.Current.Models.PartyTransitionModel.GetTransitionTimeDisembarking(this);
					return;
				}
				this.NavigationTransitionDuration = Campaign.Current.Models.PartyTransitionModel.GetTransitionTimeForEmbarking(this);
			}
		}

		// Token: 0x17000A41 RID: 2625
		// (get) Token: 0x06002A13 RID: 10771 RVA: 0x000AD1CD File Offset: 0x000AB3CD
		// (set) Token: 0x06002A14 RID: 10772 RVA: 0x000AD1D5 File Offset: 0x000AB3D5
		[SaveableProperty(1097)]
		public CampaignTime NavigationTransitionDuration { get; private set; } = CampaignTime.Zero;

		// Token: 0x06002A15 RID: 10773 RVA: 0x000AD1E0 File Offset: 0x000AB3E0
		internal void InitializeNavigationTransitionParallel(CampaignVec2 transitionStartPosition, CampaignVec2 transitionEndPosition, ref int gridChangeCount, ref MobileParty[] gridChangeMobilePartyList)
		{
			this.NavigationTransitionStartTime = CampaignTime.Now;
			this.Party.SetVisualAsDirty();
			if (this.CurrentSettlement == null)
			{
				this.EndPositionForNavigationTransition = transitionEndPosition;
				this.SetPositionParallel(transitionStartPosition, ref gridChangeCount, ref gridChangeMobilePartyList);
			}
			foreach (MobileParty mobileParty in this._attachedParties)
			{
				mobileParty.InitializeNavigationTransitionParallel(transitionStartPosition, transitionEndPosition, ref gridChangeCount, ref gridChangeMobilePartyList);
			}
		}

		// Token: 0x06002A16 RID: 10774 RVA: 0x000AD268 File Offset: 0x000AB468
		public void SetSailAtPosition(CampaignVec2 position)
		{
			this.IsCurrentlyAtSea = true;
			this.Position = position;
			this.TargetPosition = position;
			this.Anchor.ResetPosition();
			for (int i = 0; i < this.AttachedParties.Count; i++)
			{
				this.AttachedParties[i].Position = this.Position;
				this.AttachedParties[i].Anchor.ResetPosition();
			}
		}

		// Token: 0x06002A17 RID: 10775 RVA: 0x000AD2D8 File Offset: 0x000AB4D8
		public void CancelNavigationTransition()
		{
			this.CancelNavigationTransitionParallel();
		}

		// Token: 0x06002A18 RID: 10776 RVA: 0x000AD2E0 File Offset: 0x000AB4E0
		private void CancelNavigationTransitionParallel()
		{
			this.NavigationTransitionStartTime = CampaignTime.Zero;
			this.EndPositionForNavigationTransition = CampaignVec2.Invalid;
			this.Party.SetVisualAsDirty();
			foreach (MobileParty mobileParty in this._attachedParties)
			{
				mobileParty.CancelNavigationTransitionParallel();
			}
		}

		// Token: 0x06002A19 RID: 10777 RVA: 0x000AD354 File Offset: 0x000AB554
		internal void FinishNavigationTransitionInternal()
		{
			bool flag = !this.IsCurrentlyAtSea;
			this._isCurrentlyAtSea = flag;
			if (this.Path.Size > this.PathBegin + 1)
			{
				int pathBegin = this.PathBegin;
				this.PathBegin = pathBegin + 1;
			}
			if (flag || this.IsInRaftState)
			{
				this.Anchor.ResetPosition();
			}
			else if (this.Ships.Any<Ship>())
			{
				this.Anchor.SetPosition(this.Position);
			}
			this.NavigationTransitionStartTime = CampaignTime.Zero;
			CampaignVec2 position;
			if (this.CurrentSettlement != null)
			{
				if (flag)
				{
					position = this.CurrentSettlement.PortPosition;
				}
				else
				{
					position = this.CurrentSettlement.GatePosition;
				}
			}
			else
			{
				position = ((this.Army != null && this.AttachedTo != null) ? this.Army.LeaderParty.EndPositionForNavigationTransition : this.EndPositionForNavigationTransition);
			}
			this._position = position;
			if (this.IsInRaftState)
			{
				RaftStateChangeAction.DeactivateRaftStateForParty(this);
			}
			foreach (MobileParty mobileParty in this._attachedParties)
			{
				mobileParty.FinishNavigationTransitionInternal();
				mobileParty.ArmyPositionAdder = Vec2.Zero;
			}
			this.ComputePath(this.MoveTargetPoint, this.NavigationCapability, !this.IsFleeing());
			this.UpdateVersionNo();
			CampaignEventDispatcher.Instance.OnMobilePartyNavigationStateChanged(this);
			this.Party.SetVisualAsDirty();
			if (!this.IsCurrentlyAtSea)
			{
				this.SetNavalVisualAsDirty();
			}
			this.Anchor.SetLastUsedDisembarkPosition(this.EndPositionForNavigationTransition);
			this.EndPositionForNavigationTransition = CampaignVec2.Invalid;
		}

		// Token: 0x06002A1A RID: 10778 RVA: 0x000AD4F0 File Offset: 0x000AB6F0
		public void ChangeIsCurrentlyAtSeaCheat()
		{
			this.IsCurrentlyAtSea = !this.IsCurrentlyAtSea;
			this.Anchor.ResetPosition();
			for (int i = 0; i < this.AttachedParties.Count; i++)
			{
				this.AttachedParties[i].Anchor.ResetPosition();
			}
		}

		// Token: 0x17000A42 RID: 2626
		// (get) Token: 0x06002A1B RID: 10779 RVA: 0x000AD543 File Offset: 0x000AB743
		// (set) Token: 0x06002A1C RID: 10780 RVA: 0x000AD54B File Offset: 0x000AB74B
		public MobileParty.NavigationType DesiredAiNavigationType
		{
			get
			{
				return this._desiredAiNavigationType;
			}
			set
			{
				this._desiredAiNavigationType = value;
			}
		}

		// Token: 0x17000A43 RID: 2627
		// (get) Token: 0x06002A1D RID: 10781 RVA: 0x000AD554 File Offset: 0x000AB754
		// (set) Token: 0x06002A1E RID: 10782 RVA: 0x000AD55C File Offset: 0x000AB75C
		public Settlement CurrentSettlement
		{
			get
			{
				return this._currentSettlement;
			}
			set
			{
				if (value != this._currentSettlement)
				{
					if (this._currentSettlement != null)
					{
						this._currentSettlement.RemoveMobileParty(this);
						this.ArmyPositionAdder = Vec2.Zero;
					}
					this._currentSettlement = value;
					if (this._currentSettlement != null)
					{
						this._currentSettlement.AddMobileParty(this);
						this.Position = (this.IsCurrentlyAtSea ? this._currentSettlement.PortPosition : this._currentSettlement.GatePosition);
						this.LastVisitedSettlement = value;
						this.EndPositionForNavigationTransition = this.Position;
					}
					else
					{
						this.EndPositionForNavigationTransition = CampaignVec2.Invalid;
					}
					foreach (MobileParty mobileParty in this._attachedParties)
					{
						mobileParty.CurrentSettlement = value;
					}
					if (this._currentSettlement != null && this._currentSettlement.IsFortification)
					{
						this.ArmyPositionAdder = Vec2.Zero;
						this.Bearing = Vec2.Zero;
						foreach (MobileParty mobileParty2 in this._currentSettlement.Parties)
						{
							mobileParty2.Party.SetVisualAsDirty();
						}
					}
					this.Party.SetVisualAsDirty();
				}
			}
		}

		// Token: 0x17000A44 RID: 2628
		// (get) Token: 0x06002A1F RID: 10783 RVA: 0x000AD6B8 File Offset: 0x000AB8B8
		public Settlement HomeSettlement
		{
			get
			{
				Settlement result;
				if ((result = this._customHomeSettlement) == null)
				{
					PartyComponent partyComponent = this._partyComponent;
					if (partyComponent == null)
					{
						return null;
					}
					result = partyComponent.HomeSettlement;
				}
				return result;
			}
		}

		// Token: 0x06002A20 RID: 10784 RVA: 0x000AD6D5 File Offset: 0x000AB8D5
		public void SetCustomHomeSettlement(Settlement customHomeSettlement)
		{
			this._customHomeSettlement = customHomeSettlement;
		}

		// Token: 0x17000A45 RID: 2629
		// (get) Token: 0x06002A21 RID: 10785 RVA: 0x000AD6DE File Offset: 0x000AB8DE
		// (set) Token: 0x06002A22 RID: 10786 RVA: 0x000AD6E6 File Offset: 0x000AB8E6
		public MobileParty AttachedTo
		{
			get
			{
				return this._attachedTo;
			}
			set
			{
				if (this._attachedTo != value)
				{
					this.SetAttachedToInternal(value);
				}
			}
		}

		// Token: 0x06002A23 RID: 10787 RVA: 0x000AD6F8 File Offset: 0x000AB8F8
		private void SetAttachedToInternal(MobileParty value)
		{
			if (this._attachedTo != null)
			{
				if (this.IsTransitionInProgress)
				{
					this.CancelNavigationTransitionParallel();
				}
				this._attachedTo.RemoveAttachedPartyInternal(this);
				if (this.Party.MapEventSide != null && this.IsActive)
				{
					this.Party.MapEventSide.HandleMapEventEndForPartyInternal(this.Party);
					this.Party.MapEventSide = null;
				}
				if (this.BesiegerCamp != null)
				{
					this.BesiegerCamp = null;
				}
				this.OnAttachedToRemoved();
			}
			this._attachedTo = value;
			if (this._attachedTo != null)
			{
				this._attachedTo.AddAttachedPartyInternal(this);
				this.Party.MapEventSide = this._attachedTo.Party.MapEventSide;
				this.BesiegerCamp = this._attachedTo.BesiegerCamp;
				this.CurrentSettlement = this._attachedTo.CurrentSettlement;
				if (this._attachedTo.IsTransitionInProgress)
				{
					this.NavigationTransitionStartTime = CampaignTime.Now;
				}
				else if (this.IsTransitionInProgress)
				{
					this.CancelNavigationTransitionParallel();
				}
				if (this.IsCurrentlyAtSea != this._attachedTo.IsCurrentlyAtSea)
				{
					this.IsCurrentlyAtSea = this._attachedTo.IsCurrentlyAtSea;
				}
			}
			this.Party.SetVisualAsDirty();
		}

		// Token: 0x06002A24 RID: 10788 RVA: 0x000AD825 File Offset: 0x000ABA25
		private void AddAttachedPartyInternal(MobileParty mobileParty)
		{
			if (this._attachedParties == null)
			{
				this._attachedParties = new MBList<MobileParty>();
			}
			this._attachedParties.Add(mobileParty);
			if (CampaignEventDispatcher.Instance != null)
			{
				CampaignEventDispatcher.Instance.OnPartyAttachedAnotherParty(mobileParty);
			}
		}

		// Token: 0x06002A25 RID: 10789 RVA: 0x000AD858 File Offset: 0x000ABA58
		private void RemoveAttachedPartyInternal(MobileParty mobileParty)
		{
			this._attachedParties.Remove(mobileParty);
		}

		// Token: 0x06002A26 RID: 10790 RVA: 0x000AD867 File Offset: 0x000ABA67
		private void OnAttachedToRemoved()
		{
			this.ArmyPositionAdder = Vec2.Zero;
			this.SetMoveModeHold();
		}

		// Token: 0x17000A46 RID: 2630
		// (get) Token: 0x06002A27 RID: 10791 RVA: 0x000AD87A File Offset: 0x000ABA7A
		// (set) Token: 0x06002A28 RID: 10792 RVA: 0x000AD884 File Offset: 0x000ABA84
		public Army Army
		{
			get
			{
				return this._army;
			}
			set
			{
				if (this._army != value)
				{
					this.UpdateVersionNo();
					Army army = this._army;
					if (this._army != null)
					{
						this._army.OnRemovePartyInternal(this);
					}
					this._army = value;
					if (value == null)
					{
						if (this == MobileParty.MainParty && Game.Current.GameStateManager.ActiveState is MapState)
						{
							((MapState)Game.Current.GameStateManager.ActiveState).OnLeaveArmy();
						}
						CampaignEventDispatcher.Instance.OnPartyLeftArmy(this, army);
						return;
					}
					this._army.OnAddPartyInternal(this);
				}
			}
		}

		// Token: 0x17000A47 RID: 2631
		// (get) Token: 0x06002A29 RID: 10793 RVA: 0x000AD915 File Offset: 0x000ABB15
		// (set) Token: 0x06002A2A RID: 10794 RVA: 0x000AD920 File Offset: 0x000ABB20
		public BesiegerCamp BesiegerCamp
		{
			get
			{
				return this._besiegerCamp;
			}
			set
			{
				if (this._besiegerCamp != value && !this._besiegerCampResetStarted)
				{
					this._besiegerCampResetStarted = true;
					if (this._besiegerCamp != null)
					{
						this.OnPartyLeftSiegeInternal();
					}
					this._besiegerCamp = value;
					if (this._besiegerCamp != null)
					{
						this.OnPartyJoinedSiegeInternal();
					}
					foreach (MobileParty mobileParty in this._attachedParties)
					{
						mobileParty.BesiegerCamp = value;
					}
					this.Party.SetVisualAsDirty();
					this._besiegerCampResetStarted = false;
				}
			}
		}

		// Token: 0x17000A48 RID: 2632
		// (get) Token: 0x06002A2B RID: 10795 RVA: 0x000AD9C0 File Offset: 0x000ABBC0
		// (set) Token: 0x06002A2C RID: 10796 RVA: 0x000AD9C8 File Offset: 0x000ABBC8
		public AiBehavior DefaultBehavior
		{
			get
			{
				return this._defaultBehavior;
			}
			private set
			{
				if (this._defaultBehavior != value)
				{
					this._defaultBehavior = value;
					this.Ai.DefaultBehaviorNeedsUpdate = true;
					this.RecalculateShortTermBehavior();
				}
			}
		}

		// Token: 0x17000A49 RID: 2633
		// (get) Token: 0x06002A2D RID: 10797 RVA: 0x000AD9EC File Offset: 0x000ABBEC
		public Settlement TargetSettlement
		{
			get
			{
				return this._targetSettlement;
			}
		}

		// Token: 0x06002A2E RID: 10798 RVA: 0x000AD9F4 File Offset: 0x000ABBF4
		public void SetTargetSettlement(Settlement settlement, bool isTargetingPort)
		{
			if (settlement != this._targetSettlement || this.IsTargetingPort != isTargetingPort)
			{
				this._targetSettlement = settlement;
				if (settlement != null)
				{
					this.MoveTargetPoint = (isTargetingPort ? settlement.PortPosition : settlement.GatePosition);
				}
				this.Ai.DefaultBehaviorNeedsUpdate = true;
			}
			this._isTargetingPort = isTargetingPort;
		}

		// Token: 0x17000A4A RID: 2634
		// (get) Token: 0x06002A2F RID: 10799 RVA: 0x000ADA47 File Offset: 0x000ABC47
		// (set) Token: 0x06002A30 RID: 10800 RVA: 0x000ADA4F File Offset: 0x000ABC4F
		public CampaignVec2 TargetPosition
		{
			get
			{
				return this._targetPosition;
			}
			internal set
			{
				if (this._targetPosition != value)
				{
					this._targetPosition = value;
					this.Ai.DefaultBehaviorNeedsUpdate = true;
				}
			}
		}

		// Token: 0x17000A4B RID: 2635
		// (get) Token: 0x06002A31 RID: 10801 RVA: 0x000ADA72 File Offset: 0x000ABC72
		// (set) Token: 0x06002A32 RID: 10802 RVA: 0x000ADA7A File Offset: 0x000ABC7A
		public MobileParty TargetParty
		{
			get
			{
				return this._targetParty;
			}
			internal set
			{
				if (value != this._targetParty)
				{
					this._targetParty = value;
					this.Ai.DefaultBehaviorNeedsUpdate = true;
				}
			}
		}

		// Token: 0x06002A33 RID: 10803 RVA: 0x000ADA98 File Offset: 0x000ABC98
		public MobileParty()
		{
			this._isVisible = false;
			this.IsActive = true;
			this._isCurrentlyUsedByAQuest = false;
			this.Party = new PartyBase(this);
			this.Anchor = new AnchorPoint(this);
			this.InitMembers();
			this.InitCached();
			this.Initialize();
		}

		// Token: 0x17000A4C RID: 2636
		// (get) Token: 0x06002A34 RID: 10804 RVA: 0x000ADB39 File Offset: 0x000ABD39
		public Hero LeaderHero
		{
			get
			{
				PartyComponent partyComponent = this.PartyComponent;
				if (partyComponent == null)
				{
					return null;
				}
				return partyComponent.Leader;
			}
		}

		// Token: 0x17000A4D RID: 2637
		// (get) Token: 0x06002A35 RID: 10805 RVA: 0x000ADB4C File Offset: 0x000ABD4C
		// (set) Token: 0x06002A36 RID: 10806 RVA: 0x000ADB54 File Offset: 0x000ABD54
		[SaveableProperty(1070)]
		private Hero Scout { get; set; }

		// Token: 0x17000A4E RID: 2638
		// (get) Token: 0x06002A37 RID: 10807 RVA: 0x000ADB5D File Offset: 0x000ABD5D
		// (set) Token: 0x06002A38 RID: 10808 RVA: 0x000ADB65 File Offset: 0x000ABD65
		[SaveableProperty(1072)]
		private Hero Engineer { get; set; }

		// Token: 0x17000A4F RID: 2639
		// (get) Token: 0x06002A39 RID: 10809 RVA: 0x000ADB6E File Offset: 0x000ABD6E
		// (set) Token: 0x06002A3A RID: 10810 RVA: 0x000ADB76 File Offset: 0x000ABD76
		[SaveableProperty(1071)]
		private Hero Quartermaster { get; set; }

		// Token: 0x17000A50 RID: 2640
		// (get) Token: 0x06002A3B RID: 10811 RVA: 0x000ADB7F File Offset: 0x000ABD7F
		// (set) Token: 0x06002A3C RID: 10812 RVA: 0x000ADB87 File Offset: 0x000ABD87
		[SaveableProperty(1073)]
		private Hero Surgeon { get; set; }

		// Token: 0x17000A51 RID: 2641
		// (get) Token: 0x06002A3D RID: 10813 RVA: 0x000ADB90 File Offset: 0x000ABD90
		public Hero Owner
		{
			get
			{
				PartyComponent partyComponent = this._partyComponent;
				if (partyComponent == null)
				{
					return null;
				}
				return partyComponent.PartyOwner;
			}
		}

		// Token: 0x17000A52 RID: 2642
		// (get) Token: 0x06002A3E RID: 10814 RVA: 0x000ADBA3 File Offset: 0x000ABDA3
		public Hero EffectiveScout
		{
			get
			{
				if (this.Scout == null || this.Scout.PartyBelongedTo != this)
				{
					return this.LeaderHero;
				}
				return this.Scout;
			}
		}

		// Token: 0x17000A53 RID: 2643
		// (get) Token: 0x06002A3F RID: 10815 RVA: 0x000ADBC8 File Offset: 0x000ABDC8
		public Hero EffectiveQuartermaster
		{
			get
			{
				if (this.Quartermaster == null || this.Quartermaster.PartyBelongedTo != this)
				{
					return this.LeaderHero;
				}
				return this.Quartermaster;
			}
		}

		// Token: 0x17000A54 RID: 2644
		// (get) Token: 0x06002A40 RID: 10816 RVA: 0x000ADBED File Offset: 0x000ABDED
		public Hero EffectiveEngineer
		{
			get
			{
				if (this.Engineer == null || this.Engineer.PartyBelongedTo != this)
				{
					return this.LeaderHero;
				}
				return this.Engineer;
			}
		}

		// Token: 0x17000A55 RID: 2645
		// (get) Token: 0x06002A41 RID: 10817 RVA: 0x000ADC12 File Offset: 0x000ABE12
		public Hero EffectiveSurgeon
		{
			get
			{
				if (this.Surgeon == null || this.Surgeon.PartyBelongedTo != this)
				{
					return this.LeaderHero;
				}
				return this.Surgeon;
			}
		}

		// Token: 0x06002A42 RID: 10818 RVA: 0x000ADC37 File Offset: 0x000ABE37
		public void SetPartyScout(Hero hero)
		{
			this.RemoveHeroPartyRole(hero);
			this.Scout = hero;
		}

		// Token: 0x06002A43 RID: 10819 RVA: 0x000ADC47 File Offset: 0x000ABE47
		public void SetPartyQuartermaster(Hero hero)
		{
			this.RemoveHeroPartyRole(hero);
			this.Quartermaster = hero;
		}

		// Token: 0x06002A44 RID: 10820 RVA: 0x000ADC57 File Offset: 0x000ABE57
		public void SetPartyEngineer(Hero hero)
		{
			this.RemoveHeroPartyRole(hero);
			this.Engineer = hero;
		}

		// Token: 0x06002A45 RID: 10821 RVA: 0x000ADC67 File Offset: 0x000ABE67
		public void SetPartySurgeon(Hero hero)
		{
			this.RemoveHeroPartyRole(hero);
			this.Surgeon = hero;
		}

		// Token: 0x06002A46 RID: 10822 RVA: 0x000ADC77 File Offset: 0x000ABE77
		internal void StartUp()
		{
			this.NextTargetPosition = this.Position;
			this.PathLastFace = PathFaceRecord.NullFaceRecord;
			this.MoveTargetPoint = this.Position;
			this.ForceAiNoPathMode = false;
		}

		// Token: 0x06002A47 RID: 10823 RVA: 0x000ADCA4 File Offset: 0x000ABEA4
		[LateLoadInitializationCallback]
		private void OnLateLoad(MetaData metaData, ObjectLoadData objectLoadData)
		{
			if (MBSaveLoad.LastLoadedGameVersion.IsOlderThan(ApplicationVersion.FromString("v1.3.0", 0)))
			{
				TextObject textObject = (TextObject)objectLoadData.GetMemberValueBySaveId(1021);
				if (!TextObject.IsNullOrEmpty(textObject))
				{
					this.Party.SetCustomName(textObject);
				}
			}
			if (MBSaveLoad.LastLoadedGameVersion.IsOlderThan(ApplicationVersion.FromString("v1.3.0", 0)))
			{
				Vec2 pos = (Vec2)objectLoadData.GetMemberValueBySaveId(1100);
				this._position = new CampaignVec2(pos, true);
			}
			if (MBSaveLoad.LastLoadedGameVersion < ApplicationVersion.FromString("v1.1.0", 0))
			{
				PartyBase partyBase = (PartyBase)objectLoadData.GetMemberValueBySaveId(1052);
				IInteractablePoint interactablePoint = null;
				if (partyBase != null && (partyBase.IsSettlement || partyBase.IsMobile))
				{
					interactablePoint = partyBase;
				}
				object memberValueBySaveId = objectLoadData.GetMemberValueBySaveId(1036);
				object memberValueBySaveId2 = objectLoadData.GetMemberValueBySaveId(1037);
				object memberValueBySaveId3 = objectLoadData.GetMemberValueBySaveId(1064);
				object memberValueBySaveId4 = objectLoadData.GetMemberValueBySaveId(1065);
				object memberValueBySaveId5 = objectLoadData.GetMemberValueBySaveId(1047);
				object memberValueBySaveId6 = objectLoadData.GetMemberValueBySaveId(1051);
				object memberValueBySaveId7 = objectLoadData.GetMemberValueBySaveId(1038);
				object memberValueBySaveId8 = objectLoadData.GetMemberValueBySaveId(1039);
				object memberValueBySaveId9 = objectLoadData.GetMemberValueBySaveId(1055);
				object memberValueBySaveId10 = objectLoadData.GetMemberValueBySaveId(1054);
				object memberValueBySaveId11 = objectLoadData.GetMemberValueBySaveId(1062);
				object memberValueBySaveId12 = objectLoadData.GetMemberValueBySaveId(1061);
				object fieldValueBySaveId = objectLoadData.GetFieldValueBySaveId(1070);
				object memberValueBySaveId13 = objectLoadData.GetMemberValueBySaveId(1022);
				object obj = interactablePoint ?? objectLoadData.GetMemberValueBySaveId(1056);
				object memberValueBySaveId14 = objectLoadData.GetMemberValueBySaveId(1074);
				if (memberValueBySaveId != null)
				{
					IInteractablePoint oldAiBehaviorMapEntity = null;
					if (obj != null)
					{
						Settlement settlement;
						MobileParty mobileParty;
						if ((settlement = (obj as Settlement)) != null)
						{
							oldAiBehaviorMapEntity = settlement.Party;
						}
						else if ((mobileParty = (obj as MobileParty)) != null)
						{
							oldAiBehaviorMapEntity = mobileParty.Party;
						}
						else
						{
							oldAiBehaviorMapEntity = (IInteractablePoint)obj;
						}
					}
					this.Ai.InitializeForOldSaves((float)memberValueBySaveId, (float)memberValueBySaveId2, (CampaignTime)memberValueBySaveId3, (int)memberValueBySaveId4, (AiBehavior)memberValueBySaveId5, (Vec2)memberValueBySaveId6, (bool)memberValueBySaveId7, (bool)memberValueBySaveId8, (memberValueBySaveId9 != null) ? ((MoveModeType)memberValueBySaveId9) : MoveModeType.Hold, (MobileParty)memberValueBySaveId10, (Vec2)memberValueBySaveId11, (Vec2)memberValueBySaveId12, (Vec2)fieldValueBySaveId, (Vec2)memberValueBySaveId13, oldAiBehaviorMapEntity, ((CampaignTime?)memberValueBySaveId14) ?? CampaignTime.Never);
				}
				this.UpdatePartyComponentFlags();
				if (this.IsGarrison || this.IsLordParty)
				{
					object memberValueBySaveId15 = objectLoadData.GetMemberValueBySaveId(1010);
					if (memberValueBySaveId15 != null)
					{
						this.SetWagePaymentLimit((int)memberValueBySaveId15);
					}
				}
			}
			if (MBSaveLoad.IsUpdatingGameVersion && MBSaveLoad.LastLoadedGameVersion.IsOlderThan(ApplicationVersion.FromString("v1.3.0", 0)))
			{
				object memberValueBySaveId16 = objectLoadData.GetMemberValueBySaveId(1100);
				this._position = new CampaignVec2((Vec2)memberValueBySaveId16, true);
				object memberValueBySaveId17 = objectLoadData.GetMemberValueBySaveId(1053);
				if (memberValueBySaveId17 != null)
				{
					this._targetPosition = new CampaignVec2((Vec2)memberValueBySaveId17, true);
				}
				memberValueBySaveId17 = objectLoadData.GetMemberValueBySaveId(212);
				if (memberValueBySaveId17 != null)
				{
					this._pathLastPosition = new CampaignVec2((Vec2)memberValueBySaveId17, true);
				}
				memberValueBySaveId17 = objectLoadData.GetMemberValueBySaveId(213);
				if (memberValueBySaveId17 != null)
				{
					this.NextTargetPosition = new CampaignVec2((Vec2)memberValueBySaveId17, true);
				}
				memberValueBySaveId17 = objectLoadData.GetMemberValueBySaveId(214);
				if (memberValueBySaveId17 != null)
				{
					this.MoveTargetPoint = new CampaignVec2((Vec2)memberValueBySaveId17, true);
				}
			}
		}

		// Token: 0x17000A56 RID: 2646
		// (get) Token: 0x06002A48 RID: 10824 RVA: 0x000AE028 File Offset: 0x000AC228
		// (set) Token: 0x06002A49 RID: 10825 RVA: 0x000AE030 File Offset: 0x000AC230
		public float RecentEventsMorale
		{
			get
			{
				return this._moraleDueToEvents;
			}
			set
			{
				this._moraleDueToEvents = value;
				if (this._moraleDueToEvents < -100f)
				{
					this._moraleDueToEvents = -100f;
					return;
				}
				if (this._moraleDueToEvents > 100f)
				{
					this._moraleDueToEvents = 100f;
				}
			}
		}

		// Token: 0x06002A4A RID: 10826 RVA: 0x000AE06C File Offset: 0x000AC26C
		public override string ToString()
		{
			return string.Concat(new object[]
			{
				base.StringId,
				":",
				this.Party.Index,
				" Name: ",
				this.Name.ToString()
			});
		}

		// Token: 0x17000A57 RID: 2647
		// (get) Token: 0x06002A4B RID: 10827 RVA: 0x000AE0BE File Offset: 0x000AC2BE
		public ExplainedNumber SeeingRangeExplanation
		{
			get
			{
				return Campaign.Current.Models.MapVisibilityModel.GetPartySpottingRange(this, true);
			}
		}

		// Token: 0x17000A58 RID: 2648
		// (get) Token: 0x06002A4C RID: 10828 RVA: 0x000AE0D8 File Offset: 0x000AC2D8
		public int InventoryCapacity
		{
			get
			{
				return (int)Campaign.Current.Models.InventoryCapacityModel.CalculateInventoryCapacity(this, this.IsCurrentlyAtSea, false, 0, 0, 0, false).ResultNumber;
			}
		}

		// Token: 0x17000A59 RID: 2649
		// (get) Token: 0x06002A4D RID: 10829 RVA: 0x000AE10E File Offset: 0x000AC30E
		public ExplainedNumber InventoryCapacityExplainedNumber
		{
			get
			{
				return Campaign.Current.Models.InventoryCapacityModel.CalculateInventoryCapacity(this, this.IsCurrentlyAtSea, true, 0, 0, 0, false);
			}
		}

		// Token: 0x17000A5A RID: 2650
		// (get) Token: 0x06002A4E RID: 10830 RVA: 0x000AE130 File Offset: 0x000AC330
		public float TotalWeightCarried
		{
			get
			{
				if (this.IsWeightCacheInvalid())
				{
					this._partyWeightLastCheckVersionNo = this.GetVersionNoForWeightCalculation();
					this._totalWeightCarriedCache = Campaign.Current.Models.InventoryCapacityModel.CalculateTotalWeightCarried(this, this.IsCurrentlyAtSea, false).ResultNumber;
				}
				return this._totalWeightCarriedCache;
			}
		}

		// Token: 0x17000A5B RID: 2651
		// (get) Token: 0x06002A4F RID: 10831 RVA: 0x000AE181 File Offset: 0x000AC381
		// (set) Token: 0x06002A50 RID: 10832 RVA: 0x000AE18E File Offset: 0x000AC38E
		public MapEventSide MapEventSide
		{
			get
			{
				return this.Party.MapEventSide;
			}
			set
			{
				this.Party.MapEventSide = value;
			}
		}

		// Token: 0x17000A5C RID: 2652
		// (get) Token: 0x06002A51 RID: 10833 RVA: 0x000AE19C File Offset: 0x000AC39C
		public ExplainedNumber TotalWeightCarriedExplainedNumber
		{
			get
			{
				return Campaign.Current.Models.InventoryCapacityModel.CalculateTotalWeightCarried(this, this.IsCurrentlyAtSea, true);
			}
		}

		// Token: 0x17000A5D RID: 2653
		// (get) Token: 0x06002A52 RID: 10834 RVA: 0x000AE1BC File Offset: 0x000AC3BC
		public float Morale
		{
			get
			{
				float resultNumber = Campaign.Current.Models.PartyMoraleModel.GetEffectivePartyMorale(this, false).ResultNumber;
				return (resultNumber < 0f) ? 0f : ((resultNumber > 100f) ? 100f : resultNumber);
			}
		}

		// Token: 0x17000A5E RID: 2654
		// (get) Token: 0x06002A53 RID: 10835 RVA: 0x000AE20C File Offset: 0x000AC40C
		public float FoodChange
		{
			get
			{
				ExplainedNumber baseConsumption = Campaign.Current.Models.MobilePartyFoodConsumptionModel.CalculateDailyBaseFoodConsumptionf(this, false);
				return Campaign.Current.Models.MobilePartyFoodConsumptionModel.CalculateDailyFoodConsumptionf(this, baseConsumption).ResultNumber;
			}
		}

		// Token: 0x17000A5F RID: 2655
		// (get) Token: 0x06002A54 RID: 10836 RVA: 0x000AE250 File Offset: 0x000AC450
		public float BaseFoodChange
		{
			get
			{
				return Campaign.Current.Models.MobilePartyFoodConsumptionModel.CalculateDailyBaseFoodConsumptionf(this, false).ResultNumber;
			}
		}

		// Token: 0x17000A60 RID: 2656
		// (get) Token: 0x06002A55 RID: 10837 RVA: 0x000AE27B File Offset: 0x000AC47B
		// (set) Token: 0x06002A56 RID: 10838 RVA: 0x000AE284 File Offset: 0x000AC484
		public Clan ActualClan
		{
			get
			{
				return this._actualClan;
			}
			set
			{
				if (this._actualClan != value)
				{
					WarPartyComponent warPartyComponent;
					if (this._actualClan != null && value != null && (warPartyComponent = (this.PartyComponent as WarPartyComponent)) != null)
					{
						warPartyComponent.OnClanChange(this._actualClan, value);
					}
					this._actualClan = value;
				}
			}
		}

		// Token: 0x17000A61 RID: 2657
		// (get) Token: 0x06002A57 RID: 10839 RVA: 0x000AE2C8 File Offset: 0x000AC4C8
		public ExplainedNumber FoodChangeExplained
		{
			get
			{
				ExplainedNumber baseConsumption = Campaign.Current.Models.MobilePartyFoodConsumptionModel.CalculateDailyBaseFoodConsumptionf(this, true);
				return Campaign.Current.Models.MobilePartyFoodConsumptionModel.CalculateDailyFoodConsumptionf(this, baseConsumption);
			}
		}

		// Token: 0x17000A62 RID: 2658
		// (get) Token: 0x06002A58 RID: 10840 RVA: 0x000AE302 File Offset: 0x000AC502
		public ExplainedNumber MoraleExplained
		{
			get
			{
				return Campaign.Current.Models.PartyMoraleModel.GetEffectivePartyMorale(this, true);
			}
		}

		// Token: 0x06002A59 RID: 10841 RVA: 0x000AE31A File Offset: 0x000AC51A
		internal void ValidateSpeed()
		{
			this.CalculateSpeed();
		}

		// Token: 0x06002A5A RID: 10842 RVA: 0x000AE323 File Offset: 0x000AC523
		public void ChangePartyLeader(Hero newLeader)
		{
			this.PartyComponent.ChangePartyLeader(newLeader);
		}

		// Token: 0x06002A5B RID: 10843 RVA: 0x000AE334 File Offset: 0x000AC534
		public void OnPartyInteraction(MobileParty engagingParty)
		{
			MobileParty mobileParty = this;
			if (mobileParty.AttachedTo != null && engagingParty != mobileParty.AttachedTo)
			{
				mobileParty = mobileParty.AttachedTo;
			}
			bool flag = false;
			if (mobileParty.CurrentSettlement != null)
			{
				if (mobileParty.MapEvent != null)
				{
					flag = (mobileParty.MapEvent.MapEventSettlement == mobileParty.CurrentSettlement && (mobileParty.MapEvent.AttackerSide.LeaderParty.MapFaction == engagingParty.MapFaction || mobileParty.MapEvent.DefenderSide.LeaderParty.MapFaction == engagingParty.MapFaction));
				}
			}
			else
			{
				flag = (engagingParty != MobileParty.MainParty || !mobileParty.IsEngaging || mobileParty.ShortTermTargetParty != MobileParty.MainParty);
			}
			if (flag)
			{
				if (engagingParty == MobileParty.MainParty)
				{
					MapState mapState = Game.Current.GameStateManager.ActiveState as MapState;
					if (mapState != null)
					{
						mapState.OnMainPartyEncounter();
					}
				}
				EncounterManager.StartPartyEncounter(engagingParty.Party, mobileParty.Party);
			}
		}

		// Token: 0x06002A5C RID: 10844 RVA: 0x000AE424 File Offset: 0x000AC624
		public void SetPositionAfterMapChange(CampaignVec2 newPosition)
		{
			this.Position = newPosition;
		}

		// Token: 0x06002A5D RID: 10845 RVA: 0x000AE42D File Offset: 0x000AC62D
		public void RemovePartyLeader()
		{
			this.PartyComponent.ChangePartyLeader(null);
		}

		// Token: 0x06002A5E RID: 10846 RVA: 0x000AE43C File Offset: 0x000AC63C
		public void CheckPositionsForMapChangeAndUpdateIfNeeded()
		{
			if (!this.Position.IsValid() || this.IsCurrentlyAtSea == this.Position.IsOnLand)
			{
				CampaignVec2 closestNavMeshFaceCenterPositionForPosition = NavigationHelper.GetClosestNavMeshFaceCenterPositionForPosition(this.Position, Campaign.Current.Models.PartyNavigationModel.GetInvalidTerrainTypesForNavigationType(this.IsCurrentlyAtSea ? MobileParty.NavigationType.Naval : MobileParty.NavigationType.Default));
				this.Position = NavigationHelper.FindPointAroundPosition(closestNavMeshFaceCenterPositionForPosition, this.NavigationCapability, 8f, 1f, true, false);
			}
		}

		// Token: 0x06002A5F RID: 10847 RVA: 0x000AE4B8 File Offset: 0x000AC6B8
		public void CheckAiForMapChangeAndUpdateIfNeeded()
		{
			if (!this.IsMainParty)
			{
				CampaignVec2 campaignVec = CampaignVec2.Invalid;
				if (this.TargetSettlement != null)
				{
					campaignVec = (this.IsTargetingPort ? this.TargetSettlement.PortPosition : this.TargetSettlement.GatePosition);
				}
				this.Ai.CacheAiBehaviorPartyBase();
				MobileParty mobileParty = this.MoveTargetParty ?? this.TargetParty;
				if (mobileParty != null)
				{
					mobileParty.CheckPositionsForMapChangeAndUpdateIfNeeded();
				}
				switch (this.DefaultBehavior)
				{
				case AiBehavior.Hold:
					this.MoveTargetPoint = this.Position;
					break;
				case AiBehavior.GoToSettlement:
				case AiBehavior.AssaultSettlement:
				case AiBehavior.RaidSettlement:
				case AiBehavior.BesiegeSettlement:
					this.MoveTargetPoint = campaignVec;
					break;
				case AiBehavior.EngageParty:
				case AiBehavior.JoinParty:
				case AiBehavior.EscortParty:
					this.MoveTargetPoint = mobileParty.Position;
					break;
				case AiBehavior.GoAroundParty:
					this.MoveTargetPoint = this.Ai.AiBehaviorPartyBase.Position;
					break;
				case AiBehavior.GoToPoint:
					if (this.Army != null)
					{
						IMapPoint aiBehaviorObject = this.Army.AiBehaviorObject;
						CampaignVec2 moveTargetPoint;
						if (aiBehaviorObject != null)
						{
							Settlement settlement;
							if ((settlement = (aiBehaviorObject as Settlement)) != null)
							{
								Settlement settlement2 = settlement;
								campaignVec = (this.IsTargetingPort ? settlement2.PortPosition : settlement2.GatePosition);
								moveTargetPoint = campaignVec;
								goto IL_16C;
							}
							MobileParty mobileParty2;
							if ((mobileParty2 = (aiBehaviorObject as MobileParty)) != null)
							{
								moveTargetPoint = mobileParty2.Position;
								goto IL_16C;
							}
						}
						moveTargetPoint = this.Army.AiBehaviorObject.Position;
						IL_16C:
						this.MoveTargetPoint = moveTargetPoint;
					}
					else
					{
						this.MoveTargetPoint = this.Position;
						this.SetMoveModeHold();
					}
					break;
				case AiBehavior.FleeToPoint:
				{
					CampaignVec2 moveTargetPoint2;
					this.Ai.CalculateFleePosition(out moveTargetPoint2, this.ShortTermTargetParty, (this.ShortTermTargetParty.Position - this.Position).ToVec2());
					this.MoveTargetPoint = moveTargetPoint2;
					break;
				}
				case AiBehavior.FleeToGate:
					this.MoveTargetPoint = campaignVec;
					break;
				case AiBehavior.FleeToParty:
					this.MoveTargetPoint = this.MoveTargetParty.Position;
					break;
				case AiBehavior.PatrolAroundPoint:
					if (this.MoveTargetParty != null)
					{
						this.MoveTargetPoint = this.MoveTargetParty.Position;
					}
					else if (this.TargetSettlement != null)
					{
						this.MoveTargetPoint = campaignVec;
					}
					else
					{
						Hideout hideout = SettlementHelper.FindNearestHideoutToMobileParty(this, this.NavigationCapability, null);
						Settlement settlement3 = (hideout != null) ? hideout.Settlement : null;
						if (settlement3 != null)
						{
							this.MoveTargetPoint = ((this.NavigationCapability == MobileParty.NavigationType.Naval) ? settlement3.PortPosition : settlement3.GatePosition);
						}
						else
						{
							this.MoveTargetPoint = this.Position;
							this.SetMoveModeHold();
						}
					}
					break;
				case AiBehavior.DefendSettlement:
					if (this.TargetSettlement.SiegeEvent != null)
					{
						this.MoveTargetPoint = this.TargetSettlement.SiegeEvent.BesiegerCamp.LeaderParty.Position;
					}
					else
					{
						this.MoveTargetPoint = campaignVec;
					}
					break;
				}
				if (this.DefaultBehavior != AiBehavior.EscortParty)
				{
					this.TargetPosition = this.MoveTargetPoint;
					this.Ai.BehaviorTarget = this.MoveTargetPoint;
					this.NextTargetPosition = this.MoveTargetPoint;
				}
			}
		}

		// Token: 0x06002A60 RID: 10848 RVA: 0x000AE7A4 File Offset: 0x000AC9A4
		[LoadInitializationCallback]
		private void OnLoad(MetaData metaData, ObjectLoadData objectLoadData)
		{
			object memberValueBySaveId = objectLoadData.GetMemberValueBySaveId(1032);
			if (memberValueBySaveId != null)
			{
				this._doNotAttackMainParty = (int)memberValueBySaveId;
			}
			if (MBSaveLoad.LastLoadedGameVersion.IsOlderThan(ApplicationVersion.FromString("v1.3.0", 0)))
			{
				this.HasLandNavigationCapability = true;
				this.Anchor = new AnchorPoint(this);
			}
		}

		// Token: 0x06002A61 RID: 10849 RVA: 0x000AE7FC File Offset: 0x000AC9FC
		protected override void PreAfterLoad()
		{
			this.UpdatePartyComponentFlags();
			PartyComponent partyComponent = this.PartyComponent;
			if (partyComponent != null)
			{
				partyComponent.Initialize(this);
			}
			this.ComputePathAfterLoad();
			AnchorPoint anchor = this.Anchor;
			if (anchor != null)
			{
				anchor.InitializeOnLoad(this);
			}
			this.Ai.PreAfterLoad();
			if (this._disorganizedUntilTime.IsFuture)
			{
				this._isDisorganized = true;
			}
			if (MBSaveLoad.IsUpdatingGameVersion && MBSaveLoad.LastLoadedGameVersion < ApplicationVersion.FromString("v1.2.2", 0))
			{
				if ((this.LeaderHero != null && this != MobileParty.MainParty && this.LeaderHero.PartyBelongedTo != this) || (this.MapEvent == null && base.StringId.Contains("troops_of_")))
				{
					DestroyPartyAction.Apply(null, this);
				}
				if (this.MapEvent == null && (base.StringId.Contains("troops_of_CharacterObject") || base.StringId.Contains("troops_of_TaleWorlds.CampaignSystem.CharacterObject")))
				{
					if (!this.IsActive)
					{
						this.IsActive = true;
					}
					DestroyPartyAction.Apply(null, this);
				}
			}
			if (MBSaveLoad.IsUpdatingGameVersion && MBSaveLoad.LastLoadedGameVersion < ApplicationVersion.FromString("v1.3.0", 0) && this.IsActive && this.MapFaction == null)
			{
				if (this.MapEvent != null)
				{
					this.MapEventSide = null;
				}
				this.RemoveParty();
			}
		}

		// Token: 0x06002A62 RID: 10850 RVA: 0x000AE940 File Offset: 0x000ACB40
		private void ComputePathAfterLoad()
		{
			if (this.DesiredAiNavigationType != MobileParty.NavigationType.None)
			{
				if (!this.MoveTargetPoint.Face.IsValid())
				{
					this.MoveTargetPoint = new CampaignVec2(this.MoveTargetPoint.ToVec2(), !this.MoveTargetPoint.IsOnLand);
				}
				TerrainType faceTerrainType = Campaign.Current.MapSceneWrapper.GetFaceTerrainType(this.MoveTargetPoint.Face);
				MobileParty.NavigationType navigationType = this.DesiredAiNavigationType;
				if (this.DesiredAiNavigationType == MobileParty.NavigationType.Naval != this.IsCurrentlyAtSea || !Campaign.Current.Models.PartyNavigationModel.IsTerrainTypeValidForNavigationType(faceTerrainType, this.DesiredAiNavigationType))
				{
					navigationType = MobileParty.NavigationType.All;
				}
				if (navigationType != MobileParty.NavigationType.None)
				{
					this.ComputePath(this.MoveTargetPoint, navigationType, !this.IsFleeing());
				}
			}
		}

		// Token: 0x06002A63 RID: 10851 RVA: 0x000AE9FD File Offset: 0x000ACBFD
		protected override void OnBeforeLoad()
		{
			this.InitMembers();
			this.InitCached();
			MobileParty attachedTo = this._attachedTo;
			if (attachedTo == null)
			{
				return;
			}
			attachedTo.AddAttachedPartyInternal(this);
		}

		// Token: 0x06002A64 RID: 10852 RVA: 0x000AEA1C File Offset: 0x000ACC1C
		private void InitCached()
		{
			this.Path = new NavigationPath();
			this.PathLastFace = PathFaceRecord.NullFaceRecord;
			this.ForceAiNoPathMode = false;
			((ILocatable<MobileParty>)this).LocatorNodeIndex = -1;
			this.ThinkParamsCache = new PartyThinkParams(this);
			this.ResetCached();
		}

		// Token: 0x06002A65 RID: 10853 RVA: 0x000AEA54 File Offset: 0x000ACC54
		private void ResetCached()
		{
			this._partySizeRatioLastCheckVersion = -1;
			this._cachedPartySizeRatio = 1f;
			this.VersionNo = 0;
			this._partyPureSpeedLastCheckVersion = -1;
			this._itemRosterVersionNo = -1;
			this.Party.InitCache();
		}

		// Token: 0x06002A66 RID: 10854 RVA: 0x000AEA88 File Offset: 0x000ACC88
		protected override void AfterLoad()
		{
			this.Party.AfterLoad();
			if (this.IsGarrison && this.MapEvent == null && this.SiegeEvent == null && this.TargetParty != null && this.CurrentSettlement != null)
			{
				this.SetMoveModeHold();
			}
			if (this.CurrentSettlement != null && !this.CurrentSettlement.Parties.Contains(this))
			{
				this.CurrentSettlement.AddMobileParty(this);
				foreach (MobileParty mobileParty in this._attachedParties)
				{
					if (this.Army.LeaderParty != this)
					{
						this.CurrentSettlement.AddMobileParty(mobileParty);
					}
				}
			}
			if (this._doNotAttackMainParty > 0)
			{
				this.Ai.DoNotAttackMainPartyUntil = CampaignTime.HoursFromNow((float)this._doNotAttackMainParty);
			}
			if (this.IsCaravan && this.Army != null)
			{
				this.Army = null;
			}
			if (MBSaveLoad.IsUpdatingGameVersion && MBSaveLoad.LastLoadedGameVersion < ApplicationVersion.FromString("v1.1.0", 0) && (this.PaymentLimit == 2000 || (this == MobileParty.MainParty && this.PaymentLimit == 0)))
			{
				this.SetWagePaymentLimit(Campaign.Current.Models.PartyWageModel.MaxWagePaymentLimit);
			}
			if (MBSaveLoad.IsUpdatingGameVersion && MBSaveLoad.LastLoadedGameVersion < ApplicationVersion.FromString("v1.2.0", 0) && this.IsCaravan && this.Owner == Hero.MainHero && this.ActualClan == null)
			{
				this.ActualClan = this.Owner.Clan;
			}
			if (MBSaveLoad.IsUpdatingGameVersion && MBSaveLoad.LastLoadedGameVersion < ApplicationVersion.FromString("v1.1.4", 0))
			{
				if (this.TargetParty != null)
				{
					IFaction mapFaction = this.TargetParty.MapFaction;
					if (mapFaction == null || !mapFaction.IsAtWarWith(this.MapFaction))
					{
						goto IL_24D;
					}
				}
				if (this.TargetSettlement != null)
				{
					IFaction mapFaction2 = this.TargetSettlement.MapFaction;
					if (mapFaction2 == null || !mapFaction2.IsAtWarWith(this.MapFaction))
					{
						goto IL_24D;
					}
				}
				if (this.ShortTermTargetParty == null)
				{
					return;
				}
				MobileParty shortTermTargetParty = this.ShortTermTargetParty;
				bool flag;
				if (shortTermTargetParty == null)
				{
					flag = true;
				}
				else
				{
					IFaction mapFaction3 = shortTermTargetParty.MapFaction;
					bool? flag2 = (mapFaction3 != null) ? new bool?(mapFaction3.IsAtWarWith(this.MapFaction)) : null;
					bool flag3 = true;
					flag = !(flag2.GetValueOrDefault() == flag3 & flag2 != null);
				}
				if (!flag)
				{
					return;
				}
				IL_24D:
				this.SetMoveModeHold();
			}
		}

		// Token: 0x06002A67 RID: 10855 RVA: 0x000AECF8 File Offset: 0x000ACEF8
		internal void OnFinishLoadState()
		{
			Campaign.Current.MobilePartyLocator.UpdateLocator(this);
		}

		// Token: 0x17000A63 RID: 2659
		// (get) Token: 0x06002A68 RID: 10856 RVA: 0x000AED0B File Offset: 0x000ACF0B
		// (set) Token: 0x06002A69 RID: 10857 RVA: 0x000AED13 File Offset: 0x000ACF13
		int ILocatable<MobileParty>.LocatorNodeIndex
		{
			get
			{
				return this._locatorNodeIndex;
			}
			set
			{
				this._locatorNodeIndex = value;
			}
		}

		// Token: 0x06002A6A RID: 10858 RVA: 0x000AED1C File Offset: 0x000ACF1C
		internal void HourlyTick()
		{
			if (this.IsActive)
			{
				if (this.LeaderHero != null && this.CurrentSettlement != null && this.CurrentSettlement == this.LeaderHero.HomeSettlement)
				{
					Hero leaderHero = this.LeaderHero;
					float passedTimeAtHomeSettlement = leaderHero.PassedTimeAtHomeSettlement;
					leaderHero.PassedTimeAtHomeSettlement = passedTimeAtHomeSettlement + 1f;
				}
				this.Anchor.HourlyTick();
			}
		}

		// Token: 0x06002A6B RID: 10859 RVA: 0x000AED78 File Offset: 0x000ACF78
		public void MovePartyToTheClosestLand()
		{
			int[] invalidTerrainTypesForNavigationType = Campaign.Current.Models.PartyNavigationModel.GetInvalidTerrainTypesForNavigationType(MobileParty.NavigationType.All);
			CampaignVec2 nearestFaceCenterForPositionWithPath = Campaign.Current.MapSceneWrapper.GetNearestFaceCenterForPositionWithPath(this.CurrentNavigationFace, true, Campaign.MapDiagonal / 2f, invalidTerrainTypesForNavigationType);
			this.SetNavigationModePoint(nearestFaceCenterForPositionWithPath);
			this.SetMoveGoToPoint(nearestFaceCenterForPositionWithPath, MobileParty.NavigationType.All);
		}

		// Token: 0x06002A6C RID: 10860 RVA: 0x000AEDCD File Offset: 0x000ACFCD
		internal void DailyTick()
		{
			this.RecentEventsMorale -= this.RecentEventsMorale * 0.1f;
			if (this.LeaderHero != null)
			{
				this.LeaderHero.PassedTimeAtHomeSettlement *= 0.9f;
			}
		}

		// Token: 0x06002A6D RID: 10861 RVA: 0x000AEE08 File Offset: 0x000AD008
		public TextObject GetBehaviorText()
		{
			TextObject textObject = TextObject.GetEmpty();
			if (this.Army != null && (this.AttachedTo != null || this.Army.LeaderParty == this) && !this.Army.LeaderParty.IsEngaging && !this.Army.LeaderParty.IsFleeing())
			{
				textObject = this.Army.GetLongTermBehaviorText(false);
			}
			if (textObject.IsEmpty())
			{
				if (this.DefaultBehavior == AiBehavior.Hold || this.ShortTermBehavior == AiBehavior.Hold || (this.IsMainParty && Campaign.Current.IsMainPartyWaiting))
				{
					if (this.IsVillager && this.HasNavalNavigationCapability)
					{
						textObject = new TextObject("{=WYxUqYpu}Fishing.", null);
					}
					else
					{
						textObject = new TextObject("{=RClxLG6N}Holding.", null);
					}
				}
				else if (this.ShortTermBehavior == AiBehavior.EngageParty && this.ShortTermTargetParty != null)
				{
					textObject = new TextObject("{=5bzk75Ql}Engaging {TARGET_PARTY}.", null);
					textObject.SetTextVariable("TARGET_PARTY", this.ShortTermTargetParty.Name);
				}
				else if (this.DefaultBehavior == AiBehavior.GoAroundParty && this.ShortTermBehavior == AiBehavior.GoToPoint)
				{
					textObject = new TextObject("{=XYAVu2f0}Chasing {TARGET_PARTY}.", null);
					textObject.SetTextVariable("TARGET_PARTY", this.TargetParty.Name);
				}
				else if (this.ShortTermBehavior == AiBehavior.FleeToParty && this.ShortTermTargetParty != null)
				{
					textObject = new TextObject("{=R8vuwKaf}Running from {TARGET_PARTY} to ally party.", null);
					textObject.SetTextVariable("TARGET_PARTY", this.ShortTermTargetParty.Name);
				}
				else if (this.ShortTermBehavior == AiBehavior.FleeToPoint)
				{
					if (this.ShortTermTargetParty != null)
					{
						textObject = new TextObject("{=AcMayd1p}Running from {TARGET_PARTY}.", null);
						textObject.SetTextVariable("TARGET_PARTY", this.ShortTermTargetParty.Name);
					}
					else
					{
						textObject = new TextObject("{=5W2oZOwu}Sailing away from storm.", null);
					}
				}
				else if (this.ShortTermBehavior == AiBehavior.FleeToGate && this.ShortTermTargetSettlement != null)
				{
					textObject = new TextObject("{=p0C3WfHE}Running to settlement.", null);
				}
				else if (this.DefaultBehavior == AiBehavior.DefendSettlement)
				{
					textObject = new TextObject("{=rGy8vjOv}Defending {TARGET_SETTLEMENT}.", null);
					if (this.ShortTermBehavior == AiBehavior.GoToPoint)
					{
						if (!this.IsMoving)
						{
							textObject = new TextObject("{=LAt87KjS}Waiting for ally parties to defend {TARGET_SETTLEMENT}.", null);
						}
						else if (this.ShortTermTargetParty != null && this.ShortTermTargetParty.MapFaction == this.MapFaction)
						{
							textObject = new TextObject("{=yD7rL5Nc}Helping ally party to defend {TARGET_SETTLEMENT}.", null);
						}
					}
					textObject.SetTextVariable("TARGET_SETTLEMENT", this.TargetSettlement.Name);
				}
				else if (this.DefaultBehavior == AiBehavior.RaidSettlement)
				{
					Settlement targetSettlement = this.TargetSettlement;
					float num;
					if (Campaign.Current.Models.MapDistanceModel.GetDistance(this, targetSettlement, this.IsTargetingPort, this.NavigationCapability, out num) > Campaign.Current.GetAverageDistanceBetweenClosestTwoTownsWithNavigationType(MobileParty.NavigationType.All) * 0.5f)
					{
						textObject = new TextObject("{=BqIRb85N}Going to raid {TARGET_SETTLEMENT}", null);
					}
					else
					{
						textObject = new TextObject("{=VtWa9Pmh}Raiding {TARGET_SETTLEMENT}.", null);
					}
					textObject.SetTextVariable("TARGET_SETTLEMENT", targetSettlement.Name);
				}
				else if (this.DefaultBehavior == AiBehavior.BesiegeSettlement)
				{
					textObject = new TextObject("{=JTxI3sW2}Besieging {TARGET_SETTLEMENT}.", null);
					textObject.SetTextVariable("TARGET_SETTLEMENT", this.TargetSettlement.Name);
				}
				else if (this.ShortTermBehavior == AiBehavior.GoToPoint && this.DefaultBehavior != AiBehavior.EscortParty)
				{
					if (this.ShortTermTargetParty != null)
					{
						textObject = new TextObject("{=AcMayd1p}Running from {TARGET_PARTY}.", null);
						textObject.SetTextVariable("TARGET_PARTY", this.ShortTermTargetParty.Name);
					}
					else if (this.TargetSettlement != null)
					{
						if (this.DefaultBehavior == AiBehavior.PatrolAroundPoint)
						{
							bool flag = this.IsLordParty && !this.AiBehaviorTarget.IsOnLand;
							float num;
							if (Campaign.Current.Models.MapDistanceModel.GetDistance(this, this.TargetSettlement, this.IsTargetingPort, this.NavigationCapability, out num) > Campaign.Current.GetAverageDistanceBetweenClosestTwoTownsWithNavigationType(MobileParty.NavigationType.All) * 0.5f)
							{
								textObject = (flag ? new TextObject("{=avhlH79s}Heading to patrol the coastal waters off {TARGET_SETTLEMENT}.", null) : new TextObject("{=MNoogAgk}Heading to patrol around {TARGET_SETTLEMENT}.", null));
							}
							else
							{
								textObject = (flag ? new TextObject("{=8qvUbTvW}Guarding the coastal waters off {TARGET_SETTLEMENT}.", null) : new TextObject("{=yUVv3z5V}Patrolling around {TARGET_SETTLEMENT}.", null));
							}
							textObject.SetTextVariable("TARGET_SETTLEMENT", (this.TargetSettlement != null) ? this.TargetSettlement.Name : this.HomeSettlement.Name);
						}
						else
						{
							textObject = new TextObject("{=TaK6ydAx}Travelling.", null);
						}
					}
					else if (this.DefaultBehavior == AiBehavior.MoveToNearestLandOrPort)
					{
						textObject = new TextObject("{=8vuOdcpy}Moving to the nearest shore.", null);
					}
					else if (this.DefaultBehavior == AiBehavior.PatrolAroundPoint)
					{
						textObject = new TextObject("{=BifGz0h4}Patrolling.", null);
					}
					else if (this.IsInRaftState)
					{
						textObject = new TextObject("{=vxdIEThU}Drifting to shore.", null);
					}
					else
					{
						textObject = new TextObject("{=XAL3t1bs}Going to a point.", null);
					}
				}
				else if (this.ShortTermBehavior == AiBehavior.GoToSettlement || this.DefaultBehavior == AiBehavior.GoToSettlement)
				{
					if (this.ShortTermBehavior == AiBehavior.GoToSettlement && this.ShortTermTargetSettlement != null && this.ShortTermTargetSettlement != this.TargetSettlement)
					{
						if (this.DefaultBehavior == AiBehavior.MoveToNearestLandOrPort)
						{
							textObject = new TextObject("{=amHKbKfV}Running away from the sea.", null);
							textObject.SetTextVariable("TARGET_PARTY", this.ShortTermTargetSettlement.Name);
						}
						else
						{
							if (this.ShortTermTargetParty == null || !this.ShortTermTargetParty.MapFaction.IsAtWarWith(this.MapFaction))
							{
								textObject = new TextObject("{=EQHq3bHM}Travelling to {TARGET_PARTY}", null);
							}
							else
							{
								textObject = new TextObject("{=NRpbagbZ}Running to {TARGET_PARTY}.", null);
							}
							textObject.SetTextVariable("TARGET_PARTY", this.ShortTermTargetSettlement.Name);
						}
					}
					else if (this.DefaultBehavior == AiBehavior.GoToSettlement && this.TargetSettlement != null)
					{
						if (this.CurrentSettlement == this.TargetSettlement)
						{
							textObject = new TextObject("{=Y65gdbrx}Waiting in {TARGET_PARTY}.", null);
						}
						else
						{
							textObject = new TextObject("{=EQHq3bHM}Travelling to {TARGET_PARTY}", null);
						}
						textObject.SetTextVariable("TARGET_PARTY", this.TargetSettlement.Name);
					}
					else if (this.ShortTermTargetParty != null)
					{
						textObject = new TextObject("{=AcMayd1p}Running from {TARGET_PARTY}.", null);
						textObject.SetTextVariable("TARGET_PARTY", this.ShortTermTargetParty.Name);
					}
					else
					{
						textObject = new TextObject("{=QGyoSLeY}Traveling to a settlement.", null);
					}
				}
				else if (this.ShortTermBehavior == AiBehavior.AssaultSettlement)
				{
					textObject = new TextObject("{=exnL6SS7}Attacking {TARGET_SETTLEMENT}.", null);
					textObject.SetTextVariable("TARGET_SETTLEMENT", this.ShortTermTargetSettlement.Name);
				}
				else if (this.DefaultBehavior == AiBehavior.EscortParty || this.ShortTermBehavior == AiBehavior.EscortParty)
				{
					textObject = new TextObject("{=OpzzCPiP}Following {TARGET_PARTY}.", null);
					textObject.SetTextVariable("TARGET_PARTY", (this.ShortTermTargetParty != null) ? this.ShortTermTargetParty.Name : this.TargetParty.Name);
				}
				else if (this.DefaultBehavior == AiBehavior.MoveToNearestLandOrPort)
				{
					textObject = new TextObject("{=amHKbKfV}Running away from the sea.", null);
				}
				else
				{
					textObject = new TextObject("{=QXBf26Rv}Unknown Behavior.", null);
				}
			}
			return textObject;
		}

		// Token: 0x06002A6E RID: 10862 RVA: 0x000AF49C File Offset: 0x000AD69C
		public override void Initialize()
		{
			base.Initialize();
			this.Aggressiveness = 1f;
			this.Ai = new MobilePartyAi(this);
			this._formationPosition.x = 10000f;
			this._formationPosition.y = 10000f;
			while (this._formationPosition.LengthSquared > 0.36f || this._formationPosition.LengthSquared < 0.22f)
			{
				this._formationPosition = new Vec2(MBRandom.RandomFloat * 1.2f - 0.6f, MBRandom.RandomFloat * 1.2f - 0.6f);
			}
			CampaignEventDispatcher.Instance.OnPartyVisibilityChanged(this.Party);
		}

		// Token: 0x06002A6F RID: 10863 RVA: 0x000AF549 File Offset: 0x000AD749
		private void InitMembers()
		{
			if (this._attachedParties == null)
			{
				this._attachedParties = new MBList<MobileParty>();
			}
		}

		// Token: 0x06002A70 RID: 10864 RVA: 0x000AF55E File Offset: 0x000AD75E
		public void InitializeMobilePartyAtPosition(CampaignVec2 position)
		{
			this.IsCurrentlyAtSea = !position.IsOnLand;
			this.CreateFigure(position);
			this.SetMoveModeHold();
		}

		// Token: 0x06002A71 RID: 10865 RVA: 0x000AF57C File Offset: 0x000AD77C
		public void InitializeMobilePartyAtPosition(TroopRoster memberRoster, TroopRoster prisonerRoster, CampaignVec2 position, bool isNaval = false)
		{
			this.InitializeMobilePartyWithRosterInternal(memberRoster, prisonerRoster, position);
		}

		// Token: 0x06002A72 RID: 10866 RVA: 0x000AF588 File Offset: 0x000AD788
		public void InitializeMobilePartyAroundPosition(TroopRoster memberRoster, TroopRoster prisonerRoster, CampaignVec2 position, float spawnRadius, float minSpawnRadius = 0f, bool isNaval = false)
		{
			if (spawnRadius > 0f)
			{
				MobileParty.NavigationType navigationCapability = isNaval ? MobileParty.NavigationType.Naval : MobileParty.NavigationType.Default;
				position = NavigationHelper.FindReachablePointAroundPosition(position, navigationCapability, spawnRadius, minSpawnRadius, false);
			}
			this.InitializeMobilePartyWithRosterInternal(memberRoster, prisonerRoster, position);
		}

		// Token: 0x06002A73 RID: 10867 RVA: 0x000AF5BE File Offset: 0x000AD7BE
		public void InitializeMobilePartyAtPosition(PartyTemplateObject pt, CampaignVec2 position)
		{
			this.InitializeMobilePartyWithPartyTemplate(pt, position);
		}

		// Token: 0x06002A74 RID: 10868 RVA: 0x000AF5C8 File Offset: 0x000AD7C8
		private void InitializeMobilePartyWithPartyTemplate(PartyTemplateObject pt, CampaignVec2 position)
		{
			TroopRoster memberRoster = Campaign.Current.Models.PartySizeLimitModel.FindAppropriateInitialRosterForMobileParty(this, pt);
			foreach (Ship ship in Campaign.Current.Models.PartySizeLimitModel.FindAppropriateInitialShipsForMobileParty(this, pt))
			{
				ChangeShipOwnerAction.ApplyByMobilePartyCreation(this.Party, ship);
			}
			this.InitializeMobilePartyWithRosterInternal(memberRoster, null, position);
		}

		// Token: 0x06002A75 RID: 10869 RVA: 0x000AF650 File Offset: 0x000AD850
		private void InitializeMobilePartyWithRosterInternal(TroopRoster memberRoster, TroopRoster prisonerRoster, CampaignVec2 position)
		{
			this.MemberRoster.Add(memberRoster);
			if (prisonerRoster != null)
			{
				this.PrisonRoster.Add(prisonerRoster);
			}
			this.InitializeMobilePartyAtPosition(position);
		}

		// Token: 0x06002A76 RID: 10870 RVA: 0x000AF674 File Offset: 0x000AD874
		public void InitializeMobilePartyAroundPosition(PartyTemplateObject pt, CampaignVec2 position, float spawnRadius, float minSpawnRadius = 0f)
		{
			if (spawnRadius > 0f)
			{
				position = NavigationHelper.FindReachablePointAroundPosition(position, (!position.IsOnLand) ? MobileParty.NavigationType.Naval : MobileParty.NavigationType.Default, spawnRadius, minSpawnRadius, false);
			}
			this.InitializeMobilePartyWithPartyTemplate(pt, position);
		}

		// Token: 0x06002A77 RID: 10871 RVA: 0x000AF6A0 File Offset: 0x000AD8A0
		internal void InitializePartyForOldSave(int numberOfRecentFleeingFromAParty, AiBehavior defaultBehavior, bool aiPathMode, MoveModeType partyMoveMode, Vec2 formationPosition, MobileParty moveTargetParty, Vec2 nextTargetPosition, Vec2 moveTargetPoint, Vec2 aiPathLastPosition)
		{
			this._defaultBehavior = defaultBehavior;
			this._pathMode = aiPathMode;
			this.PartyMoveMode = partyMoveMode;
			this._formationPosition = formationPosition;
			this.MoveTargetParty = moveTargetParty;
			this.NextTargetPosition = new CampaignVec2(nextTargetPosition, true);
			this.MoveTargetPoint = new CampaignVec2(moveTargetPoint, true);
			this._pathLastPosition = new CampaignVec2(aiPathLastPosition, true);
		}

		// Token: 0x17000A64 RID: 2660
		// (get) Token: 0x06002A78 RID: 10872 RVA: 0x000AF700 File Offset: 0x000AD900
		[CachedData]
		public PathFaceRecord CurrentNavigationFace
		{
			get
			{
				return this.Position.Face;
			}
		}

		// Token: 0x17000A65 RID: 2661
		// (get) Token: 0x06002A79 RID: 10873 RVA: 0x000AF71B File Offset: 0x000AD91B
		// (set) Token: 0x06002A7A RID: 10874 RVA: 0x000AF723 File Offset: 0x000AD923
		[CachedData]
		public int PathBegin { get; private set; }

		// Token: 0x17000A66 RID: 2662
		// (get) Token: 0x06002A7B RID: 10875 RVA: 0x000AF72C File Offset: 0x000AD92C
		// (set) Token: 0x06002A7C RID: 10876 RVA: 0x000AF734 File Offset: 0x000AD934
		[CachedData]
		public bool ForceAiNoPathMode { get; set; }

		// Token: 0x06002A7D RID: 10877 RVA: 0x000AF73D File Offset: 0x000AD93D
		internal void TickForStationaryMobileParty(ref MobileParty.CachedPartyVariables variables, float dt, float realDt)
		{
			if (this.StationaryStartTime == CampaignTime.Never)
			{
				this.StationaryStartTime = CampaignTime.Now;
			}
			this.CheckIsDisorganized();
			this.DoUpdatePosition(ref variables, dt, realDt);
		}

		// Token: 0x06002A7E RID: 10878 RVA: 0x000AF76B File Offset: 0x000AD96B
		internal void FillCurrentTickMoveDataForMovingMobileParty(ref MobileParty.CachedPartyVariables variables, float dt, float realDt)
		{
			this.ComputeNextMoveDistance(ref variables, dt);
			this.CommonMovingPartyTick(ref variables, dt, realDt);
		}

		// Token: 0x06002A7F RID: 10879 RVA: 0x000AF77E File Offset: 0x000AD97E
		internal void FillCurrentTickMoveDataForMovingArmyLeader(ref MobileParty.CachedPartyVariables variables, float dt, float realDt)
		{
			this.ComputeNextMoveDistanceForArmyLeader(ref variables, dt);
			this.CommonMovingPartyTick(ref variables, dt, realDt);
		}

		// Token: 0x06002A80 RID: 10880 RVA: 0x000AF791 File Offset: 0x000AD991
		private void CommonMovingPartyTick(ref MobileParty.CachedPartyVariables variables, float dt, float realDt)
		{
			this.StationaryStartTime = CampaignTime.Never;
			this.CheckIsDisorganized();
			this.DoAiPathMode(ref variables);
			this.DoUpdatePosition(ref variables, dt, realDt);
		}

		// Token: 0x06002A81 RID: 10881 RVA: 0x000AF7B4 File Offset: 0x000AD9B4
		internal void CommonTransitioningPartyTick(ref MobileParty.CachedPartyVariables variables, ref int navigationTypeChangeCounter, ref MobileParty[] navigationTypeChangeList, float dt)
		{
			if (this.ShouldEndTransition())
			{
				int num = Interlocked.Increment(ref navigationTypeChangeCounter);
				navigationTypeChangeList[num] = this;
				return;
			}
			if (dt > 0f)
			{
				if (!this.HasNavalNavigationCapability)
				{
					this.CancelNavigationTransitionParallel();
					return;
				}
				if (this.CurrentSettlement == null)
				{
					Vec2 direction = CampaignVec2.Normalized(variables.NextPosition - this.Position).ToVec2();
					if (direction.IsNonZero())
					{
						NavigationHelper.EmbarkDisembarkData embarkDisembarkData = this.IsMainParty ? NavigationHelper.GetEmbarkAndDisembarkDataForPlayer(this.Position, direction, this.MoveTargetPoint, true) : NavigationHelper.GetEmbarkDisembarkDataForTick(this.Position, direction);
						PathFaceRecord face = embarkDisembarkData.TransitionEndPosition.Face;
						PathFaceRecord face2 = this.EndPositionForNavigationTransition.Face;
						if (embarkDisembarkData.IsTargetingOwnSideOfTheDeadZone || face.FaceIndex == this.CurrentNavigationFace.FaceIndex || face2.FaceIndex != face.FaceIndex)
						{
							this.CancelNavigationTransitionParallel();
						}
					}
				}
			}
		}

		// Token: 0x06002A82 RID: 10882 RVA: 0x000AF898 File Offset: 0x000ADA98
		internal void InitializeCachedPartyVariables(ref MobileParty.CachedPartyVariables variables)
		{
			variables.HasMapEvent = (this.MapEvent != null);
			variables.CurrentPosition = this.Position;
			variables.TargetPartyPositionAtFrameStart = CampaignVec2.Invalid;
			variables.LastCurrentPosition = this.Position;
			variables.IsAttachedArmyMember = false;
			variables.IsMoving = this.IsMoving;
			variables.IsArmyLeader = false;
			variables.NextPosition = this.Position;
			variables.IsTransitionInProgress = this.IsTransitionInProgress;
			if (this.Army != null)
			{
				if (this.Army.LeaderParty == this)
				{
					variables.IsArmyLeader = true;
					return;
				}
				if (this.AttachedTo != null)
				{
					variables.IsAttachedArmyMember = true;
					variables.IsMoving = (this.IsMoving || this.Army.LeaderParty.IsMoving);
					variables.IsTransitionInProgress = this.Army.LeaderParty.IsTransitionInProgress;
				}
			}
		}

		// Token: 0x06002A83 RID: 10883 RVA: 0x000AF96D File Offset: 0x000ADB6D
		internal void ComputeNextMoveDistanceForArmyLeader(ref MobileParty.CachedPartyVariables variables, float dt)
		{
			if (dt > 0f)
			{
				this.CalculateSpeedForPartyUnified();
				variables.NextMoveDistance = this.Speed * dt;
				return;
			}
			variables.NextMoveDistance = 0f;
		}

		// Token: 0x06002A84 RID: 10884 RVA: 0x000AF998 File Offset: 0x000ADB98
		internal void ComputeNextMoveDistance(ref MobileParty.CachedPartyVariables variables, float dt)
		{
			if (dt > 0f)
			{
				this.CalculateSpeed();
				variables.NextMoveDistance = this.Speed * dt;
				return;
			}
			variables.NextMoveDistance = 0f;
		}

		// Token: 0x06002A85 RID: 10885 RVA: 0x000AF9C3 File Offset: 0x000ADBC3
		internal void UpdateStationaryTimer()
		{
			if (!this.IsMoving)
			{
				if (this.StationaryStartTime == CampaignTime.Never)
				{
					this.StationaryStartTime = CampaignTime.Now;
					return;
				}
			}
			else
			{
				this.StationaryStartTime = CampaignTime.Never;
			}
		}

		// Token: 0x06002A86 RID: 10886 RVA: 0x000AF9F6 File Offset: 0x000ADBF6
		private void CheckIsDisorganized()
		{
			if (this._isDisorganized && this._disorganizedUntilTime.IsPast)
			{
				this.SetDisorganized(false);
			}
		}

		// Token: 0x06002A87 RID: 10887 RVA: 0x000AFA14 File Offset: 0x000ADC14
		public void SetDisorganized(bool isDisorganized)
		{
			if (isDisorganized)
			{
				this._disorganizedUntilTime = CampaignTime.HoursFromNow(Campaign.Current.Models.PartyImpairmentModel.GetDisorganizedStateDuration(this).ResultNumber);
			}
			this._isDisorganized = isDisorganized;
			this.UpdateVersionNo();
		}

		// Token: 0x06002A88 RID: 10888 RVA: 0x000AFA59 File Offset: 0x000ADC59
		internal void CacheTargetPartyVariablesAtFrameStart(ref MobileParty.CachedPartyVariables variables)
		{
			if (this.MoveTargetParty != null)
			{
				variables.TargetPartyPositionAtFrameStart = this.MoveTargetParty.Position;
				variables.IsTargetMovingAtFrameStart = (this.MoveTargetParty.IsMoving || this.MoveTargetParty.IsTransitionInProgress);
			}
		}

		// Token: 0x06002A89 RID: 10889 RVA: 0x000AFA98 File Offset: 0x000ADC98
		public void RecalculateShortTermBehavior()
		{
			if (this.DefaultBehavior == AiBehavior.RaidSettlement)
			{
				this.SetShortTermBehavior(AiBehavior.RaidSettlement, this.TargetSettlement.Party);
				return;
			}
			if (this.DefaultBehavior == AiBehavior.BesiegeSettlement)
			{
				this.SetShortTermBehavior(AiBehavior.BesiegeSettlement, this.TargetSettlement.Party);
				return;
			}
			if (this.DefaultBehavior == AiBehavior.GoToSettlement)
			{
				this.SetShortTermBehavior(AiBehavior.GoToSettlement, this.TargetSettlement.Party);
				return;
			}
			if (this.DefaultBehavior == AiBehavior.EngageParty)
			{
				this.SetShortTermBehavior(AiBehavior.EngageParty, this.TargetParty.Party);
				return;
			}
			if (this.DefaultBehavior == AiBehavior.DefendSettlement)
			{
				this.SetShortTermBehavior(AiBehavior.GoToPoint, this.TargetSettlement.Party);
				return;
			}
			if (this.DefaultBehavior == AiBehavior.EscortParty)
			{
				this.SetShortTermBehavior(AiBehavior.EscortParty, this.TargetParty.Party);
				return;
			}
			if (this.DefaultBehavior == AiBehavior.GoToPoint)
			{
				this.SetShortTermBehavior(AiBehavior.GoToPoint, this.Ai.AiBehaviorInteractable);
				return;
			}
			if (this.DefaultBehavior == AiBehavior.MoveToNearestLandOrPort)
			{
				this.SetShortTermBehavior(AiBehavior.GoToPoint, null);
				return;
			}
			if (this.DefaultBehavior == AiBehavior.None)
			{
				this.ShortTermBehavior = AiBehavior.None;
			}
		}

		// Token: 0x06002A8A RID: 10890 RVA: 0x000AFB94 File Offset: 0x000ADD94
		internal void SetShortTermBehavior(AiBehavior newBehavior, IInteractablePoint mapEntity)
		{
			if (this.ShortTermBehavior != newBehavior)
			{
				this.ShortTermBehavior = newBehavior;
			}
			if (!this.IsMainParty && this.DefaultBehavior == AiBehavior.Hold && this.DesiredAiNavigationType == MobileParty.NavigationType.None && !this.IsMilitia && !this.IsGarrison)
			{
				this.DesiredAiNavigationType = (this.IsCurrentlyAtSea ? (this.HasNavalNavigationCapability ? MobileParty.NavigationType.Naval : MobileParty.NavigationType.None) : MobileParty.NavigationType.Default);
			}
			this.Ai.AiBehaviorInteractable = mapEntity;
		}

		// Token: 0x06002A8B RID: 10891 RVA: 0x000AFC02 File Offset: 0x000ADE02
		public static bool IsFleeBehavior(AiBehavior aiBehavior)
		{
			return aiBehavior == AiBehavior.FleeToPoint || aiBehavior == AiBehavior.FleeToGate || aiBehavior == AiBehavior.FleeToParty;
		}

		// Token: 0x06002A8C RID: 10892 RVA: 0x000AFC15 File Offset: 0x000ADE15
		public bool IsFleeing()
		{
			return MobileParty.IsFleeBehavior(this.ShortTermBehavior) || MobileParty.IsFleeBehavior(this.DefaultBehavior);
		}

		// Token: 0x06002A8D RID: 10893 RVA: 0x000AFC31 File Offset: 0x000ADE31
		private void UpdatePathModeWithPosition(CampaignVec2 newTargetPosition)
		{
			this.MoveTargetPoint = newTargetPosition;
			NavigationHelper.IsPositionValidForNavigationType(newTargetPosition, this.NavigationCapability);
		}

		// Token: 0x06002A8E RID: 10894 RVA: 0x000AFC48 File Offset: 0x000ADE48
		internal void TryToMoveThePartyWithCurrentTickMoveData(ref MobileParty.CachedPartyVariables variables, ref int gridChangeCount, ref MobileParty[] gridChangeMobilePartyList)
		{
			if (variables.NextMoveDistance > 0f && variables.IsMoving && this.BesiegedSettlement == null && !variables.HasMapEvent)
			{
				this.CheckTransitionParallel(ref variables, ref gridChangeCount, ref gridChangeMobilePartyList);
				if (!this.IsTransitionInProgress || this.IsInRaftState)
				{
					if (variables.IsAttachedArmyMember)
					{
						CampaignVec2 campaignVec = this.Army.LeaderParty.Position;
						Vec2 v = campaignVec.ToVec2();
						campaignVec = this.Position;
						Vec2 v2 = campaignVec.ToVec2() + this.ArmyPositionAdder;
						campaignVec = variables.NextPosition - this.Position;
						if ((v - (v2 + campaignVec.ToVec2())).Length > 1E-05f)
						{
							campaignVec = this.Army.LeaderParty.Position;
							this.SetPositionParallel(campaignVec, ref gridChangeCount, ref gridChangeMobilePartyList);
							Vec2 armyPositionAdder = this.ArmyPositionAdder;
							Vec2 v3 = variables.NextPosition.ToVec2();
							campaignVec = this.Position;
							this.ArmyPositionAdder = armyPositionAdder + (v3 - campaignVec.ToVec2());
							return;
						}
					}
					if (this.CurrentNavigationFace.IsValid() && this.CurrentNavigationFace.FaceIslandIndex == variables.NextPosition.Face.FaceIslandIndex)
					{
						this.SetPositionParallel(variables.NextPosition, ref gridChangeCount, ref gridChangeMobilePartyList);
					}
				}
			}
		}

		// Token: 0x06002A8F RID: 10895 RVA: 0x000AFD98 File Offset: 0x000ADF98
		internal void CheckTransitionParallel(ref MobileParty.CachedPartyVariables variables, ref int gridChangeCount, ref MobileParty[] gridChangeMobilePartyList)
		{
			if (this.AttachedTo == null && (!this.IsMainParty || this.IsCurrentlyAtSea) && !this.IsTransitionInProgress && this.CurrentNavigationFace.IsValid() && (this.IsCurrentlyAtSea ? this.HasLandNavigationCapability : this.HasNavalNavigationCapability))
			{
				Vec2 direction = CampaignVec2.Normalized(variables.NextPosition - variables.CurrentPosition).ToVec2();
				NavigationHelper.EmbarkDisembarkData embarkDisembarkData = this.IsMainParty ? NavigationHelper.GetEmbarkAndDisembarkDataForPlayer(this.Position, direction, this.MoveTargetPoint, true) : NavigationHelper.GetEmbarkDisembarkDataForTick(this.Position, direction);
				if (embarkDisembarkData.IsValidTransition && !embarkDisembarkData.IsTargetingOwnSideOfTheDeadZone)
				{
					TerrainType faceGroupIndex = (TerrainType)embarkDisembarkData.TransitionEndPosition.Face.FaceGroupIndex;
					if (!Campaign.Current.Models.PartyNavigationModel.IsTerrainTypeValidForNavigationType(faceGroupIndex, this.IsCurrentlyAtSea ? MobileParty.NavigationType.Naval : MobileParty.NavigationType.Default) && Campaign.Current.Models.PartyNavigationModel.IsTerrainTypeValidForNavigationType(faceGroupIndex, MobileParty.NavigationType.All))
					{
						float num = embarkDisembarkData.TransitionStartPosition.Distance(embarkDisembarkData.NavMeshEdgePosition);
						float num2 = embarkDisembarkData.NavMeshEdgePosition.Distance(variables.CurrentPosition);
						if (this.MoveTargetPoint.Distance(variables.CurrentPosition) > num2 && (num2 < num || num2 < variables.NextMoveDistance))
						{
							this.InitializeNavigationTransitionParallel(embarkDisembarkData.TransitionStartPosition, embarkDisembarkData.TransitionEndPosition, ref gridChangeCount, ref gridChangeMobilePartyList);
							variables.NextMoveDistance = 0f;
						}
					}
				}
			}
		}

		// Token: 0x17000A67 RID: 2663
		// (get) Token: 0x06002A90 RID: 10896 RVA: 0x000AFF17 File Offset: 0x000AE117
		// (set) Token: 0x06002A91 RID: 10897 RVA: 0x000AFF1F File Offset: 0x000AE11F
		public Vec2 EventPositionAdder
		{
			get
			{
				return this._eventPositionAdder;
			}
			set
			{
				this._eventPositionAdder = value;
			}
		}

		// Token: 0x06002A92 RID: 10898 RVA: 0x000AFF28 File Offset: 0x000AE128
		private bool ShouldEndTransition()
		{
			if (this.IsTransitionInProgress && (this.NavigationTransitionStartTime + this.NavigationTransitionDuration).IsPast)
			{
				return this.AttachedParties.All((MobileParty x) => x.ShouldEndTransition());
			}
			return false;
		}

		// Token: 0x17000A68 RID: 2664
		// (get) Token: 0x06002A93 RID: 10899 RVA: 0x000AFF84 File Offset: 0x000AE184
		// (set) Token: 0x06002A94 RID: 10900 RVA: 0x000AFF8C File Offset: 0x000AE18C
		public bool IsVisible
		{
			get
			{
				return this._isVisible;
			}
			set
			{
				if (this._isVisible != value)
				{
					this._isVisible = value;
					this.Party.OnVisibilityChanged(value);
					if (!this.IsCurrentlyAtSea || this.IsTransitionInProgress)
					{
						SiegeEvent siegeEvent = this.SiegeEvent;
						if (siegeEvent == null || !siegeEvent.IsBlockadeActive)
						{
							return;
						}
					}
					this.SetNavalVisualAsDirty();
				}
			}
		}

		// Token: 0x17000A69 RID: 2665
		// (get) Token: 0x06002A95 RID: 10901 RVA: 0x000AFFDF File Offset: 0x000AE1DF
		// (set) Token: 0x06002A96 RID: 10902 RVA: 0x000AFFE7 File Offset: 0x000AE1E7
		public CampaignVec2 Position
		{
			get
			{
				return this._position;
			}
			set
			{
				if (this._position != value)
				{
					this._position = value;
					Campaign.Current.MobilePartyLocator.UpdateLocator(this);
				}
			}
		}

		// Token: 0x06002A97 RID: 10903 RVA: 0x000B0010 File Offset: 0x000AE210
		private void SetPositionParallel(in CampaignVec2 value, ref int gridChangeCounter, ref MobileParty[] gridChangeList)
		{
			if (this.Position != value)
			{
				this._lastNavigationFace = this.Position.Face;
				this._position = value;
				LocatorGrid<MobileParty> mobilePartyLocator = Campaign.Current.MobilePartyLocator;
				CampaignVec2 campaignVec = value;
				if (!mobilePartyLocator.CheckWhetherPositionsAreInSameNode(campaignVec.ToVec2(), this))
				{
					int num = Interlocked.Increment(ref gridChangeCounter);
					gridChangeList[num] = this;
				}
			}
		}

		// Token: 0x06002A98 RID: 10904 RVA: 0x000B007C File Offset: 0x000AE27C
		public void SetPartyUsedByQuest(bool isActivelyUsed)
		{
			if (this._isCurrentlyUsedByAQuest != isActivelyUsed)
			{
				this._isCurrentlyUsedByAQuest = isActivelyUsed;
				CampaignEventDispatcher.Instance.OnMobilePartyQuestStatusChanged(this, isActivelyUsed);
			}
		}

		// Token: 0x17000A6A RID: 2666
		// (get) Token: 0x06002A99 RID: 10905 RVA: 0x000B009A File Offset: 0x000AE29A
		// (set) Token: 0x06002A9A RID: 10906 RVA: 0x000B00BE File Offset: 0x000AE2BE
		public bool IsInspected
		{
			get
			{
				return (this.Army != null && this.Army == MobileParty.MainParty.Army) || this._isInspected;
			}
			set
			{
				this._isInspected = value;
			}
		}

		// Token: 0x06002A9B RID: 10907 RVA: 0x000B00C7 File Offset: 0x000AE2C7
		public void IgnoreForHours(float hours)
		{
			this._ignoredUntilTime = CampaignTime.HoursFromNow(hours);
		}

		// Token: 0x06002A9C RID: 10908 RVA: 0x000B00D5 File Offset: 0x000AE2D5
		public void IgnoreByOtherPartiesTill(CampaignTime time)
		{
			this._ignoredUntilTime = time;
		}

		// Token: 0x17000A6B RID: 2667
		// (get) Token: 0x06002A9D RID: 10909 RVA: 0x000B00E0 File Offset: 0x000AE2E0
		public Vec2 GetPosition2D
		{
			get
			{
				return this.Position.ToVec2();
			}
		}

		// Token: 0x17000A6C RID: 2668
		// (get) Token: 0x06002A9E RID: 10910 RVA: 0x000B00FC File Offset: 0x000AE2FC
		public int TotalWage
		{
			get
			{
				return (int)Campaign.Current.Models.PartyWageModel.GetTotalWage(this, this.MemberRoster, false).ResultNumber;
			}
		}

		// Token: 0x17000A6D RID: 2669
		// (get) Token: 0x06002A9F RID: 10911 RVA: 0x000B012E File Offset: 0x000AE32E
		public ExplainedNumber TotalWageExplained
		{
			get
			{
				return Campaign.Current.Models.PartyWageModel.GetTotalWage(this, this.MemberRoster, true);
			}
		}

		// Token: 0x17000A6E RID: 2670
		// (get) Token: 0x06002AA0 RID: 10912 RVA: 0x000B014C File Offset: 0x000AE34C
		public MapEvent MapEvent
		{
			get
			{
				return this.Party.MapEvent;
			}
		}

		// Token: 0x06002AA1 RID: 10913 RVA: 0x000B015C File Offset: 0x000AE35C
		private void OnRemoveParty()
		{
			this.Army = null;
			this.CurrentSettlement = null;
			this.AttachedTo = null;
			this.BesiegerCamp = null;
			List<Settlement> list = new List<Settlement>();
			if (this.CurrentSettlement != null)
			{
				list.Add(this.CurrentSettlement);
			}
			else if ((this.IsGarrison || this.IsMilitia || this.IsBandit || this.IsVillager || this.IsPatrolParty) && this.HomeSettlement != null)
			{
				list.Add(this.HomeSettlement);
			}
			PartyComponent partyComponent = this.PartyComponent;
			if (partyComponent != null)
			{
				partyComponent.Finish();
			}
			this.ActualClan = null;
			this.Anchor = null;
			Campaign.Current.CampaignObjectManager.RemoveMobileParty(this);
			foreach (Settlement settlement in list)
			{
				settlement.SettlementComponent.OnRelatedPartyRemoved(this);
			}
		}

		// Token: 0x06002AA2 RID: 10914 RVA: 0x000B0250 File Offset: 0x000AE450
		public void SetAnchor(AnchorPoint anchor)
		{
			this.Anchor = anchor;
			this.Anchor.InitializeOnLoad(this);
		}

		// Token: 0x06002AA3 RID: 10915 RVA: 0x000B0265 File Offset: 0x000AE465
		public void SetPartyObjective(MobileParty.PartyObjective objective)
		{
			this.Objective = objective;
		}

		// Token: 0x06002AA4 RID: 10916 RVA: 0x000B0270 File Offset: 0x000AE470
		public void UpdateVersionNo()
		{
			int versionNo = this.VersionNo;
			this.VersionNo = versionNo + 1;
		}

		// Token: 0x17000A6F RID: 2671
		// (get) Token: 0x06002AA5 RID: 10917 RVA: 0x000B028D File Offset: 0x000AE48D
		public TroopRoster MemberRoster
		{
			get
			{
				return this.Party.MemberRoster;
			}
		}

		// Token: 0x17000A70 RID: 2672
		// (get) Token: 0x06002AA6 RID: 10918 RVA: 0x000B029A File Offset: 0x000AE49A
		public TroopRoster PrisonRoster
		{
			get
			{
				return this.Party.PrisonRoster;
			}
		}

		// Token: 0x06002AA7 RID: 10919 RVA: 0x000B02A8 File Offset: 0x000AE4A8
		private bool IsLastSpeedCacheInvalid()
		{
			Hero leaderHero = this.LeaderHero;
			bool flag = !this.IsActive || leaderHero == null || leaderHero.PartyBelongedToAsPrisoner != null;
			bool isNight = Campaign.Current.IsNight;
			Vec2 vec = this._lastWind;
			if (this.IsCurrentlyAtSea)
			{
				vec = Campaign.Current.Models.MapWeatherModel.GetWindForPosition(this.Position);
			}
			return this._lastNavigationFace.FaceIndex != this.CurrentNavigationFace.FaceIndex || this._partyLastCheckIsPrisoner != flag || this._partyLastCheckAtNight != isNight || Math.Abs(this._lastWind.RotationInRadians - vec.RotationInRadians) > 0.06f || Math.Abs(this._lastWind.LengthSquared - vec.LengthSquared) > 0.0001f;
		}

		// Token: 0x06002AA8 RID: 10920 RVA: 0x000B0374 File Offset: 0x000AE574
		private bool IsBaseSpeedCacheInvalid()
		{
			this.UpdateCommonCacheVersions();
			MapWeatherModel.WeatherEventEffectOnTerrain weatherEffectOnTerrainForPosition = Campaign.Current.Models.MapWeatherModel.GetWeatherEffectOnTerrainForPosition(this.Position.ToVec2());
			return this._partyPureSpeedLastCheckVersion != this.GetVersionNoForBaseSpeedCalculation() || this._lastWeatherTerrainEffect != weatherEffectOnTerrainForPosition;
		}

		// Token: 0x06002AA9 RID: 10921 RVA: 0x000B03C6 File Offset: 0x000AE5C6
		private int GetVersionNoForWeightCalculation()
		{
			if (this.IsCurrentlyAtSea)
			{
				return (17 * 31 + this.VersionNo) * 31 + this.Party.GetShipsVersion();
			}
			return this.VersionNo;
		}

		// Token: 0x06002AAA RID: 10922 RVA: 0x000B03F2 File Offset: 0x000AE5F2
		private int GetVersionNoForBaseSpeedCalculation()
		{
			return this.GetVersionNoForWeightCalculation();
		}

		// Token: 0x06002AAB RID: 10923 RVA: 0x000B03FC File Offset: 0x000AE5FC
		private float CalculateSpeedForPartyUnified()
		{
			bool flag = false;
			if (this.IsBaseSpeedCacheInvalid())
			{
				if (this.Army != null && this.Army.LeaderParty.AttachedParties.Contains(this))
				{
					this._lastCalculatedBaseSpeedExplained = this.Army.LeaderParty._lastCalculatedBaseSpeedExplained;
				}
				else
				{
					this._lastCalculatedBaseSpeedExplained = Campaign.Current.Models.PartySpeedCalculatingModel.CalculateBaseSpeed(this, false, 0, 0);
				}
				MapWeatherModel.WeatherEventEffectOnTerrain weatherEffectOnTerrainForPosition = Campaign.Current.Models.MapWeatherModel.GetWeatherEffectOnTerrainForPosition(this.Position.ToVec2());
				this._lastWeatherTerrainEffect = weatherEffectOnTerrainForPosition;
				this._partyPureSpeedLastCheckVersion = this.GetVersionNoForBaseSpeedCalculation();
				flag = true;
			}
			if (flag)
			{
				this._lastCalculatedSpeed = Campaign.Current.Models.PartySpeedCalculatingModel.CalculateFinalSpeed(this, this._lastCalculatedBaseSpeedExplained).ResultNumber;
			}
			else if (this.IsLastSpeedCacheInvalid())
			{
				Hero leaderHero = this.LeaderHero;
				bool partyLastCheckIsPrisoner = !this.IsActive || leaderHero == null || leaderHero.PartyBelongedToAsPrisoner != null;
				bool isNight = Campaign.Current.IsNight;
				if (this.IsCurrentlyAtSea)
				{
					this._lastWind = Campaign.Current.Models.MapWeatherModel.GetWindForPosition(this.Position);
				}
				this._lastNavigationFace = this.CurrentNavigationFace;
				this._partyLastCheckIsPrisoner = partyLastCheckIsPrisoner;
				this._partyLastCheckAtNight = isNight;
				this._lastCalculatedSpeed = Campaign.Current.Models.PartySpeedCalculatingModel.CalculateFinalSpeed(this, this._lastCalculatedBaseSpeedExplained).ResultNumber;
			}
			return this._lastCalculatedSpeed;
		}

		// Token: 0x06002AAC RID: 10924 RVA: 0x000B0582 File Offset: 0x000AE782
		private bool IsWeightCacheInvalid()
		{
			this.UpdateCommonCacheVersions();
			return this._partyWeightLastCheckVersionNo != this.GetVersionNoForWeightCalculation();
		}

		// Token: 0x06002AAD RID: 10925 RVA: 0x000B059B File Offset: 0x000AE79B
		private void UpdateCommonCacheVersions()
		{
			if (this._itemRosterVersionNo != this.Party.ItemRoster.VersionNo)
			{
				this._itemRosterVersionNo = this.ItemRoster.VersionNo;
				this.UpdateVersionNo();
			}
		}

		// Token: 0x06002AAE RID: 10926 RVA: 0x000B05CC File Offset: 0x000AE7CC
		private float CalculateSpeed()
		{
			if (this.Army != null)
			{
				if (this.Army.LeaderParty.AttachedParties.Contains(this))
				{
					Vec2 armyFacing = (((this.Army.LeaderParty.MapEvent != null) ? this.Army.LeaderParty.Position.ToVec2() : this.Army.LeaderParty.NextTargetPosition.ToVec2()) - this.Army.LeaderParty.Position.ToVec2()).Normalized();
					Vec2 v = this.Army.LeaderParty.Position.ToVec2() + armyFacing.TransformToParentUnitF(this.Army.GetRelativePositionForParty(this, armyFacing));
					float num = this.Bearing.DotProduct(v - this.VisualPosition2DWithoutError);
					return this.Army.LeaderParty._lastCalculatedSpeed * MBMath.ClampFloat(1f + num * 1f, 0.7f, 1.3f);
				}
			}
			else if (this.DefaultBehavior == AiBehavior.EscortParty && this.TargetParty != null && this._lastCalculatedSpeed > this.TargetParty._lastCalculatedSpeed)
			{
				return this.TargetParty._lastCalculatedSpeed;
			}
			return this.CalculateSpeedForPartyUnified();
		}

		// Token: 0x17000A71 RID: 2673
		// (get) Token: 0x06002AAF RID: 10927 RVA: 0x000B071A File Offset: 0x000AE91A
		public ItemRoster ItemRoster
		{
			get
			{
				return this.Party.ItemRoster;
			}
		}

		// Token: 0x06002AB0 RID: 10928 RVA: 0x000B0727 File Offset: 0x000AE927
		public bool IsSpotted()
		{
			return this.IsVisible;
		}

		// Token: 0x17000A72 RID: 2674
		// (get) Token: 0x06002AB1 RID: 10929 RVA: 0x000B072F File Offset: 0x000AE92F
		public bool IsMainParty
		{
			get
			{
				return this == MobileParty.MainParty;
			}
		}

		// Token: 0x06002AB2 RID: 10930 RVA: 0x000B0739 File Offset: 0x000AE939
		public int AddElementToMemberRoster(CharacterObject element, int numberToAdd, bool insertAtFront = false)
		{
			return this.Party.AddElementToMemberRoster(element, numberToAdd, insertAtFront);
		}

		// Token: 0x06002AB3 RID: 10931 RVA: 0x000B0749 File Offset: 0x000AE949
		public int AddPrisoner(CharacterObject element, int numberToAdd)
		{
			return this.Party.AddPrisoner(element, numberToAdd);
		}

		// Token: 0x17000A73 RID: 2675
		// (get) Token: 0x06002AB4 RID: 10932 RVA: 0x000B0758 File Offset: 0x000AE958
		public IFaction MapFaction
		{
			get
			{
				IFaction result;
				if (this.ActualClan != null)
				{
					result = this.ActualClan.MapFaction;
				}
				else if (this.Party.Owner != null)
				{
					if (this.Party.Owner == Hero.MainHero)
					{
						result = this.Party.Owner.MapFaction;
					}
					else if (this.Party.Owner.IsNotable)
					{
						result = this.Party.Owner.HomeSettlement.MapFaction;
					}
					else
					{
						if (this.IsMilitia || this.IsGarrison || this.IsVillager || this.IsPatrolParty)
						{
							Settlement homeSettlement = this.HomeSettlement;
							if (((homeSettlement != null) ? homeSettlement.OwnerClan : null) != null)
							{
								return this.HomeSettlement.OwnerClan.MapFaction;
							}
						}
						if (this.IsCaravan || this.IsBanditBossParty)
						{
							result = this.Party.Owner.MapFaction;
						}
						else if (this._isCurrentlyUsedByAQuest && this.Party.Owner != null)
						{
							result = this.Party.Owner.MapFaction;
						}
						else
						{
							result = ((this.LeaderHero != null) ? this.LeaderHero.MapFaction : null);
						}
					}
				}
				else if (this.HomeSettlement != null)
				{
					result = this.HomeSettlement.OwnerClan.MapFaction;
				}
				else
				{
					result = ((this.LeaderHero != null) ? this.LeaderHero.MapFaction : null);
				}
				return result;
			}
		}

		// Token: 0x17000A74 RID: 2676
		// (get) Token: 0x06002AB5 RID: 10933 RVA: 0x000B08C4 File Offset: 0x000AEAC4
		public TextObject ArmyName
		{
			get
			{
				if (this.Army == null || this.Army.LeaderParty != this)
				{
					return this.Name;
				}
				return this.Army.Name;
			}
		}

		// Token: 0x17000A75 RID: 2677
		// (get) Token: 0x06002AB6 RID: 10934 RVA: 0x000B08EE File Offset: 0x000AEAEE
		public SiegeEvent SiegeEvent
		{
			get
			{
				BesiegerCamp besiegerCamp = this.BesiegerCamp;
				if (besiegerCamp == null)
				{
					return null;
				}
				return besiegerCamp.SiegeEvent;
			}
		}

		// Token: 0x17000A76 RID: 2678
		// (get) Token: 0x06002AB7 RID: 10935 RVA: 0x000B0901 File Offset: 0x000AEB01
		public float Food
		{
			get
			{
				return (float)this.Party.RemainingFoodPercentage * 0.01f + (float)this.TotalFoodAtInventory;
			}
		}

		// Token: 0x06002AB8 RID: 10936 RVA: 0x000B0920 File Offset: 0x000AEB20
		public Vec3 GetPositionAsVec3()
		{
			return this.Position.AsVec3();
		}

		// Token: 0x17000A77 RID: 2679
		// (get) Token: 0x06002AB9 RID: 10937 RVA: 0x000B093B File Offset: 0x000AEB3B
		public int TotalFoodAtInventory
		{
			get
			{
				return this.ItemRoster.TotalFood;
			}
		}

		// Token: 0x17000A78 RID: 2680
		// (get) Token: 0x06002ABA RID: 10938 RVA: 0x000B0948 File Offset: 0x000AEB48
		public float SeeingRange
		{
			get
			{
				return Campaign.Current.Models.MapVisibilityModel.GetPartySpottingRange(this, false).ResultNumber;
			}
		}

		// Token: 0x17000A79 RID: 2681
		// (get) Token: 0x06002ABB RID: 10939 RVA: 0x000B0973 File Offset: 0x000AEB73
		public Settlement BesiegedSettlement
		{
			get
			{
				BesiegerCamp besiegerCamp = this.BesiegerCamp;
				if (besiegerCamp == null)
				{
					return null;
				}
				return besiegerCamp.SiegeEvent.BesiegedSettlement;
			}
		}

		// Token: 0x06002ABC RID: 10940 RVA: 0x000B098C File Offset: 0x000AEB8C
		public float GetTotalLandStrengthWithFollowers(bool includeNonAttachedArmyMembers = true)
		{
			MobileParty mobileParty = (this.DefaultBehavior == AiBehavior.EscortParty) ? this.TargetParty : this;
			float num = Campaign.Current.Models.MilitaryPowerModel.GetPowerOfParty(mobileParty.Party, BattleSideEnum.Attacker, MapEvent.PowerCalculationContext.PlainBattle);
			if (mobileParty.Army != null && mobileParty == mobileParty.Army.LeaderParty)
			{
				foreach (MobileParty mobileParty2 in mobileParty.Army.Parties)
				{
					if (mobileParty2.Army.LeaderParty != mobileParty2 && (mobileParty2.AttachedTo != null || includeNonAttachedArmyMembers))
					{
						num += Campaign.Current.Models.MilitaryPowerModel.GetPowerOfParty(mobileParty2.Party, BattleSideEnum.Attacker, MapEvent.PowerCalculationContext.PlainBattle);
					}
				}
			}
			return num;
		}

		// Token: 0x06002ABD RID: 10941 RVA: 0x000B0A60 File Offset: 0x000AEC60
		private void OnPartyJoinedSiegeInternal()
		{
			this._besiegerCamp.AddSiegePartyInternal(this);
			Town town = this.SiegeEvent.BesiegedSettlement.Town;
			CampaignVec2 siegeCampPartyPosition = this._besiegerCamp.GetSiegeCampPartyPosition(this, town.BesiegerCampPositions1, town.BesiegerCampPositions2);
			if (siegeCampPartyPosition.IsValid())
			{
				this.Position = siegeCampPartyPosition;
			}
			else
			{
				this.Position = town.Settlement.GatePosition;
			}
			if (this.IsMainParty && this.SiegeEvent.IsBlockadeActive)
			{
				this.Anchor.IsDisabled = true;
			}
			CampaignEventDispatcher.Instance.OnMobilePartyJoinedToSiegeEvent(this);
		}

		// Token: 0x06002ABE RID: 10942 RVA: 0x000B0AF4 File Offset: 0x000AECF4
		private void OnPartyLeftSiegeInternal()
		{
			if (this.IsMainParty && this.SiegeEvent.IsBlockadeActive)
			{
				this.Anchor.IsDisabled = false;
			}
			this._besiegerCamp.RemoveSiegePartyInternal(this);
			this.EventPositionAdder = Vec2.Zero;
			CampaignEventDispatcher.Instance.OnMobilePartyLeftSiegeEvent(this);
		}

		// Token: 0x06002ABF RID: 10943 RVA: 0x000B0B44 File Offset: 0x000AED44
		public bool HasPerk(PerkObject perk, bool checkSecondaryRole = false)
		{
			switch (checkSecondaryRole ? perk.SecondaryRole : perk.PrimaryRole)
			{
			case PartyRole.ClanLeader:
				if (this.LeaderHero != null)
				{
					Clan clan = this.LeaderHero.Clan;
					bool? flag;
					if (clan == null)
					{
						flag = null;
					}
					else
					{
						Hero leader = clan.Leader;
						flag = ((leader != null) ? new bool?(leader.GetPerkValue(perk)) : null);
					}
					return flag ?? false;
				}
				return false;
			case PartyRole.ArmyCommander:
			{
				Army army = this.Army;
				bool? flag2;
				if (army == null)
				{
					flag2 = null;
				}
				else
				{
					MobileParty leaderParty = army.LeaderParty;
					if (leaderParty == null)
					{
						flag2 = null;
					}
					else
					{
						Hero leaderHero = leaderParty.LeaderHero;
						flag2 = ((leaderHero != null) ? new bool?(leaderHero.GetPerkValue(perk)) : null);
					}
				}
				return flag2 ?? false;
			}
			case PartyRole.PartyLeader:
			{
				Hero leaderHero2 = this.LeaderHero;
				return leaderHero2 != null && leaderHero2.GetPerkValue(perk);
			}
			case PartyRole.Surgeon:
			{
				Hero effectiveSurgeon = this.EffectiveSurgeon;
				return effectiveSurgeon != null && effectiveSurgeon.GetPerkValue(perk);
			}
			case PartyRole.Engineer:
			{
				Hero effectiveEngineer = this.EffectiveEngineer;
				return effectiveEngineer != null && effectiveEngineer.GetPerkValue(perk);
			}
			case PartyRole.Scout:
			{
				Hero effectiveScout = this.EffectiveScout;
				return effectiveScout != null && effectiveScout.GetPerkValue(perk);
			}
			case PartyRole.Quartermaster:
			{
				Hero effectiveQuartermaster = this.EffectiveQuartermaster;
				return effectiveQuartermaster != null && effectiveQuartermaster.GetPerkValue(perk);
			}
			case PartyRole.PartyMember:
			{
				foreach (TroopRosterElement troopRosterElement in this.MemberRoster.GetTroopRoster())
				{
					if (troopRosterElement.Character.IsHero && troopRosterElement.Character.HeroObject.GetPerkValue(perk))
					{
						return true;
					}
				}
				return false;
			}
			case PartyRole.Personal:
			{
				Debug.FailedAssert("personal perk is called in party", "C:\\BuildAgent\\work\\mb3\\Source\\Bannerlord\\TaleWorlds.CampaignSystem\\Party\\MobileParty.cs", "HasPerk", 3038);
				Hero leaderHero3 = this.LeaderHero;
				return leaderHero3 != null && leaderHero3.GetPerkValue(perk);
			}
			}
			return false;
		}

		// Token: 0x17000A7A RID: 2682
		// (get) Token: 0x06002AC0 RID: 10944 RVA: 0x000B0D50 File Offset: 0x000AEF50
		public bool IsEngaging
		{
			get
			{
				return this.DefaultBehavior == AiBehavior.EngageParty || this.ShortTermBehavior == AiBehavior.EngageParty;
			}
		}

		// Token: 0x06002AC1 RID: 10945 RVA: 0x000B0D68 File Offset: 0x000AEF68
		public void SetHeroPartyRole(Hero hero, PartyRole partyRole)
		{
			switch (partyRole)
			{
			case PartyRole.None:
			case PartyRole.Ruler:
			case PartyRole.ClanLeader:
			case PartyRole.Governor:
			case PartyRole.ArmyCommander:
			case PartyRole.PartyLeader:
			case PartyRole.PartyOwner:
			case PartyRole.PartyMember:
			case PartyRole.Personal:
			case PartyRole.Captain:
			case PartyRole.NumberOfPartyRoles:
				break;
			case PartyRole.Surgeon:
				this.SetPartySurgeon(hero);
				return;
			case PartyRole.Engineer:
				this.SetPartyEngineer(hero);
				return;
			case PartyRole.Scout:
				this.SetPartyScout(hero);
				return;
			case PartyRole.Quartermaster:
				this.SetPartyQuartermaster(hero);
				break;
			default:
				return;
			}
		}

		// Token: 0x06002AC2 RID: 10946 RVA: 0x000B0DD7 File Offset: 0x000AEFD7
		public PartyRole GetHeroPartyRole(Hero hero)
		{
			if (this.Engineer == hero)
			{
				return PartyRole.Engineer;
			}
			if (this.Quartermaster == hero)
			{
				return PartyRole.Quartermaster;
			}
			if (this.Surgeon == hero)
			{
				return PartyRole.Surgeon;
			}
			if (this.Scout == hero)
			{
				return PartyRole.Scout;
			}
			return PartyRole.None;
		}

		// Token: 0x06002AC3 RID: 10947 RVA: 0x000B0E08 File Offset: 0x000AF008
		public void RemoveHeroPartyRole(Hero hero)
		{
			if (this.Engineer == hero)
			{
				this.Engineer = null;
			}
			if (this.Quartermaster == hero)
			{
				this.Quartermaster = null;
			}
			if (this.Surgeon == hero)
			{
				this.Surgeon = null;
			}
			if (this.Scout == hero)
			{
				this.Scout = null;
			}
			this.ResetCached();
		}

		// Token: 0x06002AC4 RID: 10948 RVA: 0x000B0E5C File Offset: 0x000AF05C
		public Hero GetRoleHolder(PartyRole partyRole)
		{
			switch (partyRole)
			{
			case PartyRole.PartyLeader:
				return this.LeaderHero;
			case PartyRole.Surgeon:
				return this.Surgeon;
			case PartyRole.Engineer:
				return this.Engineer;
			case PartyRole.Scout:
				return this.Scout;
			case PartyRole.Quartermaster:
				return this.Quartermaster;
			}
			return null;
		}

		// Token: 0x06002AC5 RID: 10949 RVA: 0x000B0EB0 File Offset: 0x000AF0B0
		public Hero GetEffectiveRoleHolder(PartyRole partyRole)
		{
			switch (partyRole)
			{
			case PartyRole.PartyLeader:
				return this.LeaderHero;
			case PartyRole.Surgeon:
				return this.EffectiveSurgeon;
			case PartyRole.Engineer:
				return this.EffectiveEngineer;
			case PartyRole.Scout:
				return this.EffectiveScout;
			case PartyRole.Quartermaster:
				return this.EffectiveQuartermaster;
			}
			return null;
		}

		// Token: 0x17000A7B RID: 2683
		// (get) Token: 0x06002AC6 RID: 10950 RVA: 0x000B0F03 File Offset: 0x000AF103
		internal bool IsCurrentlyEngagingSettlement
		{
			get
			{
				return this.ShortTermBehavior == AiBehavior.GoToSettlement || this.ShortTermBehavior == AiBehavior.RaidSettlement || this.ShortTermBehavior == AiBehavior.AssaultSettlement || this.ShortTermBehavior == AiBehavior.FleeToGate;
			}
		}

		// Token: 0x17000A7C RID: 2684
		// (get) Token: 0x06002AC7 RID: 10951 RVA: 0x000B0F2C File Offset: 0x000AF12C
		internal bool IsCurrentlyEngagingParty
		{
			get
			{
				return this.ShortTermBehavior == AiBehavior.EngageParty;
			}
		}

		// Token: 0x06002AC8 RID: 10952 RVA: 0x000B0F38 File Offset: 0x000AF138
		public int GetNumDaysForFoodToLast()
		{
			int num = this.ItemRoster.TotalFood;
			num *= 100;
			if (this == MobileParty.MainParty)
			{
				num += this.Party.RemainingFoodPercentage;
			}
			return (int)((float)num / (100f * -this.FoodChange));
		}

		// Token: 0x06002AC9 RID: 10953 RVA: 0x000B0F7D File Offset: 0x000AF17D
		TextObject ITrackableBase.GetName()
		{
			return this.Name;
		}

		// Token: 0x06002ACA RID: 10954 RVA: 0x000B0F85 File Offset: 0x000AF185
		Vec3 ITrackableBase.GetPosition()
		{
			return this.GetPositionAsVec3();
		}

		// Token: 0x06002ACB RID: 10955 RVA: 0x000B0F8D File Offset: 0x000AF18D
		Banner ITrackableCampaignObject.GetBanner()
		{
			return this.Banner;
		}

		// Token: 0x17000A7D RID: 2685
		// (get) Token: 0x06002ACC RID: 10956 RVA: 0x000B0F98 File Offset: 0x000AF198
		public float PartySizeRatio
		{
			get
			{
				int versionNo = this.Party.MemberRoster.VersionNo;
				float cachedPartySizeRatio = this._cachedPartySizeRatio;
				if (this._partySizeRatioLastCheckVersion != versionNo || this == MobileParty.MainParty)
				{
					this._partySizeRatioLastCheckVersion = versionNo;
					this._cachedPartySizeRatio = (float)this.Party.NumberOfAllMembers / (float)this.Party.PartySizeLimit;
					cachedPartySizeRatio = this._cachedPartySizeRatio;
				}
				return cachedPartySizeRatio;
			}
		}

		// Token: 0x17000A7E RID: 2686
		// (get) Token: 0x06002ACD RID: 10957 RVA: 0x000B0FFC File Offset: 0x000AF1FC
		public Vec2 VisualPosition2DWithoutError
		{
			get
			{
				return this.Position.ToVec2() + this.EventPositionAdder + this.ArmyPositionAdder;
			}
		}

		// Token: 0x06002ACE RID: 10958 RVA: 0x000B1030 File Offset: 0x000AF230
		private Settlement DetermineRelatedBesiegedSettlementWhileDestroyingParty()
		{
			Settlement settlement = this.BesiegedSettlement;
			if (settlement == null)
			{
				settlement = ((this.ShortTermBehavior == AiBehavior.AssaultSettlement) ? this.ShortTermTargetSettlement : null);
			}
			if (settlement == null && (this.IsGarrison || this.IsMilitia) && this.CurrentSettlement != null)
			{
				MobileParty lastAttackerParty = this.CurrentSettlement.LastAttackerParty;
				MapEvent mapEvent = (lastAttackerParty != null) ? lastAttackerParty.MapEvent : null;
				if (mapEvent != null && (mapEvent.IsSiegeAssault || mapEvent.IsSiegeOutside || mapEvent.IsSallyOut) && mapEvent.DefeatedSide != BattleSideEnum.None && mapEvent.State == MapEventState.WaitingRemoval)
				{
					settlement = this.CurrentSettlement;
				}
			}
			return settlement;
		}

		// Token: 0x06002ACF RID: 10959 RVA: 0x000B10C4 File Offset: 0x000AF2C4
		internal void RemoveParty()
		{
			this.IsActive = false;
			this.IsVisible = false;
			Settlement settlement = this.DetermineRelatedBesiegedSettlementWhileDestroyingParty();
			Campaign campaign = Campaign.Current;
			this.AttachedTo = null;
			this.BesiegerCamp = null;
			this.ReleaseHeroPrisoners();
			this.ItemRoster.Clear();
			this.MemberRoster.Clear();
			this.PrisonRoster.Clear();
			for (int i = this.Ships.Count - 1; i >= 0; i--)
			{
				DestroyShipAction.Apply(this.Ships[i]);
			}
			Campaign.Current.MobilePartyLocator.RemoveLocatable(this);
			Campaign.Current.VisualTrackerManager.RemoveTrackedObject(this, true);
			CampaignEventDispatcher.Instance.OnPartyRemoved(this.Party);
			GC.SuppressFinalize(this.Party);
			foreach (MobileParty mobileParty in campaign.MobileParties)
			{
				bool flag = (mobileParty.Ai.AiBehaviorPartyBase == this.Party || (mobileParty.TargetSettlement != null && mobileParty.TargetSettlement == settlement && mobileParty.CurrentSettlement != settlement) || (mobileParty.ShortTermTargetSettlement != null && mobileParty.ShortTermTargetSettlement == settlement && mobileParty.CurrentSettlement != settlement)) && !mobileParty.IsInRaftState && mobileParty.MapEvent == null;
				if (mobileParty.TargetParty != null && mobileParty.TargetParty == this)
				{
					flag = true;
				}
				if (flag && mobileParty.TargetSettlement != null && (mobileParty.MapEvent == null || mobileParty.MapEvent.IsFinalized) && mobileParty.DefaultBehavior == AiBehavior.GoToSettlement)
				{
					Settlement targetSettlement = mobileParty.TargetSettlement;
					mobileParty.SetMoveModeHold();
					mobileParty.SetNavigationModeHold();
					mobileParty.Ai.RethinkAtNextHourlyTick = true;
					flag = false;
				}
				if (flag)
				{
					mobileParty.SetMoveModeHold();
					mobileParty.SetNavigationModeHold();
				}
			}
			this.OnRemoveParty();
			this._customHomeSettlement = null;
		}

		// Token: 0x17000A7F RID: 2687
		// (get) Token: 0x06002AD0 RID: 10960 RVA: 0x000B12BC File Offset: 0x000AF4BC
		public bool IsMoving
		{
			get
			{
				if (this.IsMainParty)
				{
					return !this.IsTransitionInProgress && !Campaign.Current.IsMainPartyWaiting;
				}
				return this.IsActive && !this.IsTransitionInProgress && this.CurrentSettlement == null && this.MapEvent == null && this.BesiegedSettlement == null && this.Position != this.MoveTargetPoint;
			}
		}

		// Token: 0x06002AD1 RID: 10961 RVA: 0x000B1324 File Offset: 0x000AF524
		private void ReleaseHeroPrisoners()
		{
			for (int i = this.PrisonRoster.Count - 1; i >= 0; i--)
			{
				if (this.PrisonRoster.GetElementNumber(i) > 0)
				{
					TroopRosterElement elementCopyAtIndex = this.PrisonRoster.GetElementCopyAtIndex(i);
					if (elementCopyAtIndex.Character.IsHero && !elementCopyAtIndex.Character.IsPlayerCharacter)
					{
						EndCaptivityAction.ApplyByReleasedByChoice(elementCopyAtIndex.Character.HeroObject, null);
					}
				}
			}
		}

		// Token: 0x17000A80 RID: 2688
		// (get) Token: 0x06002AD2 RID: 10962 RVA: 0x000B1390 File Offset: 0x000AF590
		public bool ShouldBeIgnored
		{
			get
			{
				return this._ignoredUntilTime.IsFuture || this.IsInRaftState;
			}
		}

		// Token: 0x06002AD3 RID: 10963 RVA: 0x000B13A8 File Offset: 0x000AF5A8
		private void CreateFigureAux(CampaignVec2 position)
		{
			IMapScene mapSceneWrapper = Campaign.Current.MapSceneWrapper;
			this.Position = position;
			Vec2 bearing = new Vec2(1f, 0f);
			float angleInRadians = MBRandom.RandomFloat * 2f * 3.1415927f;
			bearing.RotateCCW(angleInRadians);
			this.Bearing = bearing;
			this.Party.UpdateVisibilityAndInspected(MobileParty.MainParty.Position, 0f);
			this.StartUp();
		}

		// Token: 0x06002AD4 RID: 10964 RVA: 0x000B141B File Offset: 0x000AF61B
		private void CreateFigure(CampaignVec2 position)
		{
			this.CreateFigureAux(position);
		}

		// Token: 0x06002AD5 RID: 10965 RVA: 0x000B1424 File Offset: 0x000AF624
		internal void TeleportPartyToOutSideOfEncounterRadius()
		{
			float num = (this.Army != null && this.AttachedTo != null) ? Campaign.Current.Models.EncounterModel.MaximumAllowedDistanceForEncounteringMobilePartyInArmy : Campaign.Current.Models.EncounterModel.NeededMaximumDistanceForEncounteringMobileParty;
			float maxDistance = num * 1.25f;
			MobileParty.NavigationType navigationCapability = this.IsCurrentlyAtSea ? MobileParty.NavigationType.Naval : MobileParty.NavigationType.Default;
			if (!this.IsCurrentlyAtSea || this.HasNavalNavigationCapability)
			{
				for (int i = 0; i < 15; i++)
				{
					CampaignVec2 position = NavigationHelper.FindReachablePointAroundPosition(this.Position, navigationCapability, maxDistance, num, false);
					bool flag = true;
					LocatableSearchData<MobileParty> locatableSearchData = MobileParty.StartFindingLocatablesAroundPosition(position.ToVec2(), num);
					for (MobileParty mobileParty = MobileParty.FindNextLocatable(ref locatableSearchData); mobileParty != null; mobileParty = MobileParty.FindNextLocatable(ref locatableSearchData))
					{
						if (mobileParty.MapFaction.IsAtWarWith(this.MapFaction))
						{
							flag = false;
							break;
						}
					}
					if (flag)
					{
						this.Position = position;
						using (List<MobileParty>.Enumerator enumerator = this.AttachedParties.GetEnumerator())
						{
							while (enumerator.MoveNext())
							{
								MobileParty mobileParty2 = enumerator.Current;
								mobileParty2.Position = position;
								mobileParty2.ArmyPositionAdder = Vec2.Zero;
								mobileParty2.EventPositionAdder = Vec2.Zero;
							}
							break;
						}
					}
				}
			}
		}

		// Token: 0x06002AD6 RID: 10966 RVA: 0x000B1564 File Offset: 0x000AF764
		private void DoAiPathMode(ref MobileParty.CachedPartyVariables variables)
		{
			if (variables.IsAttachedArmyMember)
			{
				this._pathMode = false;
				return;
			}
			this.DoAIMove(ref variables);
			if (!this.IsTransitionInProgress && this._pathMode)
			{
				bool flag;
				do
				{
					flag = false;
					this.NextTargetPosition = new CampaignVec2(this.Path[this.PathBegin], !this.IsCurrentlyAtSea);
					float lengthSquared = (this.NextTargetPosition.ToVec2() - variables.CurrentPosition.ToVec2()).LengthSquared;
					float num = variables.NextMoveDistance * variables.NextMoveDistance;
					if (lengthSquared < num)
					{
						flag = true;
						variables.NextMoveDistance -= MathF.Sqrt(lengthSquared);
						variables.LastCurrentPosition = variables.CurrentPosition;
						variables.CurrentPosition = this.NextTargetPosition;
						int pathBegin = this.PathBegin;
						this.PathBegin = pathBegin + 1;
					}
				}
				while (flag && this.PathBegin < this.Path.Size);
				if (this.PathBegin >= this.Path.Size)
				{
					this._pathMode = false;
					if (this.Path.Size > 0)
					{
						variables.CurrentPosition = variables.LastCurrentPosition;
						this.NextTargetPosition = new CampaignVec2(this.Path[this.Path.Size - 1], !this.IsCurrentlyAtSea);
					}
				}
			}
		}

		// Token: 0x06002AD7 RID: 10967 RVA: 0x000B16B0 File Offset: 0x000AF8B0
		public bool RecalculateLongTermPath()
		{
			MobileParty.NavigationType navigationType = this.DesiredAiNavigationType;
			if (navigationType == MobileParty.NavigationType.None)
			{
				navigationType = (this.IsCurrentlyAtSea ? MobileParty.NavigationType.Naval : MobileParty.NavigationType.Default);
			}
			if ((navigationType == MobileParty.NavigationType.Naval && !this.IsCurrentlyAtSea) || (navigationType == MobileParty.NavigationType.Default && this.IsCurrentlyAtSea))
			{
				navigationType = MobileParty.NavigationType.All;
			}
			CampaignVec2 campaignVec;
			if (this.TargetSettlement != null)
			{
				campaignVec = (this.IsTargetingPort ? this.TargetSettlement.PortPosition : this.TargetSettlement.GatePosition);
			}
			else if (this.TargetParty != null)
			{
				campaignVec = this.TargetParty.Position;
			}
			else
			{
				campaignVec = this.TargetPosition;
			}
			return (!campaignVec.IsOnLand || this.DesiredAiNavigationType != MobileParty.NavigationType.Naval) && (campaignVec.IsOnLand || this.DesiredAiNavigationType != MobileParty.NavigationType.Default) && this.ComputePath(campaignVec, navigationType, true);
		}

		// Token: 0x06002AD8 RID: 10968 RVA: 0x000B176C File Offset: 0x000AF96C
		private bool ComputePath(CampaignVec2 newTargetPosition, MobileParty.NavigationType navigationType, bool cacheNextLongTermPathPoint)
		{
			bool flag = false;
			if (this.Position.IsValid())
			{
				if (newTargetPosition.IsValid())
				{
					TerrainType faceTerrainType = Campaign.Current.MapSceneWrapper.GetFaceTerrainType(newTargetPosition.Face);
					if (!Campaign.Current.Models.PartyNavigationModel.IsTerrainTypeValidForNavigationType(faceTerrainType, this.NavigationCapability) && !this.IsInRaftState)
					{
						return false;
					}
					CampaignVec2 position = this.Position;
					if (this.IsMainParty && MobileParty.MainParty.IsCurrentlyAtSea && NavigationHelper.IsPositionValidForNavigationType(newTargetPosition, MobileParty.NavigationType.Naval))
					{
						navigationType = MobileParty.NavigationType.Naval;
					}
					float agentRadius = this.IsCurrentlyAtSea ? Campaign.Current.Models.PartyNavigationModel.GetEmbarkDisembarkThresholdDistance() : 0.3f;
					int[] invalidTerrainTypesForNavigationType = Campaign.Current.Models.PartyNavigationModel.GetInvalidTerrainTypesForNavigationType(navigationType);
					flag = Campaign.Current.MapSceneWrapper.GetPathBetweenAIFaces(this.CurrentNavigationFace, newTargetPosition.Face, position.ToVec2(), newTargetPosition.ToVec2(), agentRadius, this.Path, invalidTerrainTypesForNavigationType, 2f, this.GetRegionSwitchCostFromSeaToLand(), this.GetRegionSwitchCostFromLandToSea());
					if (cacheNextLongTermPathPoint)
					{
						CampaignVec2 nextLongTermPathPoint = new CampaignVec2(this.Path.PathPoints[0], !this.IsCurrentlyAtSea);
						if (!nextLongTermPathPoint.IsValid())
						{
							nextLongTermPathPoint = new CampaignVec2(this.Path.PathPoints[0], this.IsCurrentlyAtSea);
						}
						this.NextLongTermPathPoint = nextLongTermPathPoint;
					}
				}
				else
				{
					Debug.FailedAssert("Path finding target is not valid", "C:\\BuildAgent\\work\\mb3\\Source\\Bannerlord\\TaleWorlds.CampaignSystem\\Party\\MobileParty.cs", "ComputePath", 3604);
				}
			}
			this.PathBegin = 0;
			if (!flag)
			{
				this._pathMode = false;
			}
			return flag;
		}

		// Token: 0x06002AD9 RID: 10969 RVA: 0x000B1901 File Offset: 0x000AFB01
		public int GetRegionSwitchCostFromLandToSea()
		{
			if (this.IsMainParty)
			{
				return Campaign.PlayerRegionSwitchCostFromLandToSea;
			}
			return Campaign.Current.Models.MapDistanceModel.RegionSwitchCostFromLandToSea;
		}

		// Token: 0x06002ADA RID: 10970 RVA: 0x000B1925 File Offset: 0x000AFB25
		public int GetRegionSwitchCostFromSeaToLand()
		{
			return Campaign.Current.Models.MapDistanceModel.RegionSwitchCostFromSeaToLand;
		}

		// Token: 0x06002ADB RID: 10971 RVA: 0x000B193C File Offset: 0x000AFB3C
		private void DoAIMove(ref MobileParty.CachedPartyVariables variables)
		{
			CampaignVec2 campaignVec;
			bool forceNoPathMode;
			this.GetTargetCampaignPosition(ref variables, out campaignVec, out forceNoPathMode);
			PathFaceRecord face = campaignVec.Face;
			if (this._pathMode && (face.FaceIndex != this.PathLastFace.FaceIndex || campaignVec.Distance(this._pathLastPosition) > 1E-05f))
			{
				this._pathMode = false;
				this.PathLastFace = PathFaceRecord.NullFaceRecord;
			}
			if (!this._pathMode && (face.FaceIndex != this.PathLastFace.FaceIndex || campaignVec.Distance(this._pathLastPosition) > 1E-05f) && this._aiPathNotFound)
			{
				this._aiPathNotFound = false;
			}
			MobileParty.NavigationType navigationType;
			if (this.IsComputePathCacheDirty(campaignVec, forceNoPathMode, out navigationType))
			{
				if (this.CurrentNavigationFace.FaceIndex != this.MoveTargetPoint.Face.FaceIndex)
				{
					this._aiPathNotFound = !this.ComputePath(campaignVec, navigationType, !this.IsFleeing());
					if (!this._aiPathNotFound)
					{
						this.PathLastFace = face;
						this._pathLastPosition = campaignVec;
						this._lastComputedPathNavigationType = navigationType;
						this._pathMode = true;
					}
				}
				else
				{
					this._pathMode = false;
					this.PathLastFace = PathFaceRecord.NullFaceRecord;
				}
			}
			else if (face.FaceIndex == this.PathLastFace.FaceIndex && this.CurrentNavigationFace.FaceIndex != face.FaceIndex)
			{
				this._pathMode = true;
			}
			if (!this._pathMode)
			{
				this.NextTargetPosition = campaignVec;
			}
		}

		// Token: 0x06002ADC RID: 10972 RVA: 0x000B1A94 File Offset: 0x000AFC94
		private bool IsComputePathCacheDirty(CampaignVec2 finalTargetPosition, bool forceNoPathMode, out MobileParty.NavigationType navigationType)
		{
			navigationType = this.DesiredAiNavigationType;
			TerrainType faceTerrainType = Campaign.Current.MapSceneWrapper.GetFaceTerrainType(finalTargetPosition.Face);
			if (!this.StartTransitionNextFrameToExitFromPort && (this.DesiredAiNavigationType == MobileParty.NavigationType.Naval != this.IsCurrentlyAtSea || !Campaign.Current.Models.PartyNavigationModel.IsTerrainTypeValidForNavigationType(faceTerrainType, this.DesiredAiNavigationType)))
			{
				navigationType = MobileParty.NavigationType.All;
			}
			return this._lastComputedPathNavigationType != navigationType || (!this._pathMode && !forceNoPathMode && !this._aiPathNotFound) || (finalTargetPosition.Face.FaceIndex != this.PathLastFace.FaceIndex && finalTargetPosition.IsValid());
		}

		// Token: 0x06002ADD RID: 10973 RVA: 0x000B1B3C File Offset: 0x000AFD3C
		private void GetTargetCampaignPosition(ref MobileParty.CachedPartyVariables variables, out CampaignVec2 finalTargetPosition, out bool forceNoPathMode)
		{
			finalTargetPosition = this.Position;
			forceNoPathMode = false;
			if (this.PartyMoveMode == MoveModeType.Point)
			{
				finalTargetPosition = this.MoveTargetPoint;
				forceNoPathMode = this.ForceAiNoPathMode;
				return;
			}
			if (this.PartyMoveMode == MoveModeType.Party && this.MoveTargetParty.Party.IsValid)
			{
				finalTargetPosition = variables.TargetPartyPositionAtFrameStart;
				bool flag = !NavigationHelper.IsPositionValidForNavigationType(variables.TargetPartyPositionAtFrameStart, this.NavigationCapability);
				if (flag && !variables.IsTargetMovingAtFrameStart)
				{
					variables.IsTargetMovingAtFrameStart = true;
				}
				if (variables.IsTargetMovingAtFrameStart && flag)
				{
					finalTargetPosition = this.Position;
					forceNoPathMode = false;
					if (!this.Ai.IsDisabled && !this.IsMainParty)
					{
						this.Ai.DefaultBehaviorNeedsUpdate = true;
					}
				}
			}
		}

		// Token: 0x06002ADE RID: 10974 RVA: 0x000B1C00 File Offset: 0x000AFE00
		private void DoUpdatePosition(ref MobileParty.CachedPartyVariables variables, float dt, float realDt)
		{
			Vec2 vec;
			if (variables.IsAttachedArmyMember)
			{
				if (variables.HasMapEvent || this.CurrentSettlement != null)
				{
					vec = Vec2.Zero;
				}
				else
				{
					Vec2 v = variables.HasMapEvent ? this.Army.LeaderParty.Position.ToVec2() : this.Army.LeaderParty.NextTargetPosition.ToVec2();
					CampaignVec2 campaignVec;
					bool flag;
					this.Army.LeaderParty.GetTargetCampaignPosition(ref variables, out campaignVec, out flag);
					Vec2 armyFacing = ((v - this.Army.LeaderParty.Position.ToVec2()).LengthSquared < 0.0025000002f) ? this.Army.LeaderParty.Bearing.Normalized() : (v - this.Army.LeaderParty.Position.ToVec2()).Normalized();
					Vec2 v2 = armyFacing.TransformToParentUnitF(this.Army.GetRelativePositionForParty(this, armyFacing));
					vec = v + v2 - this.VisualPosition2DWithoutError;
					if ((campaignVec.ToVec2() + v2 - this.VisualPosition2DWithoutError).LengthSquared < 1.0000001E-06f || vec.LengthSquared < 1.0000001E-06f)
					{
						vec = Vec2.Zero;
					}
					float num = vec.LeftVec().Normalized().DotProduct(this.Army.LeaderParty.Position.ToVec2() + v2 - this.VisualPosition2DWithoutError);
					vec.RotateCCW((num < 0f) ? MathF.Max(num * 2f, -0.7853982f) : MathF.Min(num * 2f, 0.7853982f));
				}
			}
			else
			{
				vec = (variables.HasMapEvent ? this.Party.MapEvent.Position.ToVec2() : this.NextTargetPosition.ToVec2()) - this.VisualPosition2DWithoutError;
			}
			float num2 = vec.Normalize();
			if (num2 < variables.NextMoveDistance)
			{
				variables.NextMoveDistance = num2;
			}
			if (this.BesiegedSettlement == null && this.CurrentSettlement == null && (variables.NextMoveDistance > 0f || variables.HasMapEvent))
			{
				Vec2 vec2 = this.Bearing;
				if (num2 > 0f)
				{
					vec2 = vec;
					if (!variables.IsAttachedArmyMember || !variables.HasMapEvent)
					{
						this.Bearing = vec2;
					}
				}
				else if (variables.IsAttachedArmyMember && variables.HasMapEvent)
				{
					vec2 = this.Army.LeaderParty.Bearing;
					this.Bearing = vec2;
				}
				variables.NextPosition = variables.CurrentPosition + vec2 * variables.NextMoveDistance;
			}
		}

		// Token: 0x06002ADF RID: 10975 RVA: 0x000B1ECD File Offset: 0x000B00CD
		private void ResetAllMovementParameters()
		{
			this.TargetParty = null;
			this.SetTargetSettlement(null, false);
			this.DefaultBehavior = AiBehavior.None;
			this.SetShortTermBehavior(AiBehavior.None, null);
			this.TargetPosition = this.Position;
			this.MoveTargetPoint = this.Position;
		}

		// Token: 0x06002AE0 RID: 10976 RVA: 0x000B1F08 File Offset: 0x000B0108
		public void SetMoveModeHold()
		{
			this.ResetAllMovementParameters();
			this.DefaultBehavior = AiBehavior.Hold;
			this.SetShortTermBehavior(AiBehavior.Hold, null);
			this.SetTargetSettlement(null, false);
			this.TargetParty = null;
			this.TargetPosition = this.Position;
			this.MoveTargetPoint = this.Position;
			this.DesiredAiNavigationType = MobileParty.NavigationType.None;
		}

		// Token: 0x06002AE1 RID: 10977 RVA: 0x000B1F58 File Offset: 0x000B0158
		public void SetMoveEngageParty(MobileParty party, MobileParty.NavigationType navigationType)
		{
			this.ResetAllMovementParameters();
			this.TargetParty = party;
			this.MoveTargetPoint = party.Position;
			this.DesiredAiNavigationType = navigationType;
			this.DefaultBehavior = AiBehavior.EngageParty;
		}

		// Token: 0x06002AE2 RID: 10978 RVA: 0x000B1F81 File Offset: 0x000B0181
		public void SetMoveGoAroundParty(MobileParty party, MobileParty.NavigationType navigationType)
		{
			this.ResetAllMovementParameters();
			this.TargetParty = party;
			this.MoveTargetPoint = party.Position;
			this.DesiredAiNavigationType = navigationType;
			this.DefaultBehavior = AiBehavior.GoAroundParty;
		}

		// Token: 0x06002AE3 RID: 10979 RVA: 0x000B1FAC File Offset: 0x000B01AC
		public void SetMoveGoToSettlement(Settlement settlement, MobileParty.NavigationType navigationType, bool isTargetingThePort)
		{
			this.ResetAllMovementParameters();
			this.SetTargetSettlement(settlement, isTargetingThePort);
			CampaignVec2 campaignVec = isTargetingThePort ? settlement.PortPosition : settlement.GatePosition;
			this.TargetPosition = campaignVec;
			this.MoveTargetPoint = campaignVec;
			this.DesiredAiNavigationType = navigationType;
			this.DefaultBehavior = AiBehavior.GoToSettlement;
		}

		// Token: 0x06002AE4 RID: 10980 RVA: 0x000B1FF5 File Offset: 0x000B01F5
		public void SetMoveGoToPoint(CampaignVec2 point, MobileParty.NavigationType navigationType)
		{
			this.ResetAllMovementParameters();
			this.TargetPosition = point;
			this.MoveTargetPoint = point;
			this.DesiredAiNavigationType = navigationType;
			this.Ai.AiBehaviorInteractable = null;
			this.DefaultBehavior = AiBehavior.GoToPoint;
		}

		// Token: 0x06002AE5 RID: 10981 RVA: 0x000B2026 File Offset: 0x000B0226
		public void SetMoveToNearestLand(Settlement settlement)
		{
			this.ResetAllMovementParameters();
			if (settlement != null)
			{
				this.SetTargetSettlement(settlement, true);
			}
			this.DesiredAiNavigationType = (this.HasLandNavigationCapability ? MobileParty.NavigationType.All : MobileParty.NavigationType.Naval);
			this.DefaultBehavior = AiBehavior.MoveToNearestLandOrPort;
		}

		// Token: 0x06002AE6 RID: 10982 RVA: 0x000B2053 File Offset: 0x000B0253
		public void SetMoveGoToInteractablePoint(IInteractablePoint point, MobileParty.NavigationType navigationType)
		{
			this.ResetAllMovementParameters();
			this.TargetPosition = point.GetInteractionPosition(this);
			this.MoveTargetPoint = this.TargetPosition;
			this.Ai.AiBehaviorInteractable = point;
			this.DesiredAiNavigationType = navigationType;
			this.DefaultBehavior = AiBehavior.GoToPoint;
		}

		// Token: 0x06002AE7 RID: 10983 RVA: 0x000B208F File Offset: 0x000B028F
		public void SetMoveEscortParty(MobileParty mobileParty, MobileParty.NavigationType navigationType, bool isTargetingPort)
		{
			this.ResetAllMovementParameters();
			this.TargetParty = mobileParty;
			this.MoveTargetPoint = mobileParty.Position;
			if (isTargetingPort)
			{
				this.SetTargetSettlement(mobileParty.CurrentSettlement, true);
			}
			this.DesiredAiNavigationType = navigationType;
			this.DefaultBehavior = AiBehavior.EscortParty;
		}

		// Token: 0x06002AE8 RID: 10984 RVA: 0x000B20C9 File Offset: 0x000B02C9
		public void SetMovePatrolAroundPoint(CampaignVec2 point, MobileParty.NavigationType navigationType)
		{
			this.ResetAllMovementParameters();
			this.TargetPosition = point;
			this.MoveTargetPoint = point;
			this.DesiredAiNavigationType = navigationType;
			this.DefaultBehavior = AiBehavior.PatrolAroundPoint;
		}

		// Token: 0x06002AE9 RID: 10985 RVA: 0x000B20EE File Offset: 0x000B02EE
		public void SetMovePatrolAroundSettlement(Settlement settlement, MobileParty.NavigationType navigationType, bool isTargetingPort)
		{
			this.SetMovePatrolAroundPoint(isTargetingPort ? settlement.PortPosition : settlement.GatePosition, navigationType);
			this.SetTargetSettlement(settlement, isTargetingPort);
		}

		// Token: 0x06002AEA RID: 10986 RVA: 0x000B2110 File Offset: 0x000B0310
		public void SetMoveRaidSettlement(Settlement settlement, MobileParty.NavigationType navigationType)
		{
			this.ResetAllMovementParameters();
			this.SetTargetSettlement(settlement, false);
			CampaignVec2 gatePosition = settlement.GatePosition;
			this.TargetPosition = gatePosition;
			this.MoveTargetPoint = gatePosition;
			this.DesiredAiNavigationType = navigationType;
			this.DefaultBehavior = AiBehavior.RaidSettlement;
		}

		// Token: 0x06002AEB RID: 10987 RVA: 0x000B214E File Offset: 0x000B034E
		public void SetMoveBesiegeSettlement(Settlement settlement, MobileParty.NavigationType navigationType)
		{
			this.ResetAllMovementParameters();
			if (this.BesiegedSettlement != null && this.BesiegedSettlement != settlement)
			{
				this.BesiegerCamp = null;
			}
			this.SetTargetSettlement(settlement, false);
			this.DesiredAiNavigationType = navigationType;
			this.DefaultBehavior = AiBehavior.BesiegeSettlement;
		}

		// Token: 0x06002AEC RID: 10988 RVA: 0x000B2184 File Offset: 0x000B0384
		public void SetMoveDefendSettlement(Settlement settlement, bool isTargetingPort, MobileParty.NavigationType navigationType)
		{
			this.ResetAllMovementParameters();
			this.SetTargetSettlement(settlement, isTargetingPort);
			this.DesiredAiNavigationType = navigationType;
			this.DefaultBehavior = AiBehavior.DefendSettlement;
		}

		// Token: 0x06002AED RID: 10989 RVA: 0x000B21A3 File Offset: 0x000B03A3
		internal void SetNavigationModeHold()
		{
			this.PartyMoveMode = MoveModeType.Hold;
			this._pathMode = false;
			this.NextTargetPosition = this.Position;
			this.MoveTargetParty = null;
		}

		// Token: 0x06002AEE RID: 10990 RVA: 0x000B21C6 File Offset: 0x000B03C6
		internal void SetNavigationModePoint(CampaignVec2 newTargetPosition)
		{
			this.PartyMoveMode = MoveModeType.Point;
			this.UpdatePathModeWithPosition(newTargetPosition);
			this._aiPathNotFound = false;
			this.MoveTargetParty = null;
		}

		// Token: 0x06002AEF RID: 10991 RVA: 0x000B21E4 File Offset: 0x000B03E4
		internal void SetNavigationModeParty(MobileParty targetParty)
		{
			this.PartyMoveMode = MoveModeType.Party;
			this.MoveTargetParty = targetParty;
			this.MoveTargetPoint = targetParty.Position;
			this._aiPathNotFound = false;
		}

		// Token: 0x06002AF0 RID: 10992 RVA: 0x000B2207 File Offset: 0x000B0407
		public static LocatableSearchData<MobileParty> StartFindingLocatablesAroundPosition(Vec2 position, float radius)
		{
			return Campaign.Current.MobilePartyLocator.StartFindingLocatablesAroundPosition(position, radius);
		}

		// Token: 0x06002AF1 RID: 10993 RVA: 0x000B221A File Offset: 0x000B041A
		public static MobileParty FindNextLocatable(ref LocatableSearchData<MobileParty> data)
		{
			return Campaign.Current.MobilePartyLocator.FindNextLocatable(ref data);
		}

		// Token: 0x06002AF2 RID: 10994 RVA: 0x000B222C File Offset: 0x000B042C
		public static void UpdateLocator(MobileParty party)
		{
			Campaign.Current.MobilePartyLocator.UpdateLocator(party);
		}

		// Token: 0x06002AF3 RID: 10995 RVA: 0x000B223F File Offset: 0x000B043F
		internal void OnHeroAdded(Hero hero)
		{
			hero.OnAddedToParty(this);
		}

		// Token: 0x06002AF4 RID: 10996 RVA: 0x000B2248 File Offset: 0x000B0448
		internal void OnHeroRemoved(Hero hero)
		{
			hero.OnRemovedFromParty(this);
		}

		// Token: 0x06002AF5 RID: 10997 RVA: 0x000B2254 File Offset: 0x000B0454
		internal void CheckExitingSettlementParallel(ref int exitingPartyCount, ref MobileParty[] exitingPartyList, ref int gridChangeCount, ref MobileParty[] gridChangeMobilePartyList)
		{
			if (!this.Ai.IsDisabled && this.ShortTermBehavior != AiBehavior.Hold && this.CurrentSettlement != null && ((this.ShortTermTargetSettlement == null && this.TargetSettlement != this.CurrentSettlement) || this.ShortTermTargetSettlement != this.CurrentSettlement) && !this.IsMainParty && (this.Army == null || this.AttachedTo == null || this.Army.LeaderParty == this))
			{
				if (this.StartTransitionNextFrameToExitFromPort)
				{
					this.StartTransitionNextFrameToExitFromPort = false;
					if (!this.IsCurrentlyAtSea)
					{
						this.InitializeNavigationTransitionParallel(this.CurrentSettlement.PortPosition, this.CurrentSettlement.PortPosition, ref gridChangeCount, ref gridChangeMobilePartyList);
						return;
					}
				}
				else if (!this.IsTransitionInProgress)
				{
					int num = Interlocked.Increment(ref exitingPartyCount);
					exitingPartyList[num] = this;
				}
			}
		}

		// Token: 0x06002AF6 RID: 10998 RVA: 0x000B231C File Offset: 0x000B051C
		public bool ComputeIsWaiting()
		{
			MobileParty moveTargetParty = this.MoveTargetParty;
			CampaignVec2 campaignVec = (moveTargetParty != null) ? moveTargetParty.Position : this.MoveTargetPoint;
			return ((2f * this.Position).ToVec2() - campaignVec.ToVec2() - this.NextTargetPosition.ToVec2()).LengthSquared < 1E-05f || this.DefaultBehavior == AiBehavior.Hold || ((this.DefaultBehavior == AiBehavior.EngageParty || this.DefaultBehavior == AiBehavior.EscortParty) && this.Ai.AiBehaviorPartyBase != null && this.Ai.AiBehaviorPartyBase.IsValid && this.Ai.AiBehaviorPartyBase.IsActive && this.Ai.AiBehaviorPartyBase.IsMobile && this.Ai.AiBehaviorPartyBase.MobileParty.CurrentSettlement != null);
		}

		// Token: 0x06002AF7 RID: 10999 RVA: 0x000B23FE File Offset: 0x000B05FE
		public void InitializePartyTrade(int initialGold)
		{
			this.IsPartyTradeActive = true;
			this.PartyTradeGold = initialGold;
		}

		// Token: 0x06002AF8 RID: 11000 RVA: 0x000B240E File Offset: 0x000B060E
		public void AddTaxGold(int amount)
		{
			this.PartyTradeTaxGold += amount;
		}

		// Token: 0x06002AF9 RID: 11001 RVA: 0x000B2420 File Offset: 0x000B0620
		public static MobileParty CreateParty(string stringId, PartyComponent component)
		{
			stringId = Campaign.Current.CampaignObjectManager.FindNextUniqueStringId<MobileParty>(stringId);
			MobileParty mobileParty = new MobileParty();
			mobileParty.StringId = stringId;
			mobileParty._partyComponent = component;
			mobileParty.UpdatePartyComponentFlags();
			PartyComponent partyComponent = mobileParty._partyComponent;
			if (partyComponent != null)
			{
				partyComponent.Create(mobileParty);
			}
			PartyComponent partyComponent2 = mobileParty._partyComponent;
			if (partyComponent2 != null)
			{
				partyComponent2.Initialize(mobileParty);
			}
			Campaign.Current.CampaignObjectManager.AddMobileParty(mobileParty);
			CampaignEventDispatcher.Instance.OnMobilePartyCreated(mobileParty);
			CampaignEventDispatcher.Instance.OnMapInteractableCreated(mobileParty.Party);
			return mobileParty;
		}

		// Token: 0x17000A81 RID: 2689
		// (get) Token: 0x06002AFA RID: 11002 RVA: 0x000B24A9 File Offset: 0x000B06A9
		public VillagerPartyComponent VillagerPartyComponent
		{
			get
			{
				return this._partyComponent as VillagerPartyComponent;
			}
		}

		// Token: 0x17000A82 RID: 2690
		// (get) Token: 0x06002AFB RID: 11003 RVA: 0x000B24B6 File Offset: 0x000B06B6
		public CaravanPartyComponent CaravanPartyComponent
		{
			get
			{
				return this._partyComponent as CaravanPartyComponent;
			}
		}

		// Token: 0x17000A83 RID: 2691
		// (get) Token: 0x06002AFC RID: 11004 RVA: 0x000B24C3 File Offset: 0x000B06C3
		public WarPartyComponent WarPartyComponent
		{
			get
			{
				return this._partyComponent as WarPartyComponent;
			}
		}

		// Token: 0x17000A84 RID: 2692
		// (get) Token: 0x06002AFD RID: 11005 RVA: 0x000B24D0 File Offset: 0x000B06D0
		public BanditPartyComponent BanditPartyComponent
		{
			get
			{
				return this._partyComponent as BanditPartyComponent;
			}
		}

		// Token: 0x17000A85 RID: 2693
		// (get) Token: 0x06002AFE RID: 11006 RVA: 0x000B24DD File Offset: 0x000B06DD
		public PatrolPartyComponent PatrolPartyComponent
		{
			get
			{
				return this._partyComponent as PatrolPartyComponent;
			}
		}

		// Token: 0x17000A86 RID: 2694
		// (get) Token: 0x06002AFF RID: 11007 RVA: 0x000B24EA File Offset: 0x000B06EA
		public LordPartyComponent LordPartyComponent
		{
			get
			{
				return this._partyComponent as LordPartyComponent;
			}
		}

		// Token: 0x17000A87 RID: 2695
		// (get) Token: 0x06002B00 RID: 11008 RVA: 0x000B24F7 File Offset: 0x000B06F7
		public GarrisonPartyComponent GarrisonPartyComponent
		{
			get
			{
				return this._partyComponent as GarrisonPartyComponent;
			}
		}

		// Token: 0x17000A88 RID: 2696
		// (get) Token: 0x06002B01 RID: 11009 RVA: 0x000B2504 File Offset: 0x000B0704
		public PartyComponent PartyComponent
		{
			get
			{
				return this._partyComponent;
			}
		}

		// Token: 0x06002B02 RID: 11010 RVA: 0x000B250C File Offset: 0x000B070C
		public void SetPartyComponent(PartyComponent partyComponent, bool firstTimePartyComponentCreation = true)
		{
			if (this._partyComponent != partyComponent)
			{
				if (this._partyComponent != null)
				{
					this._partyComponent.Finish();
				}
				Campaign.Current.CampaignObjectManager.BeforePartyComponentChanged(this);
				this._partyComponent = partyComponent;
				this.UpdatePartyComponentFlags();
				Campaign.Current.CampaignObjectManager.AfterPartyComponentChanged(this);
				if (this._partyComponent != null)
				{
					if (firstTimePartyComponentCreation)
					{
						this._partyComponent.Create(this);
					}
					this._partyComponent.Initialize(this);
				}
				this.Party.SetVisualAsDirty();
			}
		}

		// Token: 0x17000A89 RID: 2697
		// (get) Token: 0x06002B03 RID: 11011 RVA: 0x000B2590 File Offset: 0x000B0790
		// (set) Token: 0x06002B04 RID: 11012 RVA: 0x000B2598 File Offset: 0x000B0798
		[CachedData]
		public bool IsMilitia { get; private set; }

		// Token: 0x17000A8A RID: 2698
		// (get) Token: 0x06002B05 RID: 11013 RVA: 0x000B25A1 File Offset: 0x000B07A1
		// (set) Token: 0x06002B06 RID: 11014 RVA: 0x000B25A9 File Offset: 0x000B07A9
		[CachedData]
		public bool IsLordParty { get; private set; }

		// Token: 0x06002B07 RID: 11015 RVA: 0x000B25B4 File Offset: 0x000B07B4
		public void UpdatePartyComponentFlags()
		{
			this.IsLordParty = (this._partyComponent is LordPartyComponent);
			this.IsVillager = (this._partyComponent is VillagerPartyComponent);
			this.IsMilitia = (this._partyComponent is MilitiaPartyComponent);
			this.IsCaravan = (this._partyComponent is CaravanPartyComponent);
			this.IsPatrolParty = (this._partyComponent is PatrolPartyComponent);
			this.IsGarrison = (this._partyComponent is GarrisonPartyComponent);
			this.IsCustomParty = (this._partyComponent is CustomPartyComponent);
			this.IsBandit = (this._partyComponent is BanditPartyComponent);
		}

		// Token: 0x17000A8B RID: 2699
		// (get) Token: 0x06002B08 RID: 11016 RVA: 0x000B2661 File Offset: 0x000B0861
		// (set) Token: 0x06002B09 RID: 11017 RVA: 0x000B2669 File Offset: 0x000B0869
		[CachedData]
		public bool IsVillager { get; private set; }

		// Token: 0x17000A8C RID: 2700
		// (get) Token: 0x06002B0A RID: 11018 RVA: 0x000B2672 File Offset: 0x000B0872
		// (set) Token: 0x06002B0B RID: 11019 RVA: 0x000B267A File Offset: 0x000B087A
		[CachedData]
		public bool IsCaravan { get; private set; }

		// Token: 0x17000A8D RID: 2701
		// (get) Token: 0x06002B0C RID: 11020 RVA: 0x000B2683 File Offset: 0x000B0883
		// (set) Token: 0x06002B0D RID: 11021 RVA: 0x000B268B File Offset: 0x000B088B
		[CachedData]
		public bool IsPatrolParty { get; private set; }

		// Token: 0x17000A8E RID: 2702
		// (get) Token: 0x06002B0E RID: 11022 RVA: 0x000B2694 File Offset: 0x000B0894
		// (set) Token: 0x06002B0F RID: 11023 RVA: 0x000B269C File Offset: 0x000B089C
		[CachedData]
		public bool IsGarrison { get; private set; }

		// Token: 0x17000A8F RID: 2703
		// (get) Token: 0x06002B10 RID: 11024 RVA: 0x000B26A5 File Offset: 0x000B08A5
		// (set) Token: 0x06002B11 RID: 11025 RVA: 0x000B26AD File Offset: 0x000B08AD
		[CachedData]
		public bool IsCustomParty { get; private set; }

		// Token: 0x17000A90 RID: 2704
		// (get) Token: 0x06002B12 RID: 11026 RVA: 0x000B26B6 File Offset: 0x000B08B6
		// (set) Token: 0x06002B13 RID: 11027 RVA: 0x000B26BE File Offset: 0x000B08BE
		[CachedData]
		public bool IsBandit { get; private set; }

		// Token: 0x17000A91 RID: 2705
		// (get) Token: 0x06002B14 RID: 11028 RVA: 0x000B26C7 File Offset: 0x000B08C7
		public bool IsBanditBossParty
		{
			get
			{
				return this.IsBandit && this.BanditPartyComponent.IsBossParty;
			}
		}

		// Token: 0x17000A92 RID: 2706
		// (get) Token: 0x06002B15 RID: 11029 RVA: 0x000B26DE File Offset: 0x000B08DE
		public bool AvoidHostileActions
		{
			get
			{
				return this._partyComponent != null && this._partyComponent.AvoidHostileActions;
			}
		}

		// Token: 0x06002B16 RID: 11030 RVA: 0x000B26F5 File Offset: 0x000B08F5
		bool ITrackableCampaignObject.get_IsReady()
		{
			return base.IsReady;
		}

		// Token: 0x04000BFC RID: 3068
		public const int DefaultPartyTradeInitialGold = 5000;

		// Token: 0x04000BFD RID: 3069
		public const int ClanRoleAssignmentMinimumSkillValue = 0;

		// Token: 0x04000BFE RID: 3070
		public const int MinimumSpareGoldForWageBudget = 5;

		// Token: 0x04000BFF RID: 3071
		private const int ArrayLength = 6;

		// Token: 0x04000C00 RID: 3072
		[SaveableField(1001)]
		private Settlement _currentSettlement;

		// Token: 0x04000C03 RID: 3075
		[CachedData]
		private MBList<MobileParty> _attachedParties;

		// Token: 0x04000C04 RID: 3076
		[SaveableField(1046)]
		private MobileParty _attachedTo;

		// Token: 0x04000C07 RID: 3079
		[SaveableField(1006)]
		public float HasUnpaidWages;

		// Token: 0x04000C09 RID: 3081
		[SaveableField(1060)]
		private Vec2 _eventPositionAdder;

		// Token: 0x04000C0F RID: 3087
		[SaveableField(1026)]
		private bool _isInRaftState;

		// Token: 0x04000C10 RID: 3088
		[SaveableField(1040)]
		public bool IsInfoHidden;

		// Token: 0x04000C11 RID: 3089
		[SaveableField(1024)]
		private bool _isVisible;

		// Token: 0x04000C12 RID: 3090
		[CachedData]
		internal float _lastCalculatedSpeed = 1f;

		// Token: 0x04000C13 RID: 3091
		[CachedData]
		public CampaignVec2 NextLongTermPathPoint = CampaignVec2.Invalid;

		// Token: 0x04000C14 RID: 3092
		[SaveableField(1025)]
		private bool _isInspected;

		// Token: 0x04000C15 RID: 3093
		[SaveableField(1955)]
		private CampaignTime _disorganizedUntilTime;

		// Token: 0x04000C16 RID: 3094
		[CachedData]
		private int _partyPureSpeedLastCheckVersion = -1;

		// Token: 0x04000C17 RID: 3095
		[CachedData]
		private bool _partyLastCheckIsPrisoner;

		// Token: 0x04000C18 RID: 3096
		[CachedData]
		private ExplainedNumber _lastCalculatedBaseSpeedExplained;

		// Token: 0x04000C1A RID: 3098
		[CachedData]
		private bool _partyLastCheckAtNight;

		// Token: 0x04000C1B RID: 3099
		[CachedData]
		private int _itemRosterVersionNo = -1;

		// Token: 0x04000C1C RID: 3100
		[CachedData]
		private int _partySizeRatioLastCheckVersion = -1;

		// Token: 0x04000C1D RID: 3101
		[CachedData]
		private int _partyWeightLastCheckVersionNo = -1;

		// Token: 0x04000C1E RID: 3102
		[CachedData]
		private float _cachedPartySizeRatio = 1f;

		// Token: 0x04000C1F RID: 3103
		[SaveableField(1059)]
		private BesiegerCamp _besiegerCamp;

		// Token: 0x04000C20 RID: 3104
		[SaveableField(1048)]
		private MobileParty _targetParty;

		// Token: 0x04000C21 RID: 3105
		[SaveableField(1049)]
		private Settlement _targetSettlement;

		// Token: 0x04000C22 RID: 3106
		[SaveableField(224)]
		private CampaignVec2 _targetPosition;

		// Token: 0x04000C23 RID: 3107
		private int _doNotAttackMainParty;

		// Token: 0x04000C24 RID: 3108
		[SaveableField(1034)]
		private Settlement _customHomeSettlement;

		// Token: 0x04000C25 RID: 3109
		[SaveableField(1035)]
		private Army _army;

		// Token: 0x04000C26 RID: 3110
		[CachedData]
		private bool _isDisorganized;

		// Token: 0x04000C27 RID: 3111
		[SaveableField(1959)]
		private bool _isCurrentlyUsedByAQuest;

		// Token: 0x04000C2A RID: 3114
		[SaveableField(1956)]
		private int _partyTradeGold;

		// Token: 0x04000C2C RID: 3116
		[SaveableField(1063)]
		private CampaignTime _ignoredUntilTime;

		// Token: 0x04000C2E RID: 3118
		[SaveableField(1071)]
		public Vec2 AverageFleeTargetDirection;

		// Token: 0x04000C30 RID: 3120
		private bool _besiegerCampResetStarted;

		// Token: 0x04000C33 RID: 3123
		[SaveableField(211)]
		private bool _pathMode;

		// Token: 0x04000C34 RID: 3124
		[SaveableField(220)]
		private CampaignVec2 _pathLastPosition;

		// Token: 0x04000C35 RID: 3125
		[SaveableField(221)]
		public CampaignVec2 NextTargetPosition;

		// Token: 0x04000C36 RID: 3126
		[SaveableField(222)]
		public CampaignVec2 MoveTargetPoint;

		// Token: 0x04000C37 RID: 3127
		[SaveableField(215)]
		public MoveModeType PartyMoveMode;

		// Token: 0x04000C38 RID: 3128
		[SaveableField(216)]
		private Vec2 _formationPosition;

		// Token: 0x04000C39 RID: 3129
		[SaveableField(217)]
		public MobileParty MoveTargetParty;

		// Token: 0x04000C3A RID: 3130
		[SaveableField(218)]
		private AiBehavior _defaultBehavior;

		// Token: 0x04000C3B RID: 3131
		[SaveableField(1110)]
		private bool _isCurrentlyAtSea;

		// Token: 0x04000C3C RID: 3132
		[SaveableField(1094)]
		private bool _isTargetingPort;

		// Token: 0x04000C3F RID: 3135
		public bool StartTransitionNextFrameToExitFromPort;

		// Token: 0x04000C41 RID: 3137
		[SaveableField(1096)]
		private CampaignTime _navigationTransitionStartTime;

		// Token: 0x04000C43 RID: 3139
		[SaveableField(1093)]
		private MobileParty.NavigationType _desiredAiNavigationType;

		// Token: 0x04000C44 RID: 3140
		[CachedData]
		private int _locatorNodeIndex;

		// Token: 0x04000C49 RID: 3145
		[SaveableField(1120)]
		private Clan _actualClan;

		// Token: 0x04000C4A RID: 3146
		[SaveableField(1200)]
		private float _moraleDueToEvents;

		// Token: 0x04000C4B RID: 3147
		[CachedData]
		private float _totalWeightCarriedCache;

		// Token: 0x04000C4C RID: 3148
		[CachedData]
		private PathFaceRecord _lastNavigationFace;

		// Token: 0x04000C4D RID: 3149
		[CachedData]
		private MapWeatherModel.WeatherEventEffectOnTerrain _lastWeatherTerrainEffect;

		// Token: 0x04000C4E RID: 3150
		[CachedData]
		private bool _aiPathNotFound;

		// Token: 0x04000C50 RID: 3152
		[CachedData]
		public NavigationPath Path;

		// Token: 0x04000C51 RID: 3153
		[CachedData]
		public PathFaceRecord PathLastFace;

		// Token: 0x04000C53 RID: 3155
		[CachedData]
		private MobileParty.NavigationType _lastComputedPathNavigationType;

		// Token: 0x04000C54 RID: 3156
		[SaveableField(225)]
		private CampaignVec2 _position;

		// Token: 0x04000C55 RID: 3157
		private Vec2 _lastWind;

		// Token: 0x04000C56 RID: 3158
		[SaveableField(210)]
		private PartyComponent _partyComponent;

		// Token: 0x0200068F RID: 1679
		public enum PartyObjective
		{
			// Token: 0x04001A53 RID: 6739
			Neutral,
			// Token: 0x04001A54 RID: 6740
			Defensive,
			// Token: 0x04001A55 RID: 6741
			Aggressive,
			// Token: 0x04001A56 RID: 6742
			NumberOfPartyObjectives
		}

		// Token: 0x02000690 RID: 1680
		[Flags]
		public enum NavigationType
		{
			// Token: 0x04001A58 RID: 6744
			None = 0,
			// Token: 0x04001A59 RID: 6745
			Default = 1,
			// Token: 0x04001A5A RID: 6746
			Naval = 2,
			// Token: 0x04001A5B RID: 6747
			All = 3
		}

		// Token: 0x02000691 RID: 1681
		internal struct CachedPartyVariables
		{
			// Token: 0x0600521B RID: 21019 RVA: 0x001864B0 File Offset: 0x001846B0
			public override string ToString()
			{
				return string.Concat(new object[]
				{
					"IsAttachedArmyMember:",
					this.IsAttachedArmyMember.ToString(),
					"\nIsArmyLeader",
					this.IsArmyLeader.ToString(),
					"\nIsMoving",
					this.IsMoving.ToString(),
					"\nHasMapEvent",
					this.HasMapEvent.ToString(),
					"\nNextMoveDistance",
					this.NextMoveDistance,
					"\nCurrentPosition",
					this.CurrentPosition,
					"\nLastCurrentPosition",
					this.LastCurrentPosition,
					"\nNextPosition",
					this.NextPosition,
					"\nTargetPartyPositionAtFrameStart",
					this.TargetPartyPositionAtFrameStart,
					"\n"
				});
			}

			// Token: 0x04001A5C RID: 6748
			internal bool IsAttachedArmyMember;

			// Token: 0x04001A5D RID: 6749
			internal bool IsArmyLeader;

			// Token: 0x04001A5E RID: 6750
			internal bool IsMoving;

			// Token: 0x04001A5F RID: 6751
			internal bool HasMapEvent;

			// Token: 0x04001A60 RID: 6752
			internal float NextMoveDistance;

			// Token: 0x04001A61 RID: 6753
			internal CampaignVec2 CurrentPosition;

			// Token: 0x04001A62 RID: 6754
			internal CampaignVec2 LastCurrentPosition;

			// Token: 0x04001A63 RID: 6755
			internal CampaignVec2 NextPosition;

			// Token: 0x04001A64 RID: 6756
			internal CampaignVec2 TargetPartyPositionAtFrameStart;

			// Token: 0x04001A65 RID: 6757
			internal bool IsTargetMovingAtFrameStart;

			// Token: 0x04001A66 RID: 6758
			internal bool IsTransitionInProgress;
		}
	}
}
